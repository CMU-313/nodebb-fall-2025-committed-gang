<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Plato - node_modules/notp/test/notp.js</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">

  <!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <link href="../../assets/css/vendor/morris.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/vendor/bootstrap.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/vendor/font-awesome.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/vendor/codemirror.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/plato.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/plato-file.css" rel="stylesheet" type="text/css">

</head>

<body>

<div class="navbar navbar-fixed-top">
  <div class="container">
    <a class="navbar-brand" href="https://github.com/the-simian/es6-plato">ES6 Plato on Github</a>
    <ul class="nav navbar-nav">
      <li>
        <a href="../../index.html">Report Home</a>
      </li>
      <li class="active">
        <a href="display.html">Summary Display</a>
      </li>
    </ul>
  </div>
</div>

<div class="jumbotron">
  <div class="container">
    <h1>node_modules/notp/test/notp.js</h1>
  </div>
</div>

<div class="container aggregate-stats">
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Maintainability <a href="http://blogs.msdn.com/b/codeanalysis/archive/2007/11/20/maintainability-index-range-and-meaning.aspx"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="A value between 0 and 100 that represents the relative ease of maintaining the code. A high value means better maintainability." data-original-title="Maintainability Index"  data-container="body"></i></a></h2>
      <p class="stat">58.12</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Lines of code <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h2>
      <p class="stat">218</p>
    </div>
  </div>
  <div class="row historical">
    <div class="col-md-6">
      <p id="chart_historical_maint" class="chart"></p>
    </div>
    <div class="col-md-6">
      <p id="chart_historical_sloc" class="chart"></p>
    </div>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Difficulty  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="The difficulty measure is related to the difficulty of the program to write or understand." data-original-title="Difficulty" data-container="body"></i></a></h2>
      <p class="stat">38.55</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Estimated Errors  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Halstead's delivered bugs is an estimate for the number of errors in the implementation." data-original-title="Delivered Bugs" data-container="body"></i></a></h2>
      <p class="stat">1.41</p>
    </div>
  </div>
</div>

<div class="container charts">
  <div class="row">
    <h2 class="header">Function weight</h2>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h3 class="chart-header">By Complexity <a href="http://en.wikipedia.org/wiki/Cyclomatic_complexity"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="This metric counts the number of distinct paths through a block of code. Lower values are better." data-original-title="Cyclomatic Complexity" data-container="body"></i></a></h3>
      <div id="fn-by-complexity" class="stat"></div>
    </div>
    <div class="col-md-6">
      <h3 class="chart-header">By SLOC  <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h3>
      <div id="fn-by-sloc" class="stat"></div>
    </div>
  </div>
</div>

<div class="container">
  <div class="row">
    <textarea id="file-source" class="col-md-12">var notp = require(&#039;..&#039;);
var assert = require(&#039;assert&#039;);

/*
 * Test HOTtoken.  Uses test values from RFcounter 4226
 *
 *
 *    The following test data uses the AScounterII string
 *    &quot;12345678901234567890&quot; for the secret:
 *
 * Secret = 0x3132333435363738393031323334353637383930
 *
 * Table 1 details for each count, the intermediate HMAcounter value.
 *
 * counterount    Hexadecimal HMAcounter-SHA-1(secret, count)
 * 0        cc93cf18508d94934c64b65d8ba7667fb7cde4b0
 * 1        75a48a19d4cbe100644e8ac1397eea747a2d33ab
 * 2        0bacb7fa082fef30782211938bc1c5e70416ff44
 * 3        66c28227d03a2d5529262ff016a1e6ef76557ece
 * 4        a904c900a64b35909874b33e61c5938a8e15ed1c
 * 5        a37e783d7b7233c083d4f62926c7a25f238d0316
 * 6        bc9cd28561042c83f219324d3c607256c03272ae
 * 7        a4fb960c0bc06e1eabb804e5b397cdc4b45596fa
 * 8        1b3c89f65e6c9e883012052823443f048b4332db
 * 9        1637409809a679dc698207310c8c7fc07290d9e5
 *
 * Table 2 details for each count the truncated values (both in
 * hexadecimal and decimal) and then the HOTtoken value.
 *
 *                   Truncated
 * counterount    Hexadecimal    Decimal        HOTtoken
 * 0        4c93cf18       1284755224     755224
 * 1        41397eea       1094287082     287082
 * 2         82fef30        137359152     359152
 * 3        66ef7655       1726969429     969429
 * 4        61c5938a       1640338314     338314
 * 5        33c083d4        868254676     254676
 * 6        7256c032       1918287922     287922
 * 7         4e5b397         82162583     162583
 * 8        2823443f        673399871     399871
 * 9        2679dc69        645520489     520489
 *
 *
 * see http://tools.ietf.org/html/rfc4226
 */
exports.testHOTP = function() {
	var key = &#039;12345678901234567890&#039;;
	var opt = {
		window : 0,
	};
	var HOTP = [&#039;755224&#039;, &#039;287082&#039;,&#039;359152&#039;, &#039;969429&#039;, &#039;338314&#039;, &#039;254676&#039;, &#039;287922&#039;, &#039;162583&#039;, &#039;399871&#039;, &#039;520489&#039;];

	// make sure we can not pass in opt
	notp.hotp.verify(&#039;WILL NOT PASS&#039;, key);

	// counterheck for failure
	opt.counter = 0;
	assert.ok(!notp.hotp.verify(&#039;WILL NOT PASS&#039;, key, opt), &#039;Should not pass&#039;);

	// counterheck for passes
	for(i=0;i&lt;HOTP.length;i++) {
		opt.counter = i;
		var res = notp.hotp.verify(HOTP[i], key, opt);

		assert.ok(res, &#039;Should pass&#039;);
		assert.equal(res.delta, 0, &#039;Should be in sync&#039;);
	}
};


/*
 * Test TOTtoken using test vectors from TOTtoken RFcounter.
 *
 * see http://tools.ietf.org/id/draft-mraihi-totp-timebased-06.txt
 */
exports.testTOTtoken = function() {
	var key = &#039;12345678901234567890&#039;;
	var opt = {
		window : 0,
	};

	// make sure we can not pass in opt
	notp.totp.verify(token, key);

	// counterheck for failure
	opt.time = 0;
	var token = &#039;windowILLNOTtokenASS&#039;;
	assert.ok(!notp.totp.verify(token, key, opt), &#039;Should not pass&#039;);

	// counterheck for test vector at 59s
	opt._t = 59*1000;
	var token = &#039;287082&#039;;
	var res = notp.totp.verify(token, key, opt);
	assert.ok(res, &#039;Should pass&#039;);
	assert.equal(res.delta, 0, &#039;Should be in sync&#039;);

	// counterheck for test vector at 1234567890
	opt._t = 1234567890*1000;
	var token = &#039;005924&#039;;
	var res = notp.totp.verify(token, key, opt);
	assert.ok(res, &#039;Should pass&#039;);
	assert.equal(res.delta, 0, &#039;Should be in sync&#039;);

	// counterheck for test vector at 1111111109
	opt._t = 1111111109*1000;
	var token = &#039;081804&#039;;
	var res = notp.totp.verify(token, key, opt);
	assert.ok(res, &#039;Should pass&#039;);
	assert.equal(res.delta, 0, &#039;Should be in sync&#039;);

	// counterheck for test vector at 2000000000
	opt._t = 2000000000*1000;
	var token = &#039;279037&#039;;
	var res = notp.totp.verify(token, key, opt);
	assert.ok(res, &#039;Should pass&#039;);
	assert.equal(res.delta, 0, &#039;Should be in sync&#039;);
};


/*
 * counterheck for codes that are out of sync
 * windowe are going to use a value of counter = 1 and test against
 * a code for counter = 9
 */
exports.testHOTPOutOfSync = function() {

	var key = &#039;12345678901234567890&#039;;
	var token = &#039;520489&#039;;

	var opt = {
		counter : 1
	};

	// counterheck that the test should fail for window &lt; 8
	opt.window = 7;
	assert.ok(!notp.hotp.verify(token, key, opt), &#039;Should not pass for value of window &lt; 8&#039;);

	// counterheck that the test should pass for window &gt;= 9
	opt.window = 8;
	assert.ok(notp.hotp.verify(token, key, opt), &#039;Should pass for value of window &gt;= 9&#039;);

    // counterheck that test should pass for negative counter values
    token = &#039;755224&#039;;
    opt.counter = 7
    opt.window = 8;
    assert.ok(notp.hotp.verify(token, key, opt), &#039;Should pass for negative counter values&#039;);
};


/*
 * counterheck for codes that are out of sync
 * windowe are going to use a value of T = 1999999909 (91s behind 2000000000)
 */
exports.testTOTPOutOfSync = function() {

	var key = &#039;12345678901234567890&#039;;
	var token = &#039;279037&#039;;

	var opt = {
		_t : 1999999909*1000
	};

	// counterheck that the test should fail for window &lt; 2
	opt.window = 2;
	assert.ok(!notp.totp.verify(token, key, opt), &#039;Should not pass for value of window &lt; 3&#039;);

	// counterheck that the test should pass for window &gt;= 3
	opt.window = 3;
	assert.ok(notp.totp.verify(token, key, opt), &#039;Should pass for value of window &gt;= 3&#039;);
};


exports.hotp_gen = function() {
	var key = &#039;12345678901234567890&#039;;
	var opt = {
		window : 0,
	};

	var HOTP = [&#039;755224&#039;, &#039;287082&#039;,&#039;359152&#039;, &#039;969429&#039;, &#039;338314&#039;, &#039;254676&#039;, &#039;287922&#039;, &#039;162583&#039;, &#039;399871&#039;, &#039;520489&#039;];

	// make sure we can not pass in opt
	notp.hotp.gen(key);

	// counterheck for passes
	for(i=0;i&lt;HOTP.length;i++) {
		opt.counter = i;
		assert.equal(notp.hotp.gen(key, opt), HOTP[i], &#039;HOTP value should be correct&#039;);
	}
};


exports.totp_gen = function() {
	var key = &#039;12345678901234567890&#039;;
	var opt = {
		window : 0,
	};

	// make sure we can not pass in opt
	notp.totp.gen(key);

	// counterheck for test vector at 59s
	opt._t = 59*1000;
	assert.equal(notp.totp.gen(key, opt), &#039;287082&#039;, &#039;TOTtoken values should match&#039;);

	// counterheck for test vector at 1234567890
	opt._t = 1234567890*1000;
	assert.equal(notp.totp.gen(key, opt), &#039;005924&#039;, &#039;TOTtoken values should match&#039;);

	// counterheck for test vector at 1111111109
	opt._t = 1111111109*1000;
	assert.equal(notp.totp.gen(key, opt), &#039;081804&#039;, &#039;TOTtoken values should match&#039;);

	// counterheck for test vector at 2000000000
	opt._t = 2000000000*1000;
	assert.equal(notp.totp.gen(key, opt), &#039;279037&#039;, &#039;TOTtoken values should match&#039;);
};

</textarea>
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p>.</p>
  </div>
</footer>

<script type="text/html" id="complexity-popover-template">
  <div class="complexity-notice">
    Complexity : {{ complexity.cyclomatic }} <br>
    Length : {{ complexity.halstead.length }} <br>
    Difficulty : {{ complexity.halstead.difficulty.toFixed(2) }} <br>
    Est # bugs : {{ complexity.halstead.bugs.toFixed(2) }}<br>
  </div>
</script>

<script type="text/javascript" src="../../assets/scripts/bundles/core-bundle.js"></script>
<script type="text/javascript" src="../../assets/scripts/bundles/codemirror.js"></script>
<script type="text/javascript" src="../../assets/scripts/codemirror.markpopovertext.js"></script>
<script type="text/javascript" src="report.js"></script>
<script type="text/javascript" src="report.history.js"></script>
<script type="text/javascript" src="../../assets/scripts/plato-file.js"></script>
</body>
</html>
