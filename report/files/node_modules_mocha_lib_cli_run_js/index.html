<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Plato - node_modules/mocha/lib/cli/run.js</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">

  <!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <link href="../../assets/css/vendor/morris.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/vendor/bootstrap.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/vendor/font-awesome.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/vendor/codemirror.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/plato.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/plato-file.css" rel="stylesheet" type="text/css">

</head>

<body>

<div class="navbar navbar-fixed-top">
  <div class="container">
    <a class="navbar-brand" href="https://github.com/the-simian/es6-plato">ES6 Plato on Github</a>
    <ul class="nav navbar-nav">
      <li>
        <a href="../../index.html">Report Home</a>
      </li>
      <li class="active">
        <a href="display.html">Summary Display</a>
      </li>
    </ul>
  </div>
</div>

<div class="jumbotron">
  <div class="container">
    <h1>node_modules/mocha/lib/cli/run.js</h1>
  </div>
</div>

<div class="container aggregate-stats">
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Maintainability <a href="http://blogs.msdn.com/b/codeanalysis/archive/2007/11/20/maintainability-index-range-and-meaning.aspx"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="A value between 0 and 100 that represents the relative ease of maintaining the code. A high value means better maintainability." data-original-title="Maintainability Index"  data-container="body"></i></a></h2>
      <p class="stat">54.03</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Lines of code <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h2>
      <p class="stat">381</p>
    </div>
  </div>
  <div class="row historical">
    <div class="col-md-6">
      <p id="chart_historical_maint" class="chart"></p>
    </div>
    <div class="col-md-6">
      <p id="chart_historical_sloc" class="chart"></p>
    </div>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Difficulty  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="The difficulty measure is related to the difficulty of the program to write or understand." data-original-title="Difficulty" data-container="body"></i></a></h2>
      <p class="stat">32.04</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Estimated Errors  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Halstead's delivered bugs is an estimate for the number of errors in the implementation." data-original-title="Delivered Bugs" data-container="body"></i></a></h2>
      <p class="stat">2.78</p>
    </div>
  </div>
</div>

<div class="container charts">
  <div class="row">
    <h2 class="header">Function weight</h2>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h3 class="chart-header">By Complexity <a href="http://en.wikipedia.org/wiki/Cyclomatic_complexity"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="This metric counts the number of distinct paths through a block of code. Lower values are better." data-original-title="Cyclomatic Complexity" data-container="body"></i></a></h3>
      <div id="fn-by-complexity" class="stat"></div>
    </div>
    <div class="col-md-6">
      <h3 class="chart-header">By SLOC  <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h3>
      <div id="fn-by-sloc" class="stat"></div>
    </div>
  </div>
</div>

<div class="container">
  <div class="row">
    <textarea id="file-source" class="col-md-12">&#039;use strict&#039;;

/**
 * Definition for Mocha&#039;s default (&quot;run tests&quot;) command
 *
 * @module
 * @private
 */

const symbols = require(&#039;log-symbols&#039;);
const pc = require(&#039;picocolors&#039;);
const Mocha = require(&#039;../mocha&#039;);
const {
  createUnsupportedError,
  createInvalidArgumentValueError,
  createMissingArgumentError
} = require(&#039;../errors&#039;);

const {
  list,
  handleRequires,
  validateLegacyPlugin,
  runMocha
} = require(&#039;./run-helpers&#039;);
const {ONE_AND_DONES, ONE_AND_DONE_ARGS} = require(&#039;./one-and-dones&#039;);
const debug = require(&#039;debug&#039;)(&#039;mocha:cli:run&#039;);
const defaults = require(&#039;../mocharc.json&#039;);
const {types, aliases} = require(&#039;./run-option-metadata&#039;);

/**
 * Logical option groups
 * @constant
 */
const GROUPS = {
  FILES: &#039;File Handling&#039;,
  FILTERS: &#039;Test Filters&#039;,
  NODEJS: &#039;Node.js &amp; V8&#039;,
  OUTPUT: &#039;Reporting &amp; Output&#039;,
  RULES: &#039;Rules &amp; Behavior&#039;,
  CONFIG: &#039;Configuration&#039;
};

exports.command = [&#039;$0 [spec..]&#039;, &#039;inspect&#039;];

exports.describe = &#039;Run tests with Mocha&#039;;

exports.builder = yargs =&gt;
  yargs
    .options({
      &#039;allow-uncaught&#039;: {
        description: &#039;Allow uncaught errors to propagate&#039;,
        group: GROUPS.RULES
      },
      &#039;async-only&#039;: {
        description:
          &#039;Require all tests to use a callback (async) or return a Promise&#039;,
        group: GROUPS.RULES
      },
      bail: {
        description: &#039;Abort (&quot;bail&quot;) after first test failure&#039;,
        group: GROUPS.RULES
      },
      &#039;check-leaks&#039;: {
        description: &#039;Check for global variable leaks&#039;,
        group: GROUPS.RULES
      },
      color: {
        description: &#039;Force-enable color output&#039;,
        group: GROUPS.OUTPUT
      },
      config: {
        config: true,
        defaultDescription: &#039;(nearest rc file)&#039;,
        description: &#039;Path to config file&#039;,
        group: GROUPS.CONFIG
      },
      delay: {
        description: &#039;Delay initial execution of root suite&#039;,
        group: GROUPS.RULES
      },
      diff: {
        default: true,
        description: &#039;Show diff on failure&#039;,
        group: GROUPS.OUTPUT
      },
      &#039;dry-run&#039;: {
        description: &#039;Report tests without executing them&#039;,
        group: GROUPS.RULES
      },
      exit: {
        description: &#039;Force Mocha to quit after tests complete&#039;,
        group: GROUPS.RULES
      },
      extension: {
        default: defaults.extension,
        description: &#039;File extension(s) to load&#039;,
        group: GROUPS.FILES,
        requiresArg: true,
        coerce: list
      },
      &#039;pass-on-failing-test-suite&#039;: {
        default: false,
        description: &#039;Not fail test run if tests were failed&#039;,
        group: GROUPS.RULES
      },
      &#039;fail-zero&#039;: {
        description: &#039;Fail test run if no test(s) encountered&#039;,
        group: GROUPS.RULES
      },
      fgrep: {
        conflicts: &#039;grep&#039;,
        description: &#039;Only run tests containing this string&#039;,
        group: GROUPS.FILTERS,
        requiresArg: true
      },
      file: {
        defaultDescription: &#039;(none)&#039;,
        description:
          &#039;Specify file(s) to be loaded prior to root suite execution&#039;,
        group: GROUPS.FILES,
        normalize: true,
        requiresArg: true
      },
      &#039;forbid-only&#039;: {
        description: &#039;Fail if exclusive test(s) encountered&#039;,
        group: GROUPS.RULES
      },
      &#039;forbid-pending&#039;: {
        description: &#039;Fail if pending test(s) encountered&#039;,
        group: GROUPS.RULES
      },
      &#039;full-trace&#039;: {
        description: &#039;Display full stack traces&#039;,
        group: GROUPS.OUTPUT
      },
      global: {
        coerce: list,
        description: &#039;List of allowed global variables&#039;,
        group: GROUPS.RULES,
        requiresArg: true
      },
      grep: {
        coerce: value =&gt; (!value ? null : value),
        conflicts: &#039;fgrep&#039;,
        description: &#039;Only run tests matching this string or regexp&#039;,
        group: GROUPS.FILTERS,
        requiresArg: true
      },
      ignore: {
        defaultDescription: &#039;(none)&#039;,
        description: &#039;Ignore file(s) or glob pattern(s)&#039;,
        group: GROUPS.FILES,
        requiresArg: true
      },
      &#039;inline-diffs&#039;: {
        description:
          &#039;Display actual/expected differences inline within each string&#039;,
        group: GROUPS.OUTPUT
      },
      invert: {
        description: &#039;Inverts --grep and --fgrep matches&#039;,
        group: GROUPS.FILTERS
      },
      jobs: {
        description:
          &#039;Number of concurrent jobs for --parallel; use 1 to run in serial&#039;,
        defaultDescription: &#039;(number of CPU cores - 1)&#039;,
        requiresArg: true,
        group: GROUPS.RULES
      },
      &#039;list-interfaces&#039;: {
        conflicts: Array.from(ONE_AND_DONE_ARGS).filter(arg =&gt; arg !== &quot;list-interfaces&quot;),
        description: &#039;List built-in user interfaces &amp; exit&#039;
      },
      &#039;list-reporters&#039;: {
        conflicts: Array.from(ONE_AND_DONE_ARGS).filter(arg =&gt; arg !== &quot;list-reporters&quot;),
        description: &#039;List built-in reporters &amp; exit&#039;
      },
      &#039;no-colors&#039;: {
        description: &#039;Force-disable color output&#039;,
        group: GROUPS.OUTPUT,
        hidden: true
      },
      &#039;node-option&#039;: {
        description: &#039;Node or V8 option (no leading &quot;--&quot;)&#039;,
        group: GROUPS.CONFIG
      },
      package: {
        description: &#039;Path to package.json for config&#039;,
        group: GROUPS.CONFIG,
        normalize: true,
        requiresArg: true
      },
      parallel: {
        description: &#039;Run tests in parallel&#039;,
        group: GROUPS.RULES
      },
      recursive: {
        description: &#039;Look for tests in subdirectories&#039;,
        group: GROUPS.FILES
      },
      reporter: {
        default: defaults.reporter,
        description: &#039;Specify reporter to use&#039;,
        group: GROUPS.OUTPUT,
        requiresArg: true
      },
      &#039;reporter-option&#039;: {
        coerce: opts =&gt;
          list(opts).reduce((acc, opt) =&gt; {
            const pair = opt.split(&#039;=&#039;);

            if (pair.length &gt; 2 || !pair.length) {
              throw createInvalidArgumentValueError(
                `invalid reporter option &#039;${opt}&#039;`,
                &#039;--reporter-option&#039;,
                opt,
                &#039;expected &quot;key=value&quot; format&#039;
              );
            }

            acc[pair[0]] = pair.length === 2 ? pair[1] : true;
            return acc;
          }, {}),
        description: &#039;Reporter-specific options (&lt;k=v,[k1=v1,..]&gt;)&#039;,
        group: GROUPS.OUTPUT,
        requiresArg: true
      },
      require: {
        defaultDescription: &#039;(none)&#039;,
        description: &#039;Require module&#039;,
        group: GROUPS.FILES,
        requiresArg: true
      },
      retries: {
        description: &#039;Retry failed tests this many times&#039;,
        group: GROUPS.RULES
      },
      slow: {
        default: defaults.slow,
        description: &#039;Specify &quot;slow&quot; test threshold (in milliseconds)&#039;,
        group: GROUPS.RULES
      },
      sort: {
        description: &#039;Sort test files&#039;,
        group: GROUPS.FILES
      },
      timeout: {
        default: defaults.timeout,
        description: &#039;Specify test timeout threshold (in milliseconds)&#039;,
        group: GROUPS.RULES
      },
      ui: {
        default: defaults.ui,
        description: &#039;Specify user interface&#039;,
        group: GROUPS.RULES,
        requiresArg: true
      },
      watch: {
        description: &#039;Watch files in the current working directory for changes&#039;,
        group: GROUPS.FILES
      },
      &#039;watch-files&#039;: {
        description: &#039;List of paths or globs to watch&#039;,
        group: GROUPS.FILES,
        requiresArg: true,
        coerce: list
      },
      &#039;watch-ignore&#039;: {
        description: &#039;List of paths or globs to exclude from watching&#039;,
        group: GROUPS.FILES,
        requiresArg: true,
        coerce: list,
        default: defaults[&#039;watch-ignore&#039;]
      }
    })
    .positional(&#039;spec&#039;, {
      default: [&#039;test&#039;],
      description: &#039;One or more files, directories, or globs to test&#039;,
      type: &#039;array&#039;
    })
    .check(argv =&gt; {
      // &quot;one-and-dones&quot;; let yargs handle help and version
      Object.keys(ONE_AND_DONES).forEach(opt =&gt; {
        if (argv[opt]) {
          ONE_AND_DONES[opt].call(null, yargs);
          process.exit();
        }
      });

      // yargs.implies() isn&#039;t flexible enough to handle this
      if (argv.invert &amp;&amp; !(&#039;fgrep&#039; in argv || &#039;grep&#039; in argv)) {
        throw createMissingArgumentError(
          &#039;&quot;--invert&quot; requires one of &quot;--fgrep &lt;str&gt;&quot; or &quot;--grep &lt;regexp&gt;&quot;&#039;,
          &#039;--fgrep|--grep&#039;,
          &#039;string|regexp&#039;
        );
      }

      if (argv.parallel) {
        // yargs.conflicts() can&#039;t deal with `--file foo.js --no-parallel`, either
        if (argv.file) {
          throw createUnsupportedError(
            &#039;--parallel runs test files in a non-deterministic order, and is mutually exclusive with --file&#039;
          );
        }

        // or this
        if (argv.sort) {
          throw createUnsupportedError(
            &#039;--parallel runs test files in a non-deterministic order, and is mutually exclusive with --sort&#039;
          );
        }

        if (argv.reporter === &#039;progress&#039;) {
          throw createUnsupportedError(
            &#039;--reporter=progress is mutually exclusive with --parallel&#039;
          );
        }

        if (argv.reporter === &#039;markdown&#039;) {
          throw createUnsupportedError(
            &#039;--reporter=markdown is mutually exclusive with --parallel&#039;
          );
        }

        if (argv.reporter === &#039;json-stream&#039;) {
          throw createUnsupportedError(
            &#039;--reporter=json-stream is mutually exclusive with --parallel&#039;
          );
        }
      }

      if (argv.compilers) {
        throw createUnsupportedError(
          `--compilers is DEPRECATED and no longer supported.
          See https://github.com/mochajs/mocha/wiki/compilers-deprecation for migration information.`
        );
      }

      if (argv.opts) {
        throw createUnsupportedError(
          `--opts: configuring Mocha via &#039;mocha.opts&#039; is DEPRECATED and no longer supported.
          Please use a configuration file instead.`
        );
      }

      return true;
    })
    .middleware(async (argv, yargs) =&gt; {
      // currently a failing middleware does not work nicely with yargs&#039; `fail()`.
      try {
        // load requires first, because it can impact &quot;plugin&quot; validation
        const plugins = await handleRequires(argv.require);
        validateLegacyPlugin(argv, &#039;reporter&#039;, Mocha.reporters);
        validateLegacyPlugin(argv, &#039;ui&#039;, Mocha.interfaces);
        Object.assign(argv, plugins);
      } catch (err) {
        // this could be a bad --require, bad reporter, ui, etc.
        console.error(`\n${symbols.error} ${pc.red(&#039;ERROR:&#039;)}`, err);
        yargs.exit(1);
      }
    })
    .array(types.array)
    .boolean(types.boolean)
    .string(types.string)
    .number(types.number)
    .alias(aliases);

exports.handler = async function (argv) {
  debug(&#039;post-yargs config&#039;, argv);
  const mocha = new Mocha(argv);

  try {
    await runMocha(mocha, argv);
  } catch (err) {
    console.error(&#039;\n Exception during run:&#039;, err);
    process.exit(1);
  }
};
</textarea>
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p>.</p>
  </div>
</footer>

<script type="text/html" id="complexity-popover-template">
  <div class="complexity-notice">
    Complexity : {{ complexity.cyclomatic }} <br>
    Length : {{ complexity.halstead.length }} <br>
    Difficulty : {{ complexity.halstead.difficulty.toFixed(2) }} <br>
    Est # bugs : {{ complexity.halstead.bugs.toFixed(2) }}<br>
  </div>
</script>

<script type="text/javascript" src="../../assets/scripts/bundles/core-bundle.js"></script>
<script type="text/javascript" src="../../assets/scripts/bundles/codemirror.js"></script>
<script type="text/javascript" src="../../assets/scripts/codemirror.markpopovertext.js"></script>
<script type="text/javascript" src="report.js"></script>
<script type="text/javascript" src="report.history.js"></script>
<script type="text/javascript" src="../../assets/scripts/plato-file.js"></script>
</body>
</html>
