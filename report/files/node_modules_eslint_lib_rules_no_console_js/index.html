<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Plato - node_modules/eslint/lib/rules/no-console.js</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">

  <!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <link href="../../assets/css/vendor/morris.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/vendor/bootstrap.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/vendor/font-awesome.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/vendor/codemirror.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/plato.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/plato-file.css" rel="stylesheet" type="text/css">

</head>

<body>

<div class="navbar navbar-fixed-top">
  <div class="container">
    <a class="navbar-brand" href="https://github.com/the-simian/es6-plato">ES6 Plato on Github</a>
    <ul class="nav navbar-nav">
      <li>
        <a href="../../index.html">Report Home</a>
      </li>
      <li class="active">
        <a href="display.html">Summary Display</a>
      </li>
    </ul>
  </div>
</div>

<div class="jumbotron">
  <div class="container">
    <h1>node_modules/eslint/lib/rules/no-console.js</h1>
  </div>
</div>

<div class="container aggregate-stats">
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Maintainability <a href="http://blogs.msdn.com/b/codeanalysis/archive/2007/11/20/maintainability-index-range-and-meaning.aspx"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="A value between 0 and 100 that represents the relative ease of maintaining the code. A high value means better maintainability." data-original-title="Maintainability Index"  data-container="body"></i></a></h2>
      <p class="stat">69.01</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Lines of code <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h2>
      <p class="stat">222</p>
    </div>
  </div>
  <div class="row historical">
    <div class="col-md-6">
      <p id="chart_historical_maint" class="chart"></p>
    </div>
    <div class="col-md-6">
      <p id="chart_historical_sloc" class="chart"></p>
    </div>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Difficulty  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="The difficulty measure is related to the difficulty of the program to write or understand." data-original-title="Difficulty" data-container="body"></i></a></h2>
      <p class="stat">18.11</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Estimated Errors  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Halstead's delivered bugs is an estimate for the number of errors in the implementation." data-original-title="Delivered Bugs" data-container="body"></i></a></h2>
      <p class="stat">1.03</p>
    </div>
  </div>
</div>

<div class="container charts">
  <div class="row">
    <h2 class="header">Function weight</h2>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h3 class="chart-header">By Complexity <a href="http://en.wikipedia.org/wiki/Cyclomatic_complexity"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="This metric counts the number of distinct paths through a block of code. Lower values are better." data-original-title="Cyclomatic Complexity" data-container="body"></i></a></h3>
      <div id="fn-by-complexity" class="stat"></div>
    </div>
    <div class="col-md-6">
      <h3 class="chart-header">By SLOC  <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h3>
      <div id="fn-by-sloc" class="stat"></div>
    </div>
  </div>
</div>

<div class="container">
  <div class="row">
    <textarea id="file-source" class="col-md-12">/**
 * @fileoverview Rule to flag use of console object
 * @author Nicholas C. Zakas
 */

&quot;use strict&quot;;

//------------------------------------------------------------------------------
// Requirements
//------------------------------------------------------------------------------

const astUtils = require(&quot;./utils/ast-utils&quot;);

//------------------------------------------------------------------------------
// Rule Definition
//------------------------------------------------------------------------------

/** @type {import(&#039;../types&#039;).Rule.RuleModule} */
module.exports = {
	meta: {
		type: &quot;suggestion&quot;,

		defaultOptions: [{}],

		docs: {
			description: &quot;Disallow the use of `console`&quot;,
			recommended: false,
			url: &quot;https://eslint.org/docs/latest/rules/no-console&quot;,
		},

		schema: [
			{
				type: &quot;object&quot;,
				properties: {
					allow: {
						type: &quot;array&quot;,
						items: {
							type: &quot;string&quot;,
						},
						minItems: 1,
						uniqueItems: true,
					},
				},
				additionalProperties: false,
			},
		],

		hasSuggestions: true,

		messages: {
			unexpected: &quot;Unexpected console statement.&quot;,
			limited:
				&quot;Unexpected console statement. Only these console methods are allowed: {{ allowed }}.&quot;,
			removeConsole: &quot;Remove the console.{{ propertyName }}().&quot;,
			removeMethodCall: &quot;Remove the console method call.&quot;,
		},
	},

	create(context) {
		const [{ allow: allowed = [] }] = context.options;
		const sourceCode = context.sourceCode;

		/**
		 * Checks whether the given reference is &#039;console&#039; or not.
		 * @param {eslint-scope.Reference} reference The reference to check.
		 * @returns {boolean} `true` if the reference is &#039;console&#039;.
		 */
		function isConsole(reference) {
			const id = reference.identifier;

			return id &amp;&amp; id.name === &quot;console&quot;;
		}

		/**
		 * Checks whether the property name of the given MemberExpression node
		 * is allowed by options or not.
		 * @param {ASTNode} node The MemberExpression node to check.
		 * @returns {boolean} `true` if the property name of the node is allowed.
		 */
		function isAllowed(node) {
			const propertyName = astUtils.getStaticPropertyName(node);

			return propertyName &amp;&amp; allowed.includes(propertyName);
		}

		/**
		 * Checks whether the given reference is a member access which is not
		 * allowed by options or not.
		 * @param {eslint-scope.Reference} reference The reference to check.
		 * @returns {boolean} `true` if the reference is a member access which
		 *      is not allowed by options.
		 */
		function isMemberAccessExceptAllowed(reference) {
			const node = reference.identifier;
			const parent = node.parent;

			return (
				parent.type === &quot;MemberExpression&quot; &amp;&amp;
				parent.object === node &amp;&amp;
				!isAllowed(parent)
			);
		}

		/**
		 * Checks if removing the ExpressionStatement node will cause ASI to
		 * break.
		 * eg.
		 * foo()
		 * console.log();
		 * [1, 2, 3].forEach(a =&gt; doSomething(a))
		 *
		 * Removing the console.log(); statement should leave two statements, but
		 * here the two statements will become one because [ causes continuation after
		 * foo().
		 * @param {ASTNode} node The ExpressionStatement node to check.
		 * @returns {boolean} `true` if ASI will break after removing the ExpressionStatement
		 *      node.
		 */
		function maybeAsiHazard(node) {
			const SAFE_TOKENS_BEFORE = /^[:;{]$/u; // One of :;{
			const UNSAFE_CHARS_AFTER = /^[-[(/+`]/u; // One of [(/+-`

			const tokenBefore = sourceCode.getTokenBefore(node);
			const tokenAfter = sourceCode.getTokenAfter(node);

			return (
				Boolean(tokenAfter) &amp;&amp;
				UNSAFE_CHARS_AFTER.test(tokenAfter.value) &amp;&amp;
				tokenAfter.value !== &quot;++&quot; &amp;&amp;
				tokenAfter.value !== &quot;--&quot; &amp;&amp;
				Boolean(tokenBefore) &amp;&amp;
				!SAFE_TOKENS_BEFORE.test(tokenBefore.value)
			);
		}

		/**
		 * Checks if the MemberExpression node&#039;s parent.parent.parent is a
		 * Program, BlockStatement, StaticBlock, or SwitchCase node. This check
		 * is necessary to avoid providing a suggestion that might cause a syntax error.
		 *
		 * eg. if (a) console.log(b), removing console.log() here will lead to a
		 *     syntax error.
		 *     if (a) { console.log(b) }, removing console.log() here is acceptable.
		 *
		 * Additionally, it checks if the callee of the CallExpression node is
		 * the node itself.
		 *
		 * eg. foo(console.log), cannot provide a suggestion here.
		 * @param {ASTNode} node The MemberExpression node to check.
		 * @returns {boolean} `true` if a suggestion can be provided for a node.
		 */
		function canProvideSuggestions(node) {
			return (
				node.parent.type === &quot;CallExpression&quot; &amp;&amp;
				node.parent.callee === node &amp;&amp;
				node.parent.parent.type === &quot;ExpressionStatement&quot; &amp;&amp;
				astUtils.STATEMENT_LIST_PARENTS.has(
					node.parent.parent.parent.type,
				) &amp;&amp;
				!maybeAsiHazard(node.parent.parent)
			);
		}

		/**
		 * Reports the given reference as a violation.
		 * @param {eslint-scope.Reference} reference The reference to report.
		 * @returns {void}
		 */
		function report(reference) {
			const node = reference.identifier.parent;

			const suggest = [];

			if (canProvideSuggestions(node)) {
				const suggestion = {
					fix(fixer) {
						return fixer.remove(node.parent.parent);
					},
				};

				if (node.computed) {
					suggestion.messageId = &quot;removeMethodCall&quot;;
				} else {
					suggestion.messageId = &quot;removeConsole&quot;;
					suggestion.data = { propertyName: node.property.name };
				}
				suggest.push(suggestion);
			}
			context.report({
				node,
				loc: node.loc,
				messageId: allowed.length ? &quot;limited&quot; : &quot;unexpected&quot;,
				data: { allowed: allowed.join(&quot;, &quot;) },
				suggest,
			});
		}

		return {
			&quot;Program:exit&quot;(node) {
				const scope = sourceCode.getScope(node);
				const consoleVar = astUtils.getVariableByName(scope, &quot;console&quot;);
				const shadowed = consoleVar &amp;&amp; consoleVar.defs.length &gt; 0;

				/*
				 * &#039;scope.through&#039; includes all references to undefined
				 * variables. If the variable &#039;console&#039; is not defined, it uses
				 * &#039;scope.through&#039;.
				 */
				const references = consoleVar
					? consoleVar.references
					: scope.through.filter(isConsole);

				if (!shadowed) {
					references
						.filter(isMemberAccessExceptAllowed)
						.forEach(report);
				}
			},
		};
	},
};
</textarea>
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p>.</p>
  </div>
</footer>

<script type="text/html" id="complexity-popover-template">
  <div class="complexity-notice">
    Complexity : {{ complexity.cyclomatic }} <br>
    Length : {{ complexity.halstead.length }} <br>
    Difficulty : {{ complexity.halstead.difficulty.toFixed(2) }} <br>
    Est # bugs : {{ complexity.halstead.bugs.toFixed(2) }}<br>
  </div>
</script>

<script type="text/javascript" src="../../assets/scripts/bundles/core-bundle.js"></script>
<script type="text/javascript" src="../../assets/scripts/bundles/codemirror.js"></script>
<script type="text/javascript" src="../../assets/scripts/codemirror.markpopovertext.js"></script>
<script type="text/javascript" src="report.js"></script>
<script type="text/javascript" src="report.history.js"></script>
<script type="text/javascript" src="../../assets/scripts/plato-file.js"></script>
</body>
</html>
