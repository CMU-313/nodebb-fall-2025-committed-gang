<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Plato - node_modules/browserslist/node.js</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">

  <!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <link href="../../assets/css/vendor/morris.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/vendor/bootstrap.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/vendor/font-awesome.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/vendor/codemirror.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/plato.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/plato-file.css" rel="stylesheet" type="text/css">

</head>

<body>

<div class="navbar navbar-fixed-top">
  <div class="container">
    <a class="navbar-brand" href="https://github.com/the-simian/es6-plato">ES6 Plato on Github</a>
    <ul class="nav navbar-nav">
      <li>
        <a href="../../index.html">Report Home</a>
      </li>
      <li class="active">
        <a href="display.html">Summary Display</a>
      </li>
    </ul>
  </div>
</div>

<div class="jumbotron">
  <div class="container">
    <h1>node_modules/browserslist/node.js</h1>
  </div>
</div>

<div class="container aggregate-stats">
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Maintainability <a href="http://blogs.msdn.com/b/codeanalysis/archive/2007/11/20/maintainability-index-range-and-meaning.aspx"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="A value between 0 and 100 that represents the relative ease of maintaining the code. A high value means better maintainability." data-original-title="Maintainability Index"  data-container="body"></i></a></h2>
      <p class="stat">63.98</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Lines of code <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h2>
      <p class="stat">503</p>
    </div>
  </div>
  <div class="row historical">
    <div class="col-md-6">
      <p id="chart_historical_maint" class="chart"></p>
    </div>
    <div class="col-md-6">
      <p id="chart_historical_sloc" class="chart"></p>
    </div>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Difficulty  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="The difficulty measure is related to the difficulty of the program to write or understand." data-original-title="Difficulty" data-container="body"></i></a></h2>
      <p class="stat">70.50</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Estimated Errors  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Halstead's delivered bugs is an estimate for the number of errors in the implementation." data-original-title="Delivered Bugs" data-container="body"></i></a></h2>
      <p class="stat">4.85</p>
    </div>
  </div>
</div>

<div class="container charts">
  <div class="row">
    <h2 class="header">Function weight</h2>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h3 class="chart-header">By Complexity <a href="http://en.wikipedia.org/wiki/Cyclomatic_complexity"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="This metric counts the number of distinct paths through a block of code. Lower values are better." data-original-title="Cyclomatic Complexity" data-container="body"></i></a></h3>
      <div id="fn-by-complexity" class="stat"></div>
    </div>
    <div class="col-md-6">
      <h3 class="chart-header">By SLOC  <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h3>
      <div id="fn-by-sloc" class="stat"></div>
    </div>
  </div>
</div>

<div class="container">
  <div class="row">
    <textarea id="file-source" class="col-md-12">var feature = require(&#039;caniuse-lite/dist/unpacker/feature&#039;).default
var region = require(&#039;caniuse-lite/dist/unpacker/region&#039;).default
var fs = require(&#039;fs&#039;)
var path = require(&#039;path&#039;)

var BrowserslistError = require(&#039;./error&#039;)

var IS_SECTION = /^\s*\[(.+)]\s*$/
var CONFIG_PATTERN = /^browserslist-config-/
var SCOPED_CONFIG__PATTERN = /@[^/]+(?:\/[^/]+)?\/browserslist-config(?:-|$|\/)/
var FORMAT =
  &#039;Browserslist config should be a string or an array &#039; +
  &#039;of strings with browser queries&#039;
var PATHTYPE_UNKNOWN = &#039;unknown&#039;
var PATHTYPE_DIR = &#039;directory&#039;
var PATHTYPE_FILE = &#039;file&#039;

var dataTimeChecked = false
var statCache = {}
var configPathCache = {}
var parseConfigCache = {}

function checkExtend(name) {
  var use = &#039; Use `dangerousExtend` option to disable.&#039;
  if (!CONFIG_PATTERN.test(name) &amp;&amp; !SCOPED_CONFIG__PATTERN.test(name)) {
    throw new BrowserslistError(
      &#039;Browserslist config needs `browserslist-config-` prefix. &#039; + use
    )
  }
  if (name.replace(/^@[^/]+\//, &#039;&#039;).indexOf(&#039;.&#039;) !== -1) {
    throw new BrowserslistError(
      &#039;`.` not allowed in Browserslist config name. &#039; + use
    )
  }
  if (name.indexOf(&#039;node_modules&#039;) !== -1) {
    throw new BrowserslistError(
      &#039;`node_modules` not allowed in Browserslist config.&#039; + use
    )
  }
}

function getPathType(filepath) {
  var stats
  try {
    stats = fs.existsSync(filepath) &amp;&amp; fs.statSync(filepath)
  } catch (err) {
    /* c8 ignore start */
    if (
      err.code !== &#039;ENOENT&#039; &amp;&amp;
      err.code !== &#039;EACCES&#039; &amp;&amp;
      err.code !== &#039;ERR_ACCESS_DENIED&#039;
    ) {
      throw err
    }
    /* c8 ignore end */
  }

  if (stats &amp;&amp; stats.isDirectory()) return PATHTYPE_DIR
  if (stats &amp;&amp; stats.isFile()) return PATHTYPE_FILE

  return PATHTYPE_UNKNOWN
}

function isFile(file) {
  return getPathType(file) === PATHTYPE_FILE
}

function isDirectory(dir) {
  return getPathType(dir) === PATHTYPE_DIR
}

function eachParent(file, callback, cache) {
  var loc = path.resolve(file)
  var pathsForCacheResult = []
  var result
  do {
    if (!pathInRoot(loc)) {
      break
    }
    if (cache &amp;&amp; loc in cache) {
      result = cache[loc]
      break
    }
    pathsForCacheResult.push(loc)

    if (!isDirectory(loc)) {
      continue
    }

    var locResult = callback(loc)
    if (typeof locResult !== &#039;undefined&#039;) {
      result = locResult
      break
    }
  } while (loc !== (loc = path.dirname(loc)))

  if (cache &amp;&amp; !process.env.BROWSERSLIST_DISABLE_CACHE) {
    pathsForCacheResult.forEach(function (cachePath) {
      cache[cachePath] = result
    })
  }
  return result
}

function pathInRoot(p) {
  if (!process.env.BROWSERSLIST_ROOT_PATH) return true
  var rootPath = path.resolve(process.env.BROWSERSLIST_ROOT_PATH)
  if (path.relative(rootPath, p).substring(0, 2) === &#039;..&#039;) {
    return false
  }
  return true
}

function check(section) {
  if (Array.isArray(section)) {
    for (var i = 0; i &lt; section.length; i++) {
      if (typeof section[i] !== &#039;string&#039;) {
        throw new BrowserslistError(FORMAT)
      }
    }
  } else if (typeof section !== &#039;string&#039;) {
    throw new BrowserslistError(FORMAT)
  }
}

function pickEnv(config, opts) {
  if (typeof config !== &#039;object&#039;) return config

  var name
  if (typeof opts.env === &#039;string&#039;) {
    name = opts.env
  } else if (process.env.BROWSERSLIST_ENV) {
    name = process.env.BROWSERSLIST_ENV
  } else if (process.env.NODE_ENV) {
    name = process.env.NODE_ENV
  } else {
    name = &#039;production&#039;
  }

  if (opts.throwOnMissing) {
    if (name &amp;&amp; name !== &#039;defaults&#039; &amp;&amp; !config[name]) {
      throw new BrowserslistError(
        &#039;Missing config for Browserslist environment `&#039; + name + &#039;`&#039;
      )
    }
  }

  return config[name] || config.defaults
}

function parsePackage(file) {
  var text = fs
    .readFileSync(file)
    .toString()
    .replace(/^\uFEFF/m, &#039;&#039;)
  var list
  if (text.indexOf(&#039;&quot;browserslist&quot;&#039;) &gt;= 0) {
    list = JSON.parse(text).browserslist
  } else if (text.indexOf(&#039;&quot;browserlist&quot;&#039;) &gt;= 0) {
    var config = JSON.parse(text)
    if (config.browserlist &amp;&amp; !config.browserslist) {
      throw new BrowserslistError(
        &#039;`browserlist` key instead of `browserslist` in &#039; + file
      )
    }
  }
  if (Array.isArray(list) || typeof list === &#039;string&#039;) {
    list = { defaults: list }
  }
  for (var i in list) {
    check(list[i])
  }

  return list
}

function parsePackageOrReadConfig(file) {
  if (file in parseConfigCache) {
    return parseConfigCache[file]
  }

  var isPackage = path.basename(file) === &#039;package.json&#039;
  var result = isPackage ? parsePackage(file) : module.exports.readConfig(file)

  if (!process.env.BROWSERSLIST_DISABLE_CACHE) {
    parseConfigCache[file] = result
  }
  return result
}

function latestReleaseTime(agents) {
  var latest = 0
  for (var name in agents) {
    var dates = agents[name].releaseDate || {}
    for (var key in dates) {
      if (latest &lt; dates[key]) {
        latest = dates[key]
      }
    }
  }
  return latest * 1000
}

function getMonthsPassed(date) {
  var now = new Date()
  var past = new Date(date)

  var years = now.getFullYear() - past.getFullYear()
  var months = now.getMonth() - past.getMonth()

  return years * 12 + months
}

function normalizeStats(data, stats) {
  if (!data) {
    data = {}
  }
  if (stats &amp;&amp; &#039;dataByBrowser&#039; in stats) {
    stats = stats.dataByBrowser
  }

  if (typeof stats !== &#039;object&#039;) return undefined

  var normalized = {}
  for (var i in stats) {
    var versions = Object.keys(stats[i])
    if (versions.length === 1 &amp;&amp; data[i] &amp;&amp; data[i].versions.length === 1) {
      var normal = data[i].versions[0]
      normalized[i] = {}
      normalized[i][normal] = stats[i][versions[0]]
    } else {
      normalized[i] = stats[i]
    }
  }

  return normalized
}

function normalizeUsageData(usageData, data) {
  for (var browser in usageData) {
    var browserUsage = usageData[browser]
    // https://github.com/browserslist/browserslist/issues/431#issuecomment-565230615
    // caniuse-db returns { 0: &quot;percentage&quot; } for `and_*` regional stats
    if (&#039;0&#039; in browserUsage) {
      var versions = data[browser].versions
      browserUsage[versions[versions.length - 1]] = browserUsage[0]
      delete browserUsage[0]
    }
  }
}

module.exports = {
  loadQueries: function loadQueries(ctx, name) {
    if (!ctx.dangerousExtend &amp;&amp; !process.env.BROWSERSLIST_DANGEROUS_EXTEND) {
      checkExtend(name)
    }
    var queries = require(require.resolve(name, { paths: [&#039;.&#039;, ctx.path] }))
    if (typeof queries === &#039;object&#039; &amp;&amp; queries !== null &amp;&amp; queries.__esModule) {
      queries = queries.default
    }
    if (queries) {
      if (Array.isArray(queries)) {
        return queries
      } else if (typeof queries === &#039;object&#039;) {
        if (!queries.defaults) queries.defaults = []
        return pickEnv(queries, ctx, name)
      }
    }
    throw new BrowserslistError(
      &#039;`&#039; +
        name +
        &#039;` config exports not an array of queries&#039; +
        &#039; or an object of envs&#039;
    )
  },

  loadStat: function loadStat(ctx, name, data) {
    if (!ctx.dangerousExtend &amp;&amp; !process.env.BROWSERSLIST_DANGEROUS_EXTEND) {
      checkExtend(name)
    }
    var stats = require(
      // Use forward slashes for module paths, also on Windows.
      require.resolve(path.posix.join(name, &#039;browserslist-stats.json&#039;), {
        paths: [&#039;.&#039;]
      })
    )
    return normalizeStats(data, stats)
  },

  getStat: function getStat(opts, data) {
    var stats
    if (opts.stats) {
      stats = opts.stats
    } else if (process.env.BROWSERSLIST_STATS) {
      stats = process.env.BROWSERSLIST_STATS
    } else if (opts.path &amp;&amp; path.resolve &amp;&amp; fs.existsSync) {
      stats = eachParent(
        opts.path,
        function (dir) {
          var file = path.join(dir, &#039;browserslist-stats.json&#039;)
          return isFile(file) ? file : undefined
        },
        statCache
      )
    }
    if (typeof stats === &#039;string&#039;) {
      try {
        stats = JSON.parse(fs.readFileSync(stats))
      } catch (e) {
        throw new BrowserslistError(&quot;Can&#039;t read &quot; + stats)
      }
    }
    return normalizeStats(data, stats)
  },

  loadConfig: function loadConfig(opts) {
    if (process.env.BROWSERSLIST) {
      return process.env.BROWSERSLIST
    } else if (opts.config || process.env.BROWSERSLIST_CONFIG) {
      var file = opts.config || process.env.BROWSERSLIST_CONFIG
      return pickEnv(parsePackageOrReadConfig(file), opts)
    } else if (opts.path) {
      return pickEnv(module.exports.findConfig(opts.path), opts)
    } else {
      return undefined
    }
  },

  loadCountry: function loadCountry(usage, country, data) {
    var code = country.replace(/[^\w-]/g, &#039;&#039;)
    if (!usage[code]) {
      var compressed
      try {
        compressed = require(&#039;caniuse-lite/data/regions/&#039; + code + &#039;.js&#039;)
      } catch (e) {
        throw new BrowserslistError(&#039;Unknown region name `&#039; + code + &#039;`.&#039;)
      }
      var usageData = region(compressed)
      normalizeUsageData(usageData, data)
      usage[country] = {}
      for (var i in usageData) {
        for (var j in usageData[i]) {
          usage[country][i + &#039; &#039; + j] = usageData[i][j]
        }
      }
    }
  },

  loadFeature: function loadFeature(features, name) {
    name = name.replace(/[^\w-]/g, &#039;&#039;)
    if (features[name]) return
    var compressed
    try {
      compressed = require(&#039;caniuse-lite/data/features/&#039; + name + &#039;.js&#039;)
    } catch (e) {
      throw new BrowserslistError(&#039;Unknown feature name `&#039; + name + &#039;`.&#039;)
    }
    var stats = feature(compressed).stats
    features[name] = {}
    for (var i in stats) {
      features[name][i] = {}
      for (var j in stats[i]) {
        features[name][i][j] = stats[i][j]
      }
    }
  },

  parseConfig: function parseConfig(string) {
    var result = { defaults: [] }
    var sections = [&#039;defaults&#039;]

    string
      .toString()
      .replace(/#[^\n]*/g, &#039;&#039;)
      .split(/\n|,/)
      .map(function (line) {
        return line.trim()
      })
      .filter(function (line) {
        return line !== &#039;&#039;
      })
      .forEach(function (line) {
        if (IS_SECTION.test(line)) {
          sections = line.match(IS_SECTION)[1].trim().split(&#039; &#039;)
          sections.forEach(function (section) {
            if (result[section]) {
              throw new BrowserslistError(
                &#039;Duplicate section &#039; + section + &#039; in Browserslist config&#039;
              )
            }
            result[section] = []
          })
        } else {
          sections.forEach(function (section) {
            result[section].push(line)
          })
        }
      })

    return result
  },

  readConfig: function readConfig(file) {
    if (!isFile(file)) {
      throw new BrowserslistError(&quot;Can&#039;t read &quot; + file + &#039; config&#039;)
    }

    return module.exports.parseConfig(fs.readFileSync(file))
  },

  findConfigFile: function findConfigFile(from) {
    return eachParent(
      from,
      function (dir) {
        var config = path.join(dir, &#039;browserslist&#039;)
        var pkg = path.join(dir, &#039;package.json&#039;)
        var rc = path.join(dir, &#039;.browserslistrc&#039;)

        var pkgBrowserslist
        if (isFile(pkg)) {
          try {
            pkgBrowserslist = parsePackage(pkg)
          } catch (e) {
            if (e.name === &#039;BrowserslistError&#039;) throw e
            console.warn(
              &#039;[Browserslist] Could not parse &#039; + pkg + &#039;. Ignoring it.&#039;
            )
          }
        }

        if (isFile(config) &amp;&amp; pkgBrowserslist) {
          throw new BrowserslistError(
            dir + &#039; contains both browserslist and package.json with browsers&#039;
          )
        } else if (isFile(rc) &amp;&amp; pkgBrowserslist) {
          throw new BrowserslistError(
            dir +
              &#039; contains both .browserslistrc and package.json with browsers&#039;
          )
        } else if (isFile(config) &amp;&amp; isFile(rc)) {
          throw new BrowserslistError(
            dir + &#039; contains both .browserslistrc and browserslist&#039;
          )
        } else if (isFile(config)) {
          return config
        } else if (isFile(rc)) {
          return rc
        } else if (pkgBrowserslist) {
          return pkg
        }
      },
      configPathCache
    )
  },

  findConfig: function findConfig(from) {
    var configFile = this.findConfigFile(from)

    return configFile ? parsePackageOrReadConfig(configFile) : undefined
  },

  clearCaches: function clearCaches() {
    dataTimeChecked = false
    statCache = {}
    configPathCache = {}
    parseConfigCache = {}

    this.cache = {}
  },

  oldDataWarning: function oldDataWarning(agentsObj) {
    if (dataTimeChecked) return
    dataTimeChecked = true
    if (process.env.BROWSERSLIST_IGNORE_OLD_DATA) return

    var latest = latestReleaseTime(agentsObj)
    var monthsPassed = getMonthsPassed(latest)

    if (latest !== 0 &amp;&amp; monthsPassed &gt;= 6) {
      if (process.env.BROWSERSLIST_TRACE_WARNING) {
        console.info(&#039;Last browser release in DB: &#039; + String(new Date(latest)))
        console.trace()
      }

      var months = monthsPassed + &#039; &#039; + (monthsPassed &gt; 1 ? &#039;months&#039; : &#039;month&#039;)
      console.warn(
        &#039;Browserslist: browsers data (caniuse-lite) is &#039; +
          months +
          &#039; old. Please run:\n&#039; +
          &#039;  npx update-browserslist-db@latest\n&#039; +
          &#039;  Why you should do it regularly: &#039; +
          &#039;https://github.com/browserslist/update-db#readme&#039;
      )
    }
  },

  currentNode: function currentNode() {
    return &#039;node &#039; + process.versions.node
  },

  env: process.env
}
</textarea>
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p>.</p>
  </div>
</footer>

<script type="text/html" id="complexity-popover-template">
  <div class="complexity-notice">
    Complexity : {{ complexity.cyclomatic }} <br>
    Length : {{ complexity.halstead.length }} <br>
    Difficulty : {{ complexity.halstead.difficulty.toFixed(2) }} <br>
    Est # bugs : {{ complexity.halstead.bugs.toFixed(2) }}<br>
  </div>
</script>

<script type="text/javascript" src="../../assets/scripts/bundles/core-bundle.js"></script>
<script type="text/javascript" src="../../assets/scripts/bundles/codemirror.js"></script>
<script type="text/javascript" src="../../assets/scripts/codemirror.markpopovertext.js"></script>
<script type="text/javascript" src="report.js"></script>
<script type="text/javascript" src="report.history.js"></script>
<script type="text/javascript" src="../../assets/scripts/plato-file.js"></script>
</body>
</html>
