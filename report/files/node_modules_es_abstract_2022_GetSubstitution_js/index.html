<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Plato - node_modules/es-abstract/2022/GetSubstitution.js</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">

  <!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <link href="../../assets/css/vendor/morris.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/vendor/bootstrap.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/vendor/font-awesome.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/vendor/codemirror.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/plato.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/plato-file.css" rel="stylesheet" type="text/css">

</head>

<body>

<div class="navbar navbar-fixed-top">
  <div class="container">
    <a class="navbar-brand" href="https://github.com/the-simian/es6-plato">ES6 Plato on Github</a>
    <ul class="nav navbar-nav">
      <li>
        <a href="../../index.html">Report Home</a>
      </li>
      <li class="active">
        <a href="display.html">Summary Display</a>
      </li>
    </ul>
  </div>
</div>

<div class="jumbotron">
  <div class="container">
    <h1>node_modules/es-abstract/2022/GetSubstitution.js</h1>
  </div>
</div>

<div class="container aggregate-stats">
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Maintainability <a href="http://blogs.msdn.com/b/codeanalysis/archive/2007/11/20/maintainability-index-range-and-meaning.aspx"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="A value between 0 and 100 that represents the relative ease of maintaining the code. A high value means better maintainability." data-original-title="Maintainability Index"  data-container="body"></i></a></h2>
      <p class="stat">34.19</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Lines of code <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h2>
      <p class="stat">138</p>
    </div>
  </div>
  <div class="row historical">
    <div class="col-md-6">
      <p id="chart_historical_maint" class="chart"></p>
    </div>
    <div class="col-md-6">
      <p id="chart_historical_sloc" class="chart"></p>
    </div>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Difficulty  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="The difficulty measure is related to the difficulty of the program to write or understand." data-original-title="Difficulty" data-container="body"></i></a></h2>
      <p class="stat">42.59</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Estimated Errors  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Halstead's delivered bugs is an estimate for the number of errors in the implementation." data-original-title="Delivered Bugs" data-container="body"></i></a></h2>
      <p class="stat">1.12</p>
    </div>
  </div>
</div>

<div class="container charts">
  <div class="row">
    <h2 class="header">Function weight</h2>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h3 class="chart-header">By Complexity <a href="http://en.wikipedia.org/wiki/Cyclomatic_complexity"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="This metric counts the number of distinct paths through a block of code. Lower values are better." data-original-title="Cyclomatic Complexity" data-container="body"></i></a></h3>
      <div id="fn-by-complexity" class="stat"></div>
    </div>
    <div class="col-md-6">
      <h3 class="chart-header">By SLOC  <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h3>
      <div id="fn-by-sloc" class="stat"></div>
    </div>
  </div>
</div>

<div class="container">
  <div class="row">
    <textarea id="file-source" class="col-md-12">&#039;use strict&#039;;

var $TypeError = require(&#039;es-errors/type&#039;);
var isObject = require(&#039;es-object-atoms/isObject&#039;);
var regexTester = require(&#039;safe-regex-test&#039;);
var inspect = require(&#039;object-inspect&#039;);
var isInteger = require(&#039;math-intrinsics/isInteger&#039;);

var Get = require(&#039;./Get&#039;);
var IsArray = require(&#039;./IsArray&#039;);
var min = require(&#039;./min&#039;);
var StringIndexOf = require(&#039;./StringIndexOf&#039;);
var StringToNumber = require(&#039;./StringToNumber&#039;);
var substring = require(&#039;./substring&#039;);
var ToString = require(&#039;./ToString&#039;);

var every = require(&#039;../helpers/every&#039;);
var isPrefixOf = require(&#039;../helpers/isPrefixOf&#039;);
var isStringOrUndefined = require(&#039;../helpers/isStringOrUndefined&#039;);

var startsWithDollarDigit = regexTester(/^\$[0-9]/);

// http://www.ecma-international.org/ecma-262/13.0/#sec-getsubstitution

// eslint-disable-next-line max-statements, max-params, max-lines-per-function
module.exports = function GetSubstitution(matched, str, position, captures, namedCaptures, replacementTemplate) {
	if (typeof matched !== &#039;string&#039;) {
		throw new $TypeError(&#039;Assertion failed: `matched` must be a String&#039;);
	}

	if (typeof str !== &#039;string&#039;) {
		throw new $TypeError(&#039;Assertion failed: `str` must be a String&#039;);
	}

	if (!isInteger(position) || position &lt; 0) {
		throw new $TypeError(&#039;Assertion failed: `position` must be a nonnegative integer, got &#039; + inspect(position));
	}

	if (!IsArray(captures) || !every(captures, isStringOrUndefined)) {
		throw new $TypeError(&#039;Assertion failed: `captures` must be a possibly-empty List of Strings or `undefined`, got &#039; + inspect(captures));
	}

	if (typeof namedCaptures !== &#039;undefined&#039; &amp;&amp; !isObject(namedCaptures)) {
		throw new $TypeError(&#039;Assertion failed: `namedCaptures` must be `undefined` or an Object&#039;);
	}

	if (typeof replacementTemplate !== &#039;string&#039;) {
		throw new $TypeError(&#039;Assertion failed: `replacementTemplate` must be a String&#039;);
	}

	var stringLength = str.length; // step 1

	if (position &gt; stringLength) {
		throw new $TypeError(&#039;Assertion failed: position &gt; stringLength, got &#039; + inspect(position)); // step 2
	}

	var templateRemainder = replacementTemplate; // step 3

	var result = &#039;&#039;; // step 4

	while (templateRemainder !== &#039;&#039;) { // step 5
		// 5.a NOTE: The following steps isolate ref (a prefix of templateRemainder), determine refReplacement (its replacement), and then append that replacement to result.

		var ref, refReplacement, found, capture;
		if (isPrefixOf(&#039;$$&#039;, templateRemainder)) { // step 5.b
			ref = &#039;$$&#039;; // step 5.b.i
			refReplacement = &#039;$&#039;; // step 5.b.ii
		} else if (isPrefixOf(&#039;$`&#039;, templateRemainder)) { // step 5.c
			ref = &#039;$`&#039;; // step 5.c.i
			refReplacement = substring(str, 0, position); // step 5.c.ii
		} else if (isPrefixOf(&#039;$&amp;&#039;, templateRemainder)) { // step 5.d
			ref = &#039;$&amp;&#039;; // step 5.d.i
			refReplacement = matched; // step 5.d.ii
		} else if (isPrefixOf(&#039;$\&#039;&#039;, templateRemainder)) { // step 5.e
			ref = &#039;$\&#039;&#039;; // step 5.e.i
			var matchLength = matched.length; // step 5.e.ii
			var tailPos = position + matchLength; // step 5.e.iii
			refReplacement = substring(str, min(tailPos, stringLength)); // step 5.e.iv
			// 5.e.v NOTE: tailPos can exceed stringLength only if this abstract operation was invoked by a call to the intrinsic @@replace method of %RegExp.prototype% on an object whose &quot;exec&quot; property is not the intrinsic %RegExp.prototype.exec%.
		} else if (startsWithDollarDigit(templateRemainder)) { // step 5.f
			found = false; // step 5.f.i
			for (var d = 2; d &gt; 0; d -= 1) { // step 5.f.ii
				// If found is false and templateRemainder starts with &quot;$&quot; followed by d or more decimal digits, then
				if (!found) { // step 5.f.ii.1
					found = true; // step 5.f.ii.1.a
					ref = substring(templateRemainder, 0, 1 + d); // step 5.f.ii.1.b
					var digits = substring(templateRemainder, 1, 1 + d); // step 5.f.ii.1.c
					var index = StringToNumber(digits); // step 5.f.ii.1.d
					if (index &lt; 0 || index &gt; 99) {
						throw new $TypeError(&#039;Assertion failed: `index` must be &gt;= 0 and &lt;= 99&#039;); // step 5.f.ii.1.e
					}
					if (index === 0) { // step 5.f.ii.1.f
						refReplacement = ref;
					} else if (index &lt;= captures.length) { // step 5.f.ii.1.g
						capture = captures[index - 1]; // step 5.f.ii.1.g.i
						if (typeof capture === &#039;undefined&#039;) { // step 5.f.ii.1.g.ii
							refReplacement = &#039;&#039;; // step 5.f.ii.1.g.ii.i
						} else { // step 5.f.ii.1.g.iii
							refReplacement = capture; // step 5.f.ii.1.g.iii.i
						}
					} else { // step 5.f.ii.1.h
						refReplacement = ref; // step 5.f.ii.1.h.i
					}
				}
			}
		} else if (isPrefixOf(&#039;$&lt;&#039;, templateRemainder)) { // step 5.g
			var gtPos = StringIndexOf(templateRemainder, &#039;&gt;&#039;, 0); // step 5.g.i
			if (gtPos === -1 || typeof namedCaptures === &#039;undefined&#039;) { // step 5.g.ii
				ref = &#039;$&lt;&#039;; // step 5.g.ii.1
				refReplacement = ref; // step 5.g.ii.2
			} else { // step 5.g.iii
				ref = substring(templateRemainder, 0, gtPos + 1); // step 5.g.iii.1
				var groupName = substring(templateRemainder, 2, gtPos); // step 5.g.iii.2
				if (!isObject(namedCaptures)) {
					throw new $TypeError(&#039;Assertion failed: Type(namedCaptures) is not Object&#039;); // step 5.g.iii.3
				}
				capture = Get(namedCaptures, groupName); // step 5.g.iii.4
				if (typeof capture === &#039;undefined&#039;) { // step 5.g.iii.5
					refReplacement = &#039;&#039;; // step 5.g.iii.5.a
				} else { // step 5.g.iii.6
					refReplacement = ToString(capture); // step 5.g.iii.6.a
				}
			}
		} else { // step 5.h
			ref = substring(templateRemainder, 0, 1); // step 5.h.i
			refReplacement = ref; // step 5.h.ii
		}

		var refLength = ref.length; // step 5.i

		templateRemainder = substring(templateRemainder, refLength); // step 5.j

		result += refReplacement; // step 5.k
	}

	return result; // step 6
};
</textarea>
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p>.</p>
  </div>
</footer>

<script type="text/html" id="complexity-popover-template">
  <div class="complexity-notice">
    Complexity : {{ complexity.cyclomatic }} <br>
    Length : {{ complexity.halstead.length }} <br>
    Difficulty : {{ complexity.halstead.difficulty.toFixed(2) }} <br>
    Est # bugs : {{ complexity.halstead.bugs.toFixed(2) }}<br>
  </div>
</script>

<script type="text/javascript" src="../../assets/scripts/bundles/core-bundle.js"></script>
<script type="text/javascript" src="../../assets/scripts/bundles/codemirror.js"></script>
<script type="text/javascript" src="../../assets/scripts/codemirror.markpopovertext.js"></script>
<script type="text/javascript" src="report.js"></script>
<script type="text/javascript" src="report.history.js"></script>
<script type="text/javascript" src="../../assets/scripts/plato-file.js"></script>
</body>
</html>
