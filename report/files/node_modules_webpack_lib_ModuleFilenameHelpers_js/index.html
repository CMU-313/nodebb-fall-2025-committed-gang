<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Plato - node_modules/webpack/lib/ModuleFilenameHelpers.js</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">

  <!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <link href="../../assets/css/vendor/morris.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/vendor/bootstrap.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/vendor/font-awesome.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/vendor/codemirror.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/plato.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/plato-file.css" rel="stylesheet" type="text/css">

</head>

<body>

<div class="navbar navbar-fixed-top">
  <div class="container">
    <a class="navbar-brand" href="https://github.com/the-simian/es6-plato">ES6 Plato on Github</a>
    <ul class="nav navbar-nav">
      <li>
        <a href="../../index.html">Report Home</a>
      </li>
      <li class="active">
        <a href="display.html">Summary Display</a>
      </li>
    </ul>
  </div>
</div>

<div class="jumbotron">
  <div class="container">
    <h1>node_modules/webpack/lib/ModuleFilenameHelpers.js</h1>
  </div>
</div>

<div class="container aggregate-stats">
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Maintainability <a href="http://blogs.msdn.com/b/codeanalysis/archive/2007/11/20/maintainability-index-range-and-meaning.aspx"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="A value between 0 and 100 that represents the relative ease of maintaining the code. A high value means better maintainability." data-original-title="Maintainability Index"  data-container="body"></i></a></h2>
      <p class="stat">71.31</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Lines of code <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h2>
      <p class="stat">370</p>
    </div>
  </div>
  <div class="row historical">
    <div class="col-md-6">
      <p id="chart_historical_maint" class="chart"></p>
    </div>
    <div class="col-md-6">
      <p id="chart_historical_sloc" class="chart"></p>
    </div>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Difficulty  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="The difficulty measure is related to the difficulty of the program to write or understand." data-original-title="Difficulty" data-container="body"></i></a></h2>
      <p class="stat">40.15</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Estimated Errors  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Halstead's delivered bugs is an estimate for the number of errors in the implementation." data-original-title="Delivered Bugs" data-container="body"></i></a></h2>
      <p class="stat">2.53</p>
    </div>
  </div>
</div>

<div class="container charts">
  <div class="row">
    <h2 class="header">Function weight</h2>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h3 class="chart-header">By Complexity <a href="http://en.wikipedia.org/wiki/Cyclomatic_complexity"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="This metric counts the number of distinct paths through a block of code. Lower values are better." data-original-title="Cyclomatic Complexity" data-container="body"></i></a></h3>
      <div id="fn-by-complexity" class="stat"></div>
    </div>
    <div class="col-md-6">
      <h3 class="chart-header">By SLOC  <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h3>
      <div id="fn-by-sloc" class="stat"></div>
    </div>
  </div>
</div>

<div class="container">
  <div class="row">
    <textarea id="file-source" class="col-md-12">/*
	MIT License http://www.opensource.org/licenses/mit-license.php
	Author Tobias Koppers @sokra
*/

&quot;use strict&quot;;

const NormalModule = require(&quot;./NormalModule&quot;);
const { DEFAULTS } = require(&quot;./config/defaults&quot;);
const createHash = require(&quot;./util/createHash&quot;);
const memoize = require(&quot;./util/memoize&quot;);

/** @typedef {import(&quot;../declarations/WebpackOptions&quot;).DevtoolModuleFilenameTemplate} DevtoolModuleFilenameTemplate */
/** @typedef {import(&quot;../declarations/WebpackOptions&quot;).HashFunction} HashFunction */
/** @typedef {import(&quot;./ChunkGraph&quot;)} ChunkGraph */
/** @typedef {import(&quot;./Module&quot;)} Module */
/** @typedef {import(&quot;./RequestShortener&quot;)} RequestShortener */

/** @typedef {string | RegExp | (string | RegExp)[]} Matcher */
/** @typedef {{ test?: Matcher, include?: Matcher, exclude?: Matcher }} MatchObject */

const ModuleFilenameHelpers = module.exports;

// TODO webpack 6: consider removing these
ModuleFilenameHelpers.ALL_LOADERS_RESOURCE = &quot;[all-loaders][resource]&quot;;
ModuleFilenameHelpers.REGEXP_ALL_LOADERS_RESOURCE =
	/\[all-?loaders\]\[resource\]/gi;
ModuleFilenameHelpers.LOADERS_RESOURCE = &quot;[loaders][resource]&quot;;
ModuleFilenameHelpers.REGEXP_LOADERS_RESOURCE = /\[loaders\]\[resource\]/gi;
ModuleFilenameHelpers.RESOURCE = &quot;[resource]&quot;;
ModuleFilenameHelpers.REGEXP_RESOURCE = /\[resource\]/gi;
ModuleFilenameHelpers.ABSOLUTE_RESOURCE_PATH = &quot;[absolute-resource-path]&quot;;
// cSpell:words olute
ModuleFilenameHelpers.REGEXP_ABSOLUTE_RESOURCE_PATH =
	/\[abs(olute)?-?resource-?path\]/gi;
ModuleFilenameHelpers.RESOURCE_PATH = &quot;[resource-path]&quot;;
ModuleFilenameHelpers.REGEXP_RESOURCE_PATH = /\[resource-?path\]/gi;
ModuleFilenameHelpers.ALL_LOADERS = &quot;[all-loaders]&quot;;
ModuleFilenameHelpers.REGEXP_ALL_LOADERS = /\[all-?loaders\]/gi;
ModuleFilenameHelpers.LOADERS = &quot;[loaders]&quot;;
ModuleFilenameHelpers.REGEXP_LOADERS = /\[loaders\]/gi;
ModuleFilenameHelpers.QUERY = &quot;[query]&quot;;
ModuleFilenameHelpers.REGEXP_QUERY = /\[query\]/gi;
ModuleFilenameHelpers.ID = &quot;[id]&quot;;
ModuleFilenameHelpers.REGEXP_ID = /\[id\]/gi;
ModuleFilenameHelpers.HASH = &quot;[hash]&quot;;
ModuleFilenameHelpers.REGEXP_HASH = /\[hash\]/gi;
ModuleFilenameHelpers.NAMESPACE = &quot;[namespace]&quot;;
ModuleFilenameHelpers.REGEXP_NAMESPACE = /\[namespace\]/gi;

/** @typedef {() =&gt; string} ReturnStringCallback */

/**
 * Returns a function that returns the part of the string after the token
 * @param {ReturnStringCallback} strFn the function to get the string
 * @param {string} token the token to search for
 * @returns {ReturnStringCallback} a function that returns the part of the string after the token
 */
const getAfter = (strFn, token) =&gt; () =&gt; {
	const str = strFn();
	const idx = str.indexOf(token);
	return idx &lt; 0 ? &quot;&quot; : str.slice(idx);
};

/**
 * Returns a function that returns the part of the string before the token
 * @param {ReturnStringCallback} strFn the function to get the string
 * @param {string} token the token to search for
 * @returns {ReturnStringCallback} a function that returns the part of the string before the token
 */
const getBefore = (strFn, token) =&gt; () =&gt; {
	const str = strFn();
	const idx = str.lastIndexOf(token);
	return idx &lt; 0 ? &quot;&quot; : str.slice(0, idx);
};

/**
 * Returns a function that returns a hash of the string
 * @param {ReturnStringCallback} strFn the function to get the string
 * @param {HashFunction=} hashFunction the hash function to use
 * @returns {ReturnStringCallback} a function that returns the hash of the string
 */
const getHash =
	(strFn, hashFunction = DEFAULTS.HASH_FUNCTION) =&gt;
	() =&gt; {
		const hash = createHash(hashFunction);
		hash.update(strFn());
		const digest = /** @type {string} */ (hash.digest(&quot;hex&quot;));
		return digest.slice(0, 4);
	};

/**
 * @template T
 * Returns a lazy object. The object is lazy in the sense that the properties are
 * only evaluated when they are accessed. This is only obtained by setting a function as the value for each key.
 * @param {Record&lt;string, () =&gt; T&gt;} obj the object to convert to a lazy access object
 * @returns {T} the lazy access object
 */
const lazyObject = obj =&gt; {
	const newObj = /** @type {T} */ ({});
	for (const key of Object.keys(obj)) {
		const fn = obj[key];
		Object.defineProperty(newObj, key, {
			get: () =&gt; fn(),
			set: v =&gt; {
				Object.defineProperty(newObj, key, {
					value: v,
					enumerable: true,
					writable: true
				});
			},
			enumerable: true,
			configurable: true
		});
	}
	return newObj;
};

const SQUARE_BRACKET_TAG_REGEXP = /\[\\*([\w-]+)\\*\]/gi;

/** @typedef {((context: TODO) =&gt; string)} ModuleFilenameTemplateFunction */
/** @typedef {string | ModuleFilenameTemplateFunction} ModuleFilenameTemplate */

/**
 * @param {Module | string} module the module
 * @param {{ namespace?: string, moduleFilenameTemplate?: ModuleFilenameTemplate }} options options
 * @param {{ requestShortener: RequestShortener, chunkGraph: ChunkGraph, hashFunction?: HashFunction }} contextInfo context info
 * @returns {string} the filename
 */
ModuleFilenameHelpers.createFilename = (
	// eslint-disable-next-line default-param-last
	module = &quot;&quot;,
	options,
	{ requestShortener, chunkGraph, hashFunction = DEFAULTS.HASH_FUNCTION }
) =&gt; {
	const opts = {
		namespace: &quot;&quot;,
		moduleFilenameTemplate: &quot;&quot;,
		...(typeof options === &quot;object&quot;
			? options
			: {
					moduleFilenameTemplate: options
				})
	};

	/** @type {ReturnStringCallback} */
	let absoluteResourcePath;
	let hash;
	/** @type {ReturnStringCallback} */
	let identifier;
	/** @type {ReturnStringCallback} */
	let moduleId;
	/** @type {ReturnStringCallback} */
	let shortIdentifier;
	if (typeof module === &quot;string&quot;) {
		shortIdentifier =
			/** @type {ReturnStringCallback} */
			(memoize(() =&gt; requestShortener.shorten(module)));
		identifier = shortIdentifier;
		moduleId = () =&gt; &quot;&quot;;
		absoluteResourcePath = () =&gt;
			/** @type {string} */ (module.split(&quot;!&quot;).pop());
		hash = getHash(identifier, hashFunction);
	} else {
		shortIdentifier = memoize(() =&gt;
			module.readableIdentifier(requestShortener)
		);
		identifier =
			/** @type {ReturnStringCallback} */
			(memoize(() =&gt; requestShortener.shorten(module.identifier())));
		moduleId =
			/** @type {ReturnStringCallback} */
			(() =&gt; chunkGraph.getModuleId(module));
		absoluteResourcePath = () =&gt;
			module instanceof NormalModule
				? module.resource
				: /** @type {string} */ (module.identifier().split(&quot;!&quot;).pop());
		hash = getHash(identifier, hashFunction);
	}
	const resource =
		/** @type {ReturnStringCallback} */
		(memoize(() =&gt; shortIdentifier().split(&quot;!&quot;).pop()));

	const loaders = getBefore(shortIdentifier, &quot;!&quot;);
	const allLoaders = getBefore(identifier, &quot;!&quot;);
	const query = getAfter(resource, &quot;?&quot;);
	const resourcePath = () =&gt; {
		const q = query().length;
		return q === 0 ? resource() : resource().slice(0, -q);
	};
	if (typeof opts.moduleFilenameTemplate === &quot;function&quot;) {
		return opts.moduleFilenameTemplate(
			lazyObject({
				identifier,
				shortIdentifier,
				resource,
				resourcePath: memoize(resourcePath),
				absoluteResourcePath: memoize(absoluteResourcePath),
				loaders: memoize(loaders),
				allLoaders: memoize(allLoaders),
				query: memoize(query),
				moduleId: memoize(moduleId),
				hash: memoize(hash),
				namespace: () =&gt; opts.namespace
			})
		);
	}

	// TODO webpack 6: consider removing alternatives without dashes
	/** @type {Map&lt;string, () =&gt; string&gt;} */
	const replacements = new Map([
		[&quot;identifier&quot;, identifier],
		[&quot;short-identifier&quot;, shortIdentifier],
		[&quot;resource&quot;, resource],
		[&quot;resource-path&quot;, resourcePath],
		// cSpell:words resourcepath
		[&quot;resourcepath&quot;, resourcePath],
		[&quot;absolute-resource-path&quot;, absoluteResourcePath],
		[&quot;abs-resource-path&quot;, absoluteResourcePath],
		// cSpell:words absoluteresource
		[&quot;absoluteresource-path&quot;, absoluteResourcePath],
		// cSpell:words absresource
		[&quot;absresource-path&quot;, absoluteResourcePath],
		// cSpell:words resourcepath
		[&quot;absolute-resourcepath&quot;, absoluteResourcePath],
		// cSpell:words resourcepath
		[&quot;abs-resourcepath&quot;, absoluteResourcePath],
		// cSpell:words absoluteresourcepath
		[&quot;absoluteresourcepath&quot;, absoluteResourcePath],
		// cSpell:words absresourcepath
		[&quot;absresourcepath&quot;, absoluteResourcePath],
		[&quot;all-loaders&quot;, allLoaders],
		// cSpell:words allloaders
		[&quot;allloaders&quot;, allLoaders],
		[&quot;loaders&quot;, loaders],
		[&quot;query&quot;, query],
		[&quot;id&quot;, moduleId],
		[&quot;hash&quot;, hash],
		[&quot;namespace&quot;, () =&gt; opts.namespace]
	]);

	// TODO webpack 6: consider removing weird double placeholders
	return /** @type {string} */ (opts.moduleFilenameTemplate)
		.replace(ModuleFilenameHelpers.REGEXP_ALL_LOADERS_RESOURCE, &quot;[identifier]&quot;)
		.replace(
			ModuleFilenameHelpers.REGEXP_LOADERS_RESOURCE,
			&quot;[short-identifier]&quot;
		)
		.replace(SQUARE_BRACKET_TAG_REGEXP, (match, content) =&gt; {
			if (content.length + 2 === match.length) {
				const replacement = replacements.get(content.toLowerCase());
				if (replacement !== undefined) {
					return replacement();
				}
			} else if (match.startsWith(&quot;[\\&quot;) &amp;&amp; match.endsWith(&quot;\\]&quot;)) {
				return `[${match.slice(2, -2)}]`;
			}
			return match;
		});
};

/**
 * Replaces duplicate items in an array with new values generated by a callback function.
 * The callback function is called with the duplicate item, the index of the duplicate item, and the number of times the item has been replaced.
 * The callback function should return the new value for the duplicate item.
 * @template T
 * @param {T[]} array the array with duplicates to be replaced
 * @param {(duplicateItem: T, duplicateItemIndex: number, numberOfTimesReplaced: number) =&gt; T} fn callback function to generate new values for the duplicate items
 * @param {(firstElement:T, nextElement:T) =&gt; -1 | 0 | 1=} comparator optional comparator function to sort the duplicate items
 * @returns {T[]} the array with duplicates replaced
 * @example
 * ```js
 * const array = [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;a&quot;, &quot;b&quot;, &quot;a&quot;];
 * const result = ModuleFilenameHelpers.replaceDuplicates(array, (item, index, count) =&gt; `${item}-${count}`);
 * // result: [&quot;a-1&quot;, &quot;b-1&quot;, &quot;c&quot;, &quot;a-2&quot;, &quot;b-2&quot;, &quot;a-3&quot;]
 * ```
 */
ModuleFilenameHelpers.replaceDuplicates = (array, fn, comparator) =&gt; {
	const countMap = Object.create(null);
	const posMap = Object.create(null);

	for (const [idx, item] of array.entries()) {
		countMap[item] = countMap[item] || [];
		countMap[item].push(idx);
		posMap[item] = 0;
	}
	if (comparator) {
		for (const item of Object.keys(countMap)) {
			countMap[item].sort(comparator);
		}
	}
	return array.map((item, i) =&gt; {
		if (countMap[item].length &gt; 1) {
			if (comparator &amp;&amp; countMap[item][0] === i) return item;
			return fn(item, i, posMap[item]++);
		}
		return item;
	});
};

/**
 * Tests if a string matches a RegExp or an array of RegExp.
 * @param {string} str string to test
 * @param {Matcher} test value which will be used to match against the string
 * @returns {boolean} true, when the RegExp matches
 * @example
 * ```js
 * ModuleFilenameHelpers.matchPart(&quot;foo.js&quot;, &quot;foo&quot;); // true
 * ModuleFilenameHelpers.matchPart(&quot;foo.js&quot;, &quot;foo.js&quot;); // true
 * ModuleFilenameHelpers.matchPart(&quot;foo.js&quot;, &quot;foo.&quot;); // false
 * ModuleFilenameHelpers.matchPart(&quot;foo.js&quot;, &quot;foo*&quot;); // false
 * ModuleFilenameHelpers.matchPart(&quot;foo.js&quot;, &quot;foo.*&quot;); // true
 * ModuleFilenameHelpers.matchPart(&quot;foo.js&quot;, /^foo/); // true
 * ModuleFilenameHelpers.matchPart(&quot;foo.js&quot;, [/^foo/, &quot;bar&quot;]); // true
 * ModuleFilenameHelpers.matchPart(&quot;foo.js&quot;, [/^foo/, &quot;bar&quot;]); // true
 * ModuleFilenameHelpers.matchPart(&quot;foo.js&quot;, [/^foo/, /^bar/]); // true
 * ModuleFilenameHelpers.matchPart(&quot;foo.js&quot;, [/^baz/, /^bar/]); // false
 * ```
 */
const matchPart = (str, test) =&gt; {
	if (!test) return true;
	if (Array.isArray(test)) {
		return test.some(test =&gt; matchPart(str, test));
	}
	if (typeof test === &quot;string&quot;) {
		return str.startsWith(test);
	}
	return test.test(str);
};

ModuleFilenameHelpers.matchPart = matchPart;

/**
 * Tests if a string matches a match object. The match object can have the following properties:
 * - `test`: a RegExp or an array of RegExp
 * - `include`: a RegExp or an array of RegExp
 * - `exclude`: a RegExp or an array of RegExp
 *
 * The `test` property is tested first, then `include` and then `exclude`.
 * @param {MatchObject} obj a match object to test against the string
 * @param {string} str string to test against the matching object
 * @returns {boolean} true, when the object matches
 * @example
 * ```js
 * ModuleFilenameHelpers.matchObject({ test: &quot;foo.js&quot; }, &quot;foo.js&quot;); // true
 * ModuleFilenameHelpers.matchObject({ test: /^foo/ }, &quot;foo.js&quot;); // true
 * ModuleFilenameHelpers.matchObject({ test: [/^foo/, &quot;bar&quot;] }, &quot;foo.js&quot;); // true
 * ModuleFilenameHelpers.matchObject({ test: [/^foo/, &quot;bar&quot;] }, &quot;baz.js&quot;); // false
 * ModuleFilenameHelpers.matchObject({ include: &quot;foo.js&quot; }, &quot;foo.js&quot;); // true
 * ModuleFilenameHelpers.matchObject({ include: &quot;foo.js&quot; }, &quot;bar.js&quot;); // false
 * ModuleFilenameHelpers.matchObject({ include: /^foo/ }, &quot;foo.js&quot;); // true
 * ModuleFilenameHelpers.matchObject({ include: [/^foo/, &quot;bar&quot;] }, &quot;foo.js&quot;); // true
 * ModuleFilenameHelpers.matchObject({ include: [/^foo/, &quot;bar&quot;] }, &quot;baz.js&quot;); // false
 * ModuleFilenameHelpers.matchObject({ exclude: &quot;foo.js&quot; }, &quot;foo.js&quot;); // false
 * ModuleFilenameHelpers.matchObject({ exclude: [/^foo/, &quot;bar&quot;] }, &quot;foo.js&quot;); // false
 * ```
 */
ModuleFilenameHelpers.matchObject = (obj, str) =&gt; {
	if (obj.test &amp;&amp; !ModuleFilenameHelpers.matchPart(str, obj.test)) {
		return false;
	}
	if (obj.include &amp;&amp; !ModuleFilenameHelpers.matchPart(str, obj.include)) {
		return false;
	}
	if (obj.exclude &amp;&amp; ModuleFilenameHelpers.matchPart(str, obj.exclude)) {
		return false;
	}
	return true;
};
</textarea>
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p>.</p>
  </div>
</footer>

<script type="text/html" id="complexity-popover-template">
  <div class="complexity-notice">
    Complexity : {{ complexity.cyclomatic }} <br>
    Length : {{ complexity.halstead.length }} <br>
    Difficulty : {{ complexity.halstead.difficulty.toFixed(2) }} <br>
    Est # bugs : {{ complexity.halstead.bugs.toFixed(2) }}<br>
  </div>
</script>

<script type="text/javascript" src="../../assets/scripts/bundles/core-bundle.js"></script>
<script type="text/javascript" src="../../assets/scripts/bundles/codemirror.js"></script>
<script type="text/javascript" src="../../assets/scripts/codemirror.markpopovertext.js"></script>
<script type="text/javascript" src="report.js"></script>
<script type="text/javascript" src="report.history.js"></script>
<script type="text/javascript" src="../../assets/scripts/plato-file.js"></script>
</body>
</html>
