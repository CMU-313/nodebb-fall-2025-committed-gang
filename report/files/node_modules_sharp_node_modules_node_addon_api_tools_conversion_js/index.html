<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Plato - node_modules/sharp/node_modules/node-addon-api/tools/conversion.js</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">

  <!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <link href="../../assets/css/vendor/morris.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/vendor/bootstrap.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/vendor/font-awesome.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/vendor/codemirror.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/plato.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/plato-file.css" rel="stylesheet" type="text/css">

</head>

<body>

<div class="navbar navbar-fixed-top">
  <div class="container">
    <a class="navbar-brand" href="https://github.com/the-simian/es6-plato">ES6 Plato on Github</a>
    <ul class="nav navbar-nav">
      <li>
        <a href="../../index.html">Report Home</a>
      </li>
      <li class="active">
        <a href="display.html">Summary Display</a>
      </li>
    </ul>
  </div>
</div>

<div class="jumbotron">
  <div class="container">
    <h1>node_modules/sharp/node_modules/node-addon-api/tools/conversion.js</h1>
  </div>
</div>

<div class="container aggregate-stats">
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Maintainability <a href="http://blogs.msdn.com/b/codeanalysis/archive/2007/11/20/maintainability-index-range-and-meaning.aspx"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="A value between 0 and 100 that represents the relative ease of maintaining the code. A high value means better maintainability." data-original-title="Maintainability Index"  data-container="body"></i></a></h2>
      <p class="stat">73.09</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Lines of code <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h2>
      <p class="stat">302</p>
    </div>
  </div>
  <div class="row historical">
    <div class="col-md-6">
      <p id="chart_historical_maint" class="chart"></p>
    </div>
    <div class="col-md-6">
      <p id="chart_historical_sloc" class="chart"></p>
    </div>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Difficulty  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="The difficulty measure is related to the difficulty of the program to write or understand." data-original-title="Difficulty" data-container="body"></i></a></h2>
      <p class="stat">17.35</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Estimated Errors  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Halstead's delivered bugs is an estimate for the number of errors in the implementation." data-original-title="Delivered Bugs" data-container="body"></i></a></h2>
      <p class="stat">2.77</p>
    </div>
  </div>
</div>

<div class="container charts">
  <div class="row">
    <h2 class="header">Function weight</h2>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h3 class="chart-header">By Complexity <a href="http://en.wikipedia.org/wiki/Cyclomatic_complexity"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="This metric counts the number of distinct paths through a block of code. Lower values are better." data-original-title="Cyclomatic Complexity" data-container="body"></i></a></h3>
      <div id="fn-by-complexity" class="stat"></div>
    </div>
    <div class="col-md-6">
      <h3 class="chart-header">By SLOC  <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h3>
      <div id="fn-by-sloc" class="stat"></div>
    </div>
  </div>
</div>

<div class="container">
  <div class="row">
    <textarea id="file-source" class="col-md-12">//#! /usr/bin/env node

&#039;use strict&#039;;

const fs = require(&#039;fs&#039;);
const path = require(&#039;path&#039;);

const args = process.argv.slice(2);
const dir = args[0];
if (!dir) {
  console.log(&#039;Usage: node &#039; + path.basename(__filename) + &#039; &lt;target-dir&gt;&#039;);
  process.exit(1);
}

const NodeApiVersion = require(&#039;../package.json&#039;).version;

const disable = args[1];
let ConfigFileOperations;
if (disable !== &#039;--disable&#039; &amp;&amp; dir !== &#039;--disable&#039;) {
  ConfigFileOperations = {
    &#039;package.json&#039;: [
      [/([ ]*)&quot;dependencies&quot;: {/g, &#039;$1&quot;dependencies&quot;: {\n$1  &quot;node-addon-api&quot;: &quot;&#039; + NodeApiVersion + &#039;&quot;,&#039;],
      [/[ ]*&quot;nan&quot;: *&quot;[^&quot;]+&quot;(,|)[\n\r]/g, &#039;&#039;]
    ],
    &#039;binding.gyp&#039;: [
      [/([ ]*)&#039;include_dirs&#039;: \[/g, &#039;$1\&#039;include_dirs\&#039;: [\n$1  \&#039;&lt;!(node -p &quot;require(\\\&#039;node-addon-api\\\&#039;).include_dir&quot;)\&#039;,&#039;],
      [/([ ]*)&quot;include_dirs&quot;: \[/g, &#039;$1&quot;include_dirs&quot;: [\n$1  &quot;&lt;!(node -p \\&quot;require(\&#039;node-addon-api\&#039;).include_dir\\&quot;)&quot;,&#039;],
      [/[ ]*(&quot;|&#039;)&lt;!\(node -e (&quot;|&#039;|\\&quot;|\\&#039;)require\((&quot;|&#039;|\\&quot;|\\&#039;)nan(&quot;|&#039;|\\&quot;|\\&#039;)\)(&quot;|&#039;|\\&quot;|\\&#039;)\)(&quot;|&#039;)(,|)[\r\n]/g, &#039;&#039;],
      [/([ ]*)(&quot;|&#039;)target_name(&quot;|&#039;): (&quot;|&#039;)(.+?)(&quot;|&#039;),/g, &#039;$1$2target_name$2: $4$5$6,\n      $2cflags!$2: [ $2-fno-exceptions$2 ],\n      $2cflags_cc!$2: [ $2-fno-exceptions$2 ],\n      $2xcode_settings$2: { $2GCC_ENABLE_CPP_EXCEPTIONS$2: $2YES$2,\n        $2CLANG_CXX_LIBRARY$2: $2libc++$2,\n        $2MACOSX_DEPLOYMENT_TARGET$2: $210.7$2,\n      },\n      $2msvs_settings$2: {\n        $2VCCLCompilerTool$2: { $2ExceptionHandling$2: 1 },\n      },&#039;]
    ]
  };
} else {
  ConfigFileOperations = {
    &#039;package.json&#039;: [
      [/([ ]*)&quot;dependencies&quot;: {/g, &#039;$1&quot;dependencies&quot;: {\n$1  &quot;node-addon-api&quot;: &quot;&#039; + NodeApiVersion + &#039;&quot;,&#039;],
      [/[ ]*&quot;nan&quot;: *&quot;[^&quot;]+&quot;(,|)[\n\r]/g, &#039;&#039;]
    ],
    &#039;binding.gyp&#039;: [
      [/([ ]*)&#039;include_dirs&#039;: \[/g, &#039;$1\&#039;include_dirs\&#039;: [\n$1  \&#039;&lt;!(node -p &quot;require(\\\&#039;node-addon-api\\\&#039;).include_dir&quot;)\&#039;,&#039;],
      [/([ ]*)&quot;include_dirs&quot;: \[/g, &#039;$1&quot;include_dirs&quot;: [\n$1  &quot;&lt;!(node -p \&#039;require(\\&quot;node-addon-api\\&quot;).include_dir\&#039;)&quot;,&#039;],
      [/[ ]*(&quot;|&#039;)&lt;!\(node -e (&quot;|&#039;|\\&quot;|\\&#039;)require\((&quot;|&#039;|\\&quot;|\\&#039;)nan(&quot;|&#039;|\\&quot;|\\&#039;)\)(&quot;|&#039;|\\&quot;|\\&#039;)\)(&quot;|&#039;)(,|)[\r\n]/g, &#039;&#039;],
      [/([ ]*)(&quot;|&#039;)target_name(&quot;|&#039;): (&quot;|&#039;)(.+?)(&quot;|&#039;),/g, &#039;$1$2target_name$2: $4$5$6,\n      $2cflags!$2: [ $2-fno-exceptions$2 ],\n      $2cflags_cc!$2: [ $2-fno-exceptions$2 ],\n      $2defines$2: [ $2NAPI_DISABLE_CPP_EXCEPTIONS$2 ],\n      $2conditions$2: [\n        [\&#039;OS==&quot;win&quot;\&#039;, { $2defines$2: [ $2_HAS_EXCEPTIONS=1$2 ] }]\n      ]&#039;]
    ]
  };
}

const SourceFileOperations = [
  [/Nan::SetMethod\(target,[\s]*&quot;(.*)&quot;[\s]*,[\s]*([^)]+)\)/g, &#039;exports.Set(Napi::String::New(env, &quot;$1&quot;), Napi::Function::New(env, $2))&#039;],

  [/v8::Local&lt;v8::FunctionTemplate&gt;\s+(\w+)\s*=\s*Nan::New&lt;FunctionTemplate&gt;\([\w\d:]+\);(?:\w+-&gt;Reset\(\1\))?\s+\1-&gt;SetClassName\(Nan::String::New\(&quot;(\w+)&quot;\)\);/g, &#039;Napi::Function $1 = DefineClass(env, &quot;$2&quot;, {&#039;],
  [/Local&lt;FunctionTemplate&gt;\s+(\w+)\s*=\s*Nan::New&lt;FunctionTemplate&gt;\([\w\d:]+\);\s+(\w+)\.Reset\((\1)\);\s+\1-&gt;SetClassName\((Nan::String::New|Nan::New&lt;(v8::)*String&gt;)\(&quot;(.+?)&quot;\)\);/g, &#039;Napi::Function $1 = DefineClass(env, &quot;$6&quot;, {&#039;],
  [/Local&lt;FunctionTemplate&gt;\s+(\w+)\s*=\s*Nan::New&lt;FunctionTemplate&gt;\([\w\d:]+\);(?:\w+-&gt;Reset\(\1\))?\s+\1-&gt;SetClassName\(Nan::String::New\(&quot;(\w+)&quot;\)\);/g, &#039;Napi::Function $1 = DefineClass(env, &quot;$2&quot;, {&#039;],
  [/Nan::New&lt;v8::FunctionTemplate&gt;\(([\w\d:]+)\)-&gt;GetFunction\(\)/g, &#039;Napi::Function::New(env, $1)&#039;],
  [/Nan::New&lt;FunctionTemplate&gt;\(([\w\d:]+)\)-&gt;GetFunction()/g, &#039;Napi::Function::New(env, $1);&#039;],
  [/Nan::New&lt;v8::FunctionTemplate&gt;\(([\w\d:]+)\)/g, &#039;Napi::Function::New(env, $1)&#039;],
  [/Nan::New&lt;FunctionTemplate&gt;\(([\w\d:]+)\)/g, &#039;Napi::Function::New(env, $1)&#039;],

  // FunctionTemplate to FunctionReference
  [/Nan::Persistent&lt;(v8::)*FunctionTemplate&gt;/g, &#039;Napi::FunctionReference&#039;],
  [/Nan::Persistent&lt;(v8::)*Function&gt;/g, &#039;Napi::FunctionReference&#039;],
  [/v8::Local&lt;v8::FunctionTemplate&gt;/g, &#039;Napi::FunctionReference&#039;],
  [/Local&lt;FunctionTemplate&gt;/g, &#039;Napi::FunctionReference&#039;],
  [/v8::FunctionTemplate/g, &#039;Napi::FunctionReference&#039;],
  [/FunctionTemplate/g, &#039;Napi::FunctionReference&#039;],

  [/([ ]*)Nan::SetPrototypeMethod\(\w+, &quot;(\w+)&quot;, (\w+)\);/g, &#039;$1InstanceMethod(&quot;$2&quot;, &amp;$3),&#039;],
  [/([ ]*)(?:\w+\.Reset\(\w+\);\s+)?\(target\)\.Set\(&quot;(\w+)&quot;,\s*Nan::GetFunction\((\w+)\)\);/gm,
    &#039;});\n\n&#039; +
    &#039;$1constructor = Napi::Persistent($3);\n&#039; +
    &#039;$1constructor.SuppressDestruct();\n&#039; +
    &#039;$1target.Set(&quot;$2&quot;, $3);&#039;],

  // TODO: Other attribute combinations
  [/static_cast&lt;PropertyAttribute&gt;\(ReadOnly\s*\|\s*DontDelete\)/gm,
    &#039;static_cast&lt;napi_property_attributes&gt;(napi_enumerable | napi_configurable)&#039;],

  [/([\w\d:&lt;&gt;]+?)::Cast\((.+?)\)/g, &#039;$2.As&lt;$1&gt;()&#039;],

  [/\*Nan::Utf8String\(([^)]+)\)/g, &#039;$1-&gt;As&lt;Napi::String&gt;().Utf8Value().c_str()&#039;],
  [/Nan::Utf8String +(\w+)\(([^)]+)\)/g, &#039;std::string $1 = $2.As&lt;Napi::String&gt;()&#039;],
  [/Nan::Utf8String/g, &#039;std::string&#039;],

  [/v8::String::Utf8Value (.+?)\((.+?)\)/g, &#039;Napi::String $1(env, $2)&#039;],
  [/String::Utf8Value (.+?)\((.+?)\)/g, &#039;Napi::String $1(env, $2)&#039;],
  [/\.length\(\)/g, &#039;.Length()&#039;],

  [/Nan::MakeCallback\(([^,]+),[\s\\]+([^,]+),/gm, &#039;$2.MakeCallback($1,&#039;],

  [/class\s+(\w+)\s*:\s*public\s+Nan::ObjectWrap/g, &#039;class $1 : public Napi::ObjectWrap&lt;$1&gt;&#039;],
  [/(\w+)\(([^)]*)\)\s*:\s*Nan::ObjectWrap\(\)\s*(,)?/gm, &#039;$1($2) : Napi::ObjectWrap&lt;$1&gt;()$3&#039;],

  // HandleOKCallback to OnOK
  [/HandleOKCallback/g, &#039;OnOK&#039;],
  // HandleErrorCallback to OnError
  [/HandleErrorCallback/g, &#039;OnError&#039;],

  // ex. .As&lt;Function&gt;() to .As&lt;Napi::Object&gt;()
  [/\.As&lt;v8::(Value|Boolean|String|Number|Object|Array|Symbol|External|Function)&gt;\(\)/g, &#039;.As&lt;Napi::$1&gt;()&#039;],
  [/\.As&lt;(Value|Boolean|String|Number|Object|Array|Symbol|External|Function)&gt;\(\)/g, &#039;.As&lt;Napi::$1&gt;()&#039;],

  // ex. Nan::New&lt;Number&gt;(info[0]) to Napi::Number::New(info[0])
  [/Nan::New&lt;(v8::)*Integer&gt;\((.+?)\)/g, &#039;Napi::Number::New(env, $2)&#039;],
  [/Nan::New\(([0-9.]+)\)/g, &#039;Napi::Number::New(env, $1)&#039;],
  [/Nan::New&lt;(v8::)*String&gt;\(&quot;(.+?)&quot;\)/g, &#039;Napi::String::New(env, &quot;$2&quot;)&#039;],
  [/Nan::New\(&quot;(.+?)&quot;\)/g, &#039;Napi::String::New(env, &quot;$1&quot;)&#039;],
  [/Nan::New&lt;(v8::)*(.+?)&gt;\(\)/g, &#039;Napi::$2::New(env)&#039;],
  [/Nan::New&lt;(.+?)&gt;\(\)/g, &#039;Napi::$1::New(env)&#039;],
  [/Nan::New&lt;(v8::)*(.+?)&gt;\(/g, &#039;Napi::$2::New(env, &#039;],
  [/Nan::New&lt;(.+?)&gt;\(/g, &#039;Napi::$1::New(env, &#039;],
  [/Nan::NewBuffer\(/g, &#039;Napi::Buffer&lt;char&gt;::New(env, &#039;],
  // TODO: Properly handle this
  [/Nan::New\(/g, &#039;Napi::New(env, &#039;],

  [/\.IsInt32\(\)/g, &#039;.IsNumber()&#039;],
  [/-&gt;IsInt32\(\)/g, &#039;.IsNumber()&#039;],

  [/(.+?)-&gt;BooleanValue\(\)/g, &#039;$1.As&lt;Napi::Boolean&gt;().Value()&#039;],
  [/(.+?)-&gt;Int32Value\(\)/g, &#039;$1.As&lt;Napi::Number&gt;().Int32Value()&#039;],
  [/(.+?)-&gt;Uint32Value\(\)/g, &#039;$1.As&lt;Napi::Number&gt;().Uint32Value()&#039;],
  [/(.+?)-&gt;IntegerValue\(\)/g, &#039;$1.As&lt;Napi::Number&gt;().Int64Value()&#039;],
  [/(.+?)-&gt;NumberValue\(\)/g, &#039;$1.As&lt;Napi::Number&gt;().DoubleValue()&#039;],

  // ex. Nan::To&lt;bool&gt;(info[0]) to info[0].Value()
  [/Nan::To&lt;v8::(Boolean|String|Number|Object|Array|Symbol|Function)&gt;\((.+?)\)/g, &#039;$2.To&lt;Napi::$1&gt;()&#039;],
  [/Nan::To&lt;(Boolean|String|Number|Object|Array|Symbol|Function)&gt;\((.+?)\)/g, &#039;$2.To&lt;Napi::$1&gt;()&#039;],
  // ex. Nan::To&lt;bool&gt;(info[0]) to info[0].As&lt;Napi::Boolean&gt;().Value()
  [/Nan::To&lt;bool&gt;\((.+?)\)/g, &#039;$1.As&lt;Napi::Boolean&gt;().Value()&#039;],
  // ex. Nan::To&lt;int&gt;(info[0]) to info[0].As&lt;Napi::Number&gt;().Int32Value()
  [/Nan::To&lt;int&gt;\((.+?)\)/g, &#039;$1.As&lt;Napi::Number&gt;().Int32Value()&#039;],
  // ex. Nan::To&lt;int32_t&gt;(info[0]) to info[0].As&lt;Napi::Number&gt;().Int32Value()
  [/Nan::To&lt;int32_t&gt;\((.+?)\)/g, &#039;$1.As&lt;Napi::Number&gt;().Int32Value()&#039;],
  // ex. Nan::To&lt;uint32_t&gt;(info[0]) to info[0].As&lt;Napi::Number&gt;().Uint32Value()
  [/Nan::To&lt;uint32_t&gt;\((.+?)\)/g, &#039;$1.As&lt;Napi::Number&gt;().Uint32Value()&#039;],
  // ex. Nan::To&lt;int64_t&gt;(info[0]) to info[0].As&lt;Napi::Number&gt;().Int64Value()
  [/Nan::To&lt;int64_t&gt;\((.+?)\)/g, &#039;$1.As&lt;Napi::Number&gt;().Int64Value()&#039;],
  // ex. Nan::To&lt;float&gt;(info[0]) to info[0].As&lt;Napi::Number&gt;().FloatValue()
  [/Nan::To&lt;float&gt;\((.+?)\)/g, &#039;$1.As&lt;Napi::Number&gt;().FloatValue()&#039;],
  // ex. Nan::To&lt;double&gt;(info[0]) to info[0].As&lt;Napi::Number&gt;().DoubleValue()
  [/Nan::To&lt;double&gt;\((.+?)\)/g, &#039;$1.As&lt;Napi::Number&gt;().DoubleValue()&#039;],

  [/Nan::New\((\w+)\)-&gt;HasInstance\((\w+)\)/g, &#039;$2.InstanceOf($1.Value())&#039;],

  [/Nan::Has\(([^,]+),\s*/gm, &#039;($1).Has(&#039;],
  [/\.Has\([\s|\\]*Nan::New&lt;(v8::)*String&gt;\(([^)]+)\)\)/gm, &#039;.Has($1)&#039;],
  [/\.Has\([\s|\\]*Nan::New\(([^)]+)\)\)/gm, &#039;.Has($1)&#039;],

  [/Nan::Get\(([^,]+),\s*/gm, &#039;($1).Get(&#039;],
  [/\.Get\([\s|\\]*Nan::New&lt;(v8::)*String&gt;\(([^)]+)\)\)/gm, &#039;.Get($1)&#039;],
  [/\.Get\([\s|\\]*Nan::New\(([^)]+)\)\)/gm, &#039;.Get($1)&#039;],

  [/Nan::Set\(([^,]+),\s*/gm, &#039;($1).Set(&#039;],
  [/\.Set\([\s|\\]*Nan::New&lt;(v8::)*String&gt;\(([^)]+)\)\s*,/gm, &#039;.Set($1,&#039;],
  [/\.Set\([\s|\\]*Nan::New\(([^)]+)\)\s*,/gm, &#039;.Set($1,&#039;],

  // ex. node::Buffer::HasInstance(info[0]) to info[0].IsBuffer()
  [/node::Buffer::HasInstance\((.+?)\)/g, &#039;$1.IsBuffer()&#039;],
  // ex. node::Buffer::Length(info[0]) to info[0].Length()
  [/node::Buffer::Length\((.+?)\)/g, &#039;$1.As&lt;Napi::Buffer&lt;char&gt;&gt;().Length()&#039;],
  // ex. node::Buffer::Data(info[0]) to info[0].Data()
  [/node::Buffer::Data\((.+?)\)/g, &#039;$1.As&lt;Napi::Buffer&lt;char&gt;&gt;().Data()&#039;],
  [/Nan::CopyBuffer\(/g, &#039;Napi::Buffer::Copy(env, &#039;],

  // Nan::AsyncQueueWorker(worker)
  [/Nan::AsyncQueueWorker\((.+)\);/g, &#039;$1.Queue();&#039;],
  [/Nan::(Undefined|Null|True|False)\(\)/g, &#039;env.$1()&#039;],

  // Nan::ThrowError(error) to Napi::Error::New(env, error).ThrowAsJavaScriptException()
  [/([ ]*)return Nan::Throw(\w*?)Error\((.+?)\);/g, &#039;$1Napi::$2Error::New(env, $3).ThrowAsJavaScriptException();\n$1return env.Null();&#039;],
  [/Nan::Throw(\w*?)Error\((.+?)\);\n(\s*)return;/g, &#039;Napi::$1Error::New(env, $2).ThrowAsJavaScriptException();\n$3return env.Null();&#039;],
  [/Nan::Throw(\w*?)Error\((.+?)\);/g, &#039;Napi::$1Error::New(env, $2).ThrowAsJavaScriptException();\n&#039;],
  // Nan::RangeError(error) to Napi::RangeError::New(env, error)
  [/Nan::(\w*?)Error\((.+)\)/g, &#039;Napi::$1Error::New(env, $2)&#039;],

  [/Nan::Set\((.+?),\n* *(.+?),\n* *(.+?),\n* *(.+?)\)/g, &#039;$1.Set($2, $3, $4)&#039;],

  [/Nan::(Escapable)?HandleScope\s+(\w+)\s*;/g, &#039;Napi::$1HandleScope $2(env);&#039;],
  [/Nan::(Escapable)?HandleScope/g, &#039;Napi::$1HandleScope&#039;],
  [/Nan::ForceSet\(([^,]+), ?/g, &#039;$1-&gt;DefineProperty(&#039;],
  [/\.ForceSet\(Napi::String::New\(env, &quot;(\w+)&quot;\),\s*?/g, &#039;.DefineProperty(&quot;$1&quot;, &#039;],
  // [ /Nan::GetPropertyNames\(([^,]+)\)/, &#039;$1-&gt;GetPropertyNames()&#039; ],
  [/Nan::Equals\(([^,]+),/g, &#039;$1.StrictEquals(&#039;],

  [/(.+)-&gt;Set\(/g, &#039;$1.Set(&#039;],

  [/Nan::Callback/g, &#039;Napi::FunctionReference&#039;],

  [/Nan::Persistent&lt;Object&gt;/g, &#039;Napi::ObjectReference&#039;],
  [/Nan::ADDON_REGISTER_FUNCTION_ARGS_TYPE target/g, &#039;Napi::Env&amp; env, Napi::Object&amp; target&#039;],

  [/(\w+)\*\s+(\w+)\s*=\s*Nan::ObjectWrap::Unwrap&lt;\w+&gt;\(info\.This\(\)\);/g, &#039;$1* $2 = this;&#039;],
  [/Nan::ObjectWrap::Unwrap&lt;(\w+)&gt;\((.*)\);/g, &#039;$2.Unwrap&lt;$1&gt;();&#039;],

  [/Nan::NAN_METHOD_RETURN_TYPE/g, &#039;void&#039;],
  [/NAN_INLINE/g, &#039;inline&#039;],

  [/Nan::NAN_METHOD_ARGS_TYPE/g, &#039;const Napi::CallbackInfo&amp;&#039;],
  [/NAN_METHOD\(([\w\d:]+?)\)/g, &#039;Napi::Value $1(const Napi::CallbackInfo&amp; info)&#039;],
  [/static\s*NAN_GETTER\(([\w\d:]+?)\)/g, &#039;Napi::Value $1(const Napi::CallbackInfo&amp; info)&#039;],
  [/NAN_GETTER\(([\w\d:]+?)\)/g, &#039;Napi::Value $1(const Napi::CallbackInfo&amp; info)&#039;],
  [/static\s*NAN_SETTER\(([\w\d:]+?)\)/g, &#039;void $1(const Napi::CallbackInfo&amp; info, const Napi::Value&amp; value)&#039;],
  [/NAN_SETTER\(([\w\d:]+?)\)/g, &#039;void $1(const Napi::CallbackInfo&amp; info, const Napi::Value&amp; value)&#039;],
  [/void Init\((v8::)*Local&lt;(v8::)*Object&gt; exports\)/g, &#039;Napi::Object Init(Napi::Env env, Napi::Object exports)&#039;],
  [/NAN_MODULE_INIT\(([\w\d:]+?)\);/g, &#039;Napi::Object $1(Napi::Env env, Napi::Object exports);&#039;],
  [/NAN_MODULE_INIT\(([\w\d:]+?)\)/g, &#039;Napi::Object $1(Napi::Env env, Napi::Object exports)&#039;],

  [/::(Init(?:ialize)?)\(target\)/g, &#039;::$1(env, target, module)&#039;],
  [/constructor_template/g, &#039;constructor&#039;],

  [/Nan::FunctionCallbackInfo&lt;(v8::)?Value&gt;[ ]*&amp; [ ]*info\)[ ]*{\n*([ ]*)/gm, &#039;Napi::CallbackInfo&amp; info) {\n$2Napi::Env env = info.Env();\n$2&#039;],
  [/Nan::FunctionCallbackInfo&lt;(v8::)*Value&gt;\s*&amp;\s*info\);/g, &#039;Napi::CallbackInfo&amp; info);&#039;],
  [/Nan::FunctionCallbackInfo&lt;(v8::)*Value&gt;\s*&amp;/g, &#039;Napi::CallbackInfo&amp;&#039;],

  [/Buffer::HasInstance\(([^)]+)\)/g, &#039;$1.IsBuffer()&#039;],

  [/info\[(\d+)\]-&gt;/g, &#039;info[$1].&#039;],
  [/info\[([\w\d]+)\]-&gt;/g, &#039;info[$1].&#039;],
  [/info\.This\(\)-&gt;/g, &#039;info.This().&#039;],
  [/-&gt;Is(Object|String|Int32|Number)\(\)/g, &#039;.Is$1()&#039;],
  [/info.GetReturnValue\(\).SetUndefined\(\)/g, &#039;return env.Undefined()&#039;],
  [/info\.GetReturnValue\(\)\.Set\(((\n|.)+?)\);/g, &#039;return $1;&#039;],

  // ex. Local&lt;Value&gt; to Napi::Value
  [/v8::Local&lt;v8::(Value|Boolean|String|Number|Object|Array|Symbol|External|Function)&gt;/g, &#039;Napi::$1&#039;],
  [/Local&lt;(Value|Boolean|String|Number|Object|Array|Symbol|External|Function)&gt;/g, &#039;Napi::$1&#039;],

  // Declare an env in helper functions that take a Napi::Value
  [/(\w+)\(Napi::Value (\w+)(,\s*[^()]+)?\)\s*{\n*([ ]*)/gm, &#039;$1(Napi::Value $2$3) {\n$4Napi::Env env = $2.Env();\n$4&#039;],

  // delete #include &lt;node.h&gt; and/or &lt;v8.h&gt;
  [/#include +(&lt;|&quot;)(?:node|nan).h(&quot;|&gt;)/g, &#039;#include $1napi.h$2\n#include $1uv.h$2&#039;],
  // NODE_MODULE to NODE_API_MODULE
  [/NODE_MODULE/g, &#039;NODE_API_MODULE&#039;],
  [/Nan::/g, &#039;Napi::&#039;],
  [/nan.h/g, &#039;napi.h&#039;],

  // delete .FromJust()
  [/\.FromJust\(\)/g, &#039;&#039;],
  // delete .ToLocalCheck()
  [/\.ToLocalChecked\(\)/g, &#039;&#039;],
  [/^.*-&gt;SetInternalFieldCount\(.*$/gm, &#039;&#039;],

  // replace using node; and/or using v8; to using Napi;
  [/using (node|v8);/g, &#039;using Napi;&#039;],
  [/using namespace (node|Nan|v8);/g, &#039;using namespace Napi;&#039;],
  // delete using v8::Local;
  [/using v8::Local;\n/g, &#039;&#039;],
  // replace using v8::XXX; with using Napi::XXX
  [/using v8::([A-Za-z]+);/g, &#039;using Napi::$1;&#039;]

];

const paths = listFiles(dir);
paths.forEach(function (dirEntry) {
  const filename = dirEntry.split(&#039;\\&#039;).pop().split(&#039;/&#039;).pop();

  // Check whether the file is a source file or a config file
  // then execute function accordingly
  const sourcePattern = /.+\.h|.+\.cc|.+\.cpp/;
  if (sourcePattern.test(filename)) {
    convertFile(dirEntry, SourceFileOperations);
  } else if (ConfigFileOperations[filename] != null) {
    convertFile(dirEntry, ConfigFileOperations[filename]);
  }
});

function listFiles (dir, filelist) {
  const files = fs.readdirSync(dir);
  filelist = filelist || [];
  files.forEach(function (file) {
    if (file === &#039;node_modules&#039;) {
      return;
    }

    if (fs.statSync(path.join(dir, file)).isDirectory()) {
      filelist = listFiles(path.join(dir, file), filelist);
    } else {
      filelist.push(path.join(dir, file));
    }
  });
  return filelist;
}

function convert (content, operations) {
  for (let i = 0; i &lt; operations.length; i++) {
    const operation = operations[i];
    content = content.replace(operation[0], operation[1]);
  }
  return content;
}

function convertFile (fileName, operations) {
  fs.readFile(fileName, &#039;utf-8&#039;, function (err, file) {
    if (err) throw err;

    file = convert(file, operations);

    fs.writeFile(fileName, file, function (err) {
      if (err) throw err;
    });
  });
}
</textarea>
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p>.</p>
  </div>
</footer>

<script type="text/html" id="complexity-popover-template">
  <div class="complexity-notice">
    Complexity : {{ complexity.cyclomatic }} <br>
    Length : {{ complexity.halstead.length }} <br>
    Difficulty : {{ complexity.halstead.difficulty.toFixed(2) }} <br>
    Est # bugs : {{ complexity.halstead.bugs.toFixed(2) }}<br>
  </div>
</script>

<script type="text/javascript" src="../../assets/scripts/bundles/core-bundle.js"></script>
<script type="text/javascript" src="../../assets/scripts/bundles/codemirror.js"></script>
<script type="text/javascript" src="../../assets/scripts/codemirror.markpopovertext.js"></script>
<script type="text/javascript" src="report.js"></script>
<script type="text/javascript" src="report.history.js"></script>
<script type="text/javascript" src="../../assets/scripts/plato-file.js"></script>
</body>
</html>
