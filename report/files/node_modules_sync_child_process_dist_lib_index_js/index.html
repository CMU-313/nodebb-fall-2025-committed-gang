<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Plato - node_modules/sync-child-process/dist/lib/index.js</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">

  <!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <link href="../../assets/css/vendor/morris.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/vendor/bootstrap.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/vendor/font-awesome.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/vendor/codemirror.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/plato.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/plato-file.css" rel="stylesheet" type="text/css">

</head>

<body>

<div class="navbar navbar-fixed-top">
  <div class="container">
    <a class="navbar-brand" href="https://github.com/the-simian/es6-plato">ES6 Plato on Github</a>
    <ul class="nav navbar-nav">
      <li>
        <a href="../../index.html">Report Home</a>
      </li>
      <li class="active">
        <a href="display.html">Summary Display</a>
      </li>
    </ul>
  </div>
</div>

<div class="jumbotron">
  <div class="container">
    <h1>node_modules/sync-child-process/dist/lib/index.js</h1>
  </div>
</div>

<div class="container aggregate-stats">
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Maintainability <a href="http://blogs.msdn.com/b/codeanalysis/archive/2007/11/20/maintainability-index-range-and-meaning.aspx"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="A value between 0 and 100 that represents the relative ease of maintaining the code. A high value means better maintainability." data-original-title="Maintainability Index"  data-container="body"></i></a></h2>
      <p class="stat">64.86</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Lines of code <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h2>
      <p class="stat">128</p>
    </div>
  </div>
  <div class="row historical">
    <div class="col-md-6">
      <p id="chart_historical_maint" class="chart"></p>
    </div>
    <div class="col-md-6">
      <p id="chart_historical_sloc" class="chart"></p>
    </div>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Difficulty  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="The difficulty measure is related to the difficulty of the program to write or understand." data-original-title="Difficulty" data-container="body"></i></a></h2>
      <p class="stat">26.30</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Estimated Errors  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Halstead's delivered bugs is an estimate for the number of errors in the implementation." data-original-title="Delivered Bugs" data-container="body"></i></a></h2>
      <p class="stat">0.94</p>
    </div>
  </div>
</div>

<div class="container charts">
  <div class="row">
    <h2 class="header">Function weight</h2>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h3 class="chart-header">By Complexity <a href="http://en.wikipedia.org/wiki/Cyclomatic_complexity"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="This metric counts the number of distinct paths through a block of code. Lower values are better." data-original-title="Cyclomatic Complexity" data-container="body"></i></a></h3>
      <div id="fn-by-complexity" class="stat"></div>
    </div>
    <div class="col-md-6">
      <h3 class="chart-header">By SLOC  <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h3>
      <div id="fn-by-sloc" class="stat"></div>
    </div>
  </div>
</div>

<div class="container">
  <div class="row">
    <textarea id="file-source" class="col-md-12">&quot;use strict&quot;;
// Copyright 2021 Google LLC. Use of this source code is governed by an
// MIT-style license that can be found in the LICENSE file or at
// https://opensource.org/licenses/MIT.
Object.defineProperty(exports, &quot;__esModule&quot;, { value: true });
exports.SyncChildProcess = void 0;
const fs = require(&quot;fs&quot;);
const p = require(&quot;path&quot;);
const stream = require(&quot;stream&quot;);
const worker_threads_1 = require(&quot;worker_threads&quot;);
const worker_threads = require(&quot;worker_threads&quot;);
const sync_message_port_1 = require(&quot;sync-message-port&quot;);
/** Whether {@link object} can&#039;t be transferred between threads, only cloned. */
function isMarkedAsUntransferable(object) {
    // TODO: Remove this check when we no longer support Node v20 (after
    // 2026-04-30).
    return &#039;isMarkedAsUntransferable&#039; in worker_threads
        ? // TODO - DefinitelyTyped/DefinitelyTyped#71033: Remove this cast
            worker_threads.isMarkedAsUntransferable(object)
        : false;
}
/**
 * A child process that runs synchronously while also allowing the user to
 * interact with it before it shuts down.
 */
class SyncChildProcess {
    /** The port that communicates with the worker thread. */
    port;
    /** The worker in which the child process runs. */
    worker;
    /** The standard input stream to write to the process. */
    stdin;
    constructor(command, argsOrOptions, options) {
        let args;
        if (Array.isArray(argsOrOptions)) {
            args = argsOrOptions;
        }
        else {
            args = [];
            options = argsOrOptions;
        }
        const { port1, port2 } = sync_message_port_1.SyncMessagePort.createChannel();
        this.port = new sync_message_port_1.SyncMessagePort(port1);
        this.worker = spawnWorker(p.join(p.dirname(__filename), &#039;worker&#039;), {
            workerData: { port: port2, command, args, options },
            transferList: [port2],
        });
        // The worker shouldn&#039;t emit any errors unless it breaks in development.
        this.worker.on(&#039;error&#039;, console.error);
        this.stdin = new stream.Writable({
            write: (chunk, encoding, callback) =&gt; {
                this.port.postMessage({
                    type: &#039;stdin&#039;,
                    data: chunk,
                }, isMarkedAsUntransferable(chunk.buffer) ? undefined : [chunk.buffer]);
                callback();
            },
            final: () =&gt; this.port.postMessage({ type: &#039;stdinClosed&#039; }),
        });
    }
    /**
     * Blocks until the child process is ready to emit another event, then returns
     * that event. This will return an [IteratorReturnResult] with an [ExitEvent]
     * once when the process exits. If it&#039;s called again after that, it will
     * return `{done: true}` without a value.
     *
     * If there&#039;s an error running the child process, this will throw that error.
     */
    next() {
        if (this.stdin.destroyed)
            return { done: true, value: undefined };
        const message = this.port.receiveMessage();
        switch (message.type) {
            case &#039;stdout&#039;:
                return {
                    value: { type: &#039;stdout&#039;, data: Buffer.from(message.data.buffer) },
                };
            case &#039;stderr&#039;:
                return {
                    value: { type: &#039;stderr&#039;, data: Buffer.from(message.data.buffer) },
                };
            case &#039;error&#039;:
                this.close();
                throw message.error;
            case &#039;exit&#039;:
                this.close();
                return { done: true, value: message };
        }
    }
    // TODO(nex3): Add a non-blocking `yieldIfReady()` function that returns
    // `null` if the worker hasn&#039;t queued up an event.
    // TODO(nex3): Add a `yieldAsync()` function that returns a `Promise&lt;Event&gt;`.
    /**
     * Sends a signal (`SIGTERM` by default) to the child process.
     *
     * This has no effect if the process has already exited.
     */
    kill(signal) {
        this.port.postMessage({ type: &#039;kill&#039;, signal });
    }
    /** Closes down the worker thread and the stdin stream. */
    close() {
        this.port.close();
        void this.worker.terminate();
        this.stdin.destroy();
    }
}
exports.SyncChildProcess = SyncChildProcess;
/**
 * Spawns a worker for the given `fileWithoutExtension` in either a JS or TS
 * worker, depending on which file exists.
 */
function spawnWorker(fileWithoutExtension, options) {
    // The released version always spawns the JS worker. The TS worker is only
    // used for development.
    const jsFile = fileWithoutExtension + &#039;.js&#039;;
    if (fs.existsSync(jsFile))
        return new worker_threads_1.Worker(jsFile, options);
    const tsFile = fileWithoutExtension + &#039;.ts&#039;;
    if (fs.existsSync(tsFile)) {
        return new worker_threads_1.Worker(`
        require(&#039;ts-node&#039;).register();
        require(${JSON.stringify(tsFile)});
      `, { ...options, eval: true });
    }
    throw new Error(`Neither &quot;${jsFile}&quot; nor &quot;.ts&quot; exists.`);
}
//# sourceMappingURL=index.js.map</textarea>
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p>.</p>
  </div>
</footer>

<script type="text/html" id="complexity-popover-template">
  <div class="complexity-notice">
    Complexity : {{ complexity.cyclomatic }} <br>
    Length : {{ complexity.halstead.length }} <br>
    Difficulty : {{ complexity.halstead.difficulty.toFixed(2) }} <br>
    Est # bugs : {{ complexity.halstead.bugs.toFixed(2) }}<br>
  </div>
</script>

<script type="text/javascript" src="../../assets/scripts/bundles/core-bundle.js"></script>
<script type="text/javascript" src="../../assets/scripts/bundles/codemirror.js"></script>
<script type="text/javascript" src="../../assets/scripts/codemirror.markpopovertext.js"></script>
<script type="text/javascript" src="report.js"></script>
<script type="text/javascript" src="report.history.js"></script>
<script type="text/javascript" src="../../assets/scripts/plato-file.js"></script>
</body>
</html>
