<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Plato - node_modules/webpack/lib/util/comparators.js</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">

  <!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <link href="../../assets/css/vendor/morris.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/vendor/bootstrap.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/vendor/font-awesome.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/vendor/codemirror.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/plato.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/plato-file.css" rel="stylesheet" type="text/css">

</head>

<body>

<div class="navbar navbar-fixed-top">
  <div class="container">
    <a class="navbar-brand" href="https://github.com/the-simian/es6-plato">ES6 Plato on Github</a>
    <ul class="nav navbar-nav">
      <li>
        <a href="../../index.html">Report Home</a>
      </li>
      <li class="active">
        <a href="display.html">Summary Display</a>
      </li>
    </ul>
  </div>
</div>

<div class="jumbotron">
  <div class="container">
    <h1>node_modules/webpack/lib/util/comparators.js</h1>
  </div>
</div>

<div class="container aggregate-stats">
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Maintainability <a href="http://blogs.msdn.com/b/codeanalysis/archive/2007/11/20/maintainability-index-range-and-meaning.aspx"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="A value between 0 and 100 that represents the relative ease of maintaining the code. A high value means better maintainability." data-original-title="Maintainability Index"  data-container="body"></i></a></h2>
      <p class="stat">64.29</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Lines of code <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h2>
      <p class="stat">524</p>
    </div>
  </div>
  <div class="row historical">
    <div class="col-md-6">
      <p id="chart_historical_maint" class="chart"></p>
    </div>
    <div class="col-md-6">
      <p id="chart_historical_sloc" class="chart"></p>
    </div>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Difficulty  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="The difficulty measure is related to the difficulty of the program to write or understand." data-original-title="Difficulty" data-container="body"></i></a></h2>
      <p class="stat">115.82</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Estimated Errors  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Halstead's delivered bugs is an estimate for the number of errors in the implementation." data-original-title="Delivered Bugs" data-container="body"></i></a></h2>
      <p class="stat">3.32</p>
    </div>
  </div>
</div>

<div class="container charts">
  <div class="row">
    <h2 class="header">Function weight</h2>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h3 class="chart-header">By Complexity <a href="http://en.wikipedia.org/wiki/Cyclomatic_complexity"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="This metric counts the number of distinct paths through a block of code. Lower values are better." data-original-title="Cyclomatic Complexity" data-container="body"></i></a></h3>
      <div id="fn-by-complexity" class="stat"></div>
    </div>
    <div class="col-md-6">
      <h3 class="chart-header">By SLOC  <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h3>
      <div id="fn-by-sloc" class="stat"></div>
    </div>
  </div>
</div>

<div class="container">
  <div class="row">
    <textarea id="file-source" class="col-md-12">/*
	MIT License http://www.opensource.org/licenses/mit-license.php
	Author Tobias Koppers @sokra
*/

&quot;use strict&quot;;

const { compareRuntime } = require(&quot;./runtime&quot;);

/** @typedef {import(&quot;../Chunk&quot;)} Chunk */
/** @typedef {import(&quot;../Chunk&quot;).ChunkId} ChunkId */
/** @typedef {import(&quot;../ChunkGraph&quot;)} ChunkGraph */
/** @typedef {import(&quot;../ChunkGraph&quot;).ModuleId} ModuleId */
/** @typedef {import(&quot;../ChunkGroup&quot;)} ChunkGroup */
/** @typedef {import(&quot;../Dependency&quot;).DependencyLocation} DependencyLocation */
/** @typedef {import(&quot;../Module&quot;)} Module */
/** @typedef {import(&quot;../ModuleGraph&quot;)} ModuleGraph */

/**
 * @template T
 * @typedef {(a: T, b: T) =&gt; -1 | 0 | 1} Comparator
 */
/**
 * @template {object} TArg
 * @template T
 * @typedef {(tArg: TArg, a: T, b: T) =&gt; -1 | 0 | 1} RawParameterizedComparator
 */
/**
 * @template {object} TArg
 * @template T
 * @typedef {(tArg: TArg) =&gt; Comparator&lt;T&gt;} ParameterizedComparator
 */

/**
 * @template {object} TArg
 * @template {object} T
 * @param {RawParameterizedComparator&lt;TArg, T&gt;} fn comparator with argument
 * @returns {ParameterizedComparator&lt;TArg, T&gt;} comparator
 */
const createCachedParameterizedComparator = fn =&gt; {
	/** @type {WeakMap&lt;EXPECTED_OBJECT, Comparator&lt;T&gt;&gt;} */
	const map = new WeakMap();
	return arg =&gt; {
		const cachedResult = map.get(/** @type {EXPECTED_OBJECT} */ (arg));
		if (cachedResult !== undefined) return cachedResult;
		/**
		 * @param {T} a first item
		 * @param {T} b second item
		 * @returns {-1|0|1} compare result
		 */
		const result = fn.bind(null, arg);
		map.set(/** @type {EXPECTED_OBJECT} */ (arg), result);
		return result;
	};
};

/**
 * @param {Chunk} a chunk
 * @param {Chunk} b chunk
 * @returns {-1|0|1} compare result
 */
module.exports.compareChunksById = (a, b) =&gt;
	compareIds(/** @type {ChunkId} */ (a.id), /** @type {ChunkId} */ (b.id));

/**
 * @param {Module} a module
 * @param {Module} b module
 * @returns {-1|0|1} compare result
 */
module.exports.compareModulesByIdentifier = (a, b) =&gt;
	compareIds(a.identifier(), b.identifier());

/**
 * @param {ChunkGraph} chunkGraph the chunk graph
 * @param {Module} a module
 * @param {Module} b module
 * @returns {-1|0|1} compare result
 */
const compareModulesById = (chunkGraph, a, b) =&gt;
	compareIds(
		/** @type {ModuleId} */ (chunkGraph.getModuleId(a)),
		/** @type {ModuleId} */ (chunkGraph.getModuleId(b))
	);
/** @type {ParameterizedComparator&lt;ChunkGraph, Module&gt;} */
module.exports.compareModulesById =
	createCachedParameterizedComparator(compareModulesById);

/**
 * @param {number} a number
 * @param {number} b number
 * @returns {-1|0|1} compare result
 */
const compareNumbers = (a, b) =&gt; {
	if (typeof a !== typeof b) {
		return typeof a &lt; typeof b ? -1 : 1;
	}
	if (a &lt; b) return -1;
	if (a &gt; b) return 1;
	return 0;
};
module.exports.compareNumbers = compareNumbers;

/**
 * @param {string} a string
 * @param {string} b string
 * @returns {-1|0|1} compare result
 */
const compareStringsNumeric = (a, b) =&gt; {
	const aLength = a.length;
	const bLength = b.length;

	let aChar = 0;
	let bChar = 0;

	let aIsDigit = false;
	let bIsDigit = false;
	let i = 0;
	let j = 0;
	while (i &lt; aLength &amp;&amp; j &lt; bLength) {
		aChar = a.charCodeAt(i);
		bChar = b.charCodeAt(j);

		aIsDigit = aChar &gt;= 48 &amp;&amp; aChar &lt;= 57;
		bIsDigit = bChar &gt;= 48 &amp;&amp; bChar &lt;= 57;

		if (!aIsDigit &amp;&amp; !bIsDigit) {
			if (aChar &lt; bChar) return -1;
			if (aChar &gt; bChar) return 1;
			i++;
			j++;
		} else if (aIsDigit &amp;&amp; !bIsDigit) {
			// This segment of a is shorter than in b
			return 1;
		} else if (!aIsDigit &amp;&amp; bIsDigit) {
			// This segment of b is shorter than in a
			return -1;
		} else {
			let aNumber = aChar - 48;
			let bNumber = bChar - 48;

			while (++i &lt; aLength) {
				aChar = a.charCodeAt(i);
				if (aChar &lt; 48 || aChar &gt; 57) break;
				aNumber = aNumber * 10 + aChar - 48;
			}

			while (++j &lt; bLength) {
				bChar = b.charCodeAt(j);
				if (bChar &lt; 48 || bChar &gt; 57) break;
				bNumber = bNumber * 10 + bChar - 48;
			}

			if (aNumber &lt; bNumber) return -1;
			if (aNumber &gt; bNumber) return 1;
		}
	}

	if (j &lt; bLength) {
		// a is shorter than b
		bChar = b.charCodeAt(j);
		bIsDigit = bChar &gt;= 48 &amp;&amp; bChar &lt;= 57;
		return bIsDigit ? -1 : 1;
	}
	if (i &lt; aLength) {
		// b is shorter than a
		aChar = a.charCodeAt(i);
		aIsDigit = aChar &gt;= 48 &amp;&amp; aChar &lt;= 57;
		return aIsDigit ? 1 : -1;
	}

	return 0;
};
module.exports.compareStringsNumeric = compareStringsNumeric;

/**
 * @param {ModuleGraph} moduleGraph the module graph
 * @param {Module} a module
 * @param {Module} b module
 * @returns {-1|0|1} compare result
 */
const compareModulesByPostOrderIndexOrIdentifier = (moduleGraph, a, b) =&gt; {
	const cmp = compareNumbers(
		/** @type {number} */ (moduleGraph.getPostOrderIndex(a)),
		/** @type {number} */ (moduleGraph.getPostOrderIndex(b))
	);
	if (cmp !== 0) return cmp;
	return compareIds(a.identifier(), b.identifier());
};
/** @type {ParameterizedComparator&lt;ModuleGraph, Module&gt;} */
module.exports.compareModulesByPostOrderIndexOrIdentifier =
	createCachedParameterizedComparator(
		compareModulesByPostOrderIndexOrIdentifier
	);

/**
 * @param {ModuleGraph} moduleGraph the module graph
 * @param {Module} a module
 * @param {Module} b module
 * @returns {-1|0|1} compare result
 */
const compareModulesByPreOrderIndexOrIdentifier = (moduleGraph, a, b) =&gt; {
	const cmp = compareNumbers(
		/** @type {number} */ (moduleGraph.getPreOrderIndex(a)),
		/** @type {number} */ (moduleGraph.getPreOrderIndex(b))
	);
	if (cmp !== 0) return cmp;
	return compareIds(a.identifier(), b.identifier());
};
/** @type {ParameterizedComparator&lt;ModuleGraph, Module&gt;} */
module.exports.compareModulesByPreOrderIndexOrIdentifier =
	createCachedParameterizedComparator(
		compareModulesByPreOrderIndexOrIdentifier
	);

/**
 * @param {ChunkGraph} chunkGraph the chunk graph
 * @param {Module} a module
 * @param {Module} b module
 * @returns {-1|0|1} compare result
 */
const compareModulesByIdOrIdentifier = (chunkGraph, a, b) =&gt; {
	const cmp = compareIds(
		/** @type {ModuleId} */ (chunkGraph.getModuleId(a)),
		/** @type {ModuleId} */ (chunkGraph.getModuleId(b))
	);
	if (cmp !== 0) return cmp;
	return compareIds(a.identifier(), b.identifier());
};
/** @type {ParameterizedComparator&lt;ChunkGraph, Module&gt;} */
module.exports.compareModulesByIdOrIdentifier =
	createCachedParameterizedComparator(compareModulesByIdOrIdentifier);

/**
 * @param {ChunkGraph} chunkGraph the chunk graph
 * @param {Chunk} a chunk
 * @param {Chunk} b chunk
 * @returns {-1 | 0 | 1} compare result
 */
const compareChunks = (chunkGraph, a, b) =&gt; chunkGraph.compareChunks(a, b);
/** @type {ParameterizedComparator&lt;ChunkGraph, Chunk&gt;} */
module.exports.compareChunks =
	createCachedParameterizedComparator(compareChunks);

/**
 * @param {string | number} a first id
 * @param {string | number} b second id
 * @returns {-1 | 0 | 1} compare result
 */
const compareIds = (a, b) =&gt; {
	if (typeof a !== typeof b) {
		return typeof a &lt; typeof b ? -1 : 1;
	}
	if (a &lt; b) return -1;
	if (a &gt; b) return 1;
	return 0;
};

module.exports.compareIds = compareIds;

/**
 * @param {string} a first string
 * @param {string} b second string
 * @returns {-1|0|1} compare result
 */
const compareStrings = (a, b) =&gt; {
	if (a &lt; b) return -1;
	if (a &gt; b) return 1;
	return 0;
};

module.exports.compareStrings = compareStrings;

/**
 * @param {ChunkGroup} a first chunk group
 * @param {ChunkGroup} b second chunk group
 * @returns {-1 | 0 | 1} compare result
 */
const compareChunkGroupsByIndex = (a, b) =&gt;
	/** @type {number} */ (a.index) &lt; /** @type {number} */ (b.index) ? -1 : 1;
module.exports.compareChunkGroupsByIndex = compareChunkGroupsByIndex;

/**
 * @template {EXPECTED_OBJECT} K1
 * @template {EXPECTED_OBJECT} K2
 * @template T
 */
class TwoKeyWeakMap {
	constructor() {
		/**
		 * @private
		 * @type {WeakMap&lt;K1, WeakMap&lt;K2, T | undefined&gt;&gt;}
		 */
		this._map = new WeakMap();
	}

	/**
	 * @param {K1} key1 first key
	 * @param {K2} key2 second key
	 * @returns {T | undefined} value
	 */
	get(key1, key2) {
		const childMap = this._map.get(key1);
		if (childMap === undefined) {
			return;
		}
		return childMap.get(key2);
	}

	/**
	 * @param {K1} key1 first key
	 * @param {K2} key2 second key
	 * @param {T | undefined} value new value
	 * @returns {void}
	 */
	set(key1, key2, value) {
		let childMap = this._map.get(key1);
		if (childMap === undefined) {
			childMap = new WeakMap();
			this._map.set(key1, childMap);
		}
		childMap.set(key2, value);
	}
}

/** @type {TwoKeyWeakMap&lt;Comparator&lt;EXPECTED_ANY&gt;, Comparator&lt;EXPECTED_ANY&gt;, Comparator&lt;EXPECTED_ANY&gt;&gt;}} */
const concatComparatorsCache = new TwoKeyWeakMap();

/**
 * @template T
 * @param {Comparator&lt;T&gt;} c1 comparator
 * @param {Comparator&lt;T&gt;} c2 comparator
 * @param {Comparator&lt;T&gt;[]} cRest comparators
 * @returns {Comparator&lt;T&gt;} comparator
 */
const concatComparators = (c1, c2, ...cRest) =&gt; {
	if (cRest.length &gt; 0) {
		const [c3, ...cRest2] = cRest;
		return concatComparators(c1, concatComparators(c2, c3, ...cRest2));
	}
	const cacheEntry = /** @type {Comparator&lt;T&gt;} */ (
		concatComparatorsCache.get(c1, c2)
	);
	if (cacheEntry !== undefined) return cacheEntry;
	/**
	 * @param {T} a first value
	 * @param {T} b second value
	 * @returns {-1|0|1} compare result
	 */
	const result = (a, b) =&gt; {
		const res = c1(a, b);
		if (res !== 0) return res;
		return c2(a, b);
	};
	concatComparatorsCache.set(c1, c2, result);
	return result;
};
module.exports.concatComparators = concatComparators;

/**
 * @template A, B
 * @typedef {(input: A) =&gt; B | undefined | null} Selector
 */

/** @type {TwoKeyWeakMap&lt;Selector&lt;EXPECTED_ANY, EXPECTED_ANY&gt;, Comparator&lt;EXPECTED_ANY&gt;, Comparator&lt;EXPECTED_ANY&gt;&gt;}} */
const compareSelectCache = new TwoKeyWeakMap();

/**
 * @template T
 * @template R
 * @param {Selector&lt;T, R&gt;} getter getter for value
 * @param {Comparator&lt;R&gt;} comparator comparator
 * @returns {Comparator&lt;T&gt;} comparator
 */
const compareSelect = (getter, comparator) =&gt; {
	const cacheEntry = compareSelectCache.get(getter, comparator);
	if (cacheEntry !== undefined) return cacheEntry;
	/**
	 * @param {T} a first value
	 * @param {T} b second value
	 * @returns {-1|0|1} compare result
	 */
	const result = (a, b) =&gt; {
		const aValue = getter(a);
		const bValue = getter(b);
		if (aValue !== undefined &amp;&amp; aValue !== null) {
			if (bValue !== undefined &amp;&amp; bValue !== null) {
				return comparator(aValue, bValue);
			}
			return -1;
		}
		if (bValue !== undefined &amp;&amp; bValue !== null) {
			return 1;
		}
		return 0;
	};
	compareSelectCache.set(getter, comparator, result);
	return result;
};
module.exports.compareSelect = compareSelect;

/** @type {WeakMap&lt;Comparator&lt;EXPECTED_ANY&gt;, Comparator&lt;Iterable&lt;EXPECTED_ANY&gt;&gt;&gt;} */
const compareIteratorsCache = new WeakMap();

/**
 * @template T
 * @param {Comparator&lt;T&gt;} elementComparator comparator for elements
 * @returns {Comparator&lt;Iterable&lt;T&gt;&gt;} comparator for iterables of elements
 */
const compareIterables = elementComparator =&gt; {
	const cacheEntry = compareIteratorsCache.get(elementComparator);
	if (cacheEntry !== undefined) return cacheEntry;
	/**
	 * @param {Iterable&lt;T&gt;} a first value
	 * @param {Iterable&lt;T&gt;} b second value
	 * @returns {-1|0|1} compare result
	 */
	const result = (a, b) =&gt; {
		const aI = a[Symbol.iterator]();
		const bI = b[Symbol.iterator]();
		while (true) {
			const aItem = aI.next();
			const bItem = bI.next();
			if (aItem.done) {
				return bItem.done ? 0 : -1;
			} else if (bItem.done) {
				return 1;
			}
			const res = elementComparator(aItem.value, bItem.value);
			if (res !== 0) return res;
		}
	};
	compareIteratorsCache.set(elementComparator, result);
	return result;
};
module.exports.compareIterables = compareIterables;

// TODO this is no longer needed when minimum node.js version is &gt;= 12
// since these versions ship with a stable sort function
/**
 * @template T
 * @param {Iterable&lt;T&gt;} iterable original ordered list
 * @returns {Comparator&lt;T&gt;} comparator
 */
module.exports.keepOriginalOrder = iterable =&gt; {
	/** @type {Map&lt;T, number&gt;} */
	const map = new Map();
	let i = 0;
	for (const item of iterable) {
		map.set(item, i++);
	}
	return (a, b) =&gt;
		compareNumbers(
			/** @type {number} */ (map.get(a)),
			/** @type {number} */ (map.get(b))
		);
};

/**
 * @param {ChunkGraph} chunkGraph the chunk graph
 * @returns {Comparator&lt;Chunk&gt;} comparator
 */
module.exports.compareChunksNatural = chunkGraph =&gt; {
	const cmpFn = module.exports.compareModulesById(chunkGraph);
	const cmpIterableFn = compareIterables(cmpFn);
	return concatComparators(
		compareSelect(
			chunk =&gt; /** @type {string|number} */ (chunk.name),
			compareIds
		),
		compareSelect(chunk =&gt; chunk.runtime, compareRuntime),
		compareSelect(
			/**
			 * @param {Chunk} chunk a chunk
			 * @returns {Iterable&lt;Module&gt;} modules
			 */
			chunk =&gt; chunkGraph.getOrderedChunkModulesIterable(chunk, cmpFn),
			cmpIterableFn
		)
	);
};

/**
 * Compare two locations
 * @param {DependencyLocation} a A location node
 * @param {DependencyLocation} b A location node
 * @returns {-1|0|1} sorting comparator value
 */
module.exports.compareLocations = (a, b) =&gt; {
	const isObjectA = typeof a === &quot;object&quot; &amp;&amp; a !== null;
	const isObjectB = typeof b === &quot;object&quot; &amp;&amp; b !== null;
	if (!isObjectA || !isObjectB) {
		if (isObjectA) return 1;
		if (isObjectB) return -1;
		return 0;
	}
	if (&quot;start&quot; in a) {
		if (&quot;start&quot; in b) {
			const ap = a.start;
			const bp = b.start;
			if (ap.line &lt; bp.line) return -1;
			if (ap.line &gt; bp.line) return 1;
			if (/** @type {number} */ (ap.column) &lt; /** @type {number} */ (bp.column))
				return -1;
			if (/** @type {number} */ (ap.column) &gt; /** @type {number} */ (bp.column))
				return 1;
		} else return -1;
	} else if (&quot;start&quot; in b) return 1;
	if (&quot;name&quot; in a) {
		if (&quot;name&quot; in b) {
			if (a.name &lt; b.name) return -1;
			if (a.name &gt; b.name) return 1;
		} else return -1;
	} else if (&quot;name&quot; in b) return 1;
	if (&quot;index&quot; in a) {
		if (&quot;index&quot; in b) {
			if (/** @type {number} */ (a.index) &lt; /** @type {number} */ (b.index))
				return -1;
			if (/** @type {number} */ (a.index) &gt; /** @type {number} */ (b.index))
				return 1;
		} else return -1;
	} else if (&quot;index&quot; in b) return 1;
	return 0;
};
</textarea>
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p>.</p>
  </div>
</footer>

<script type="text/html" id="complexity-popover-template">
  <div class="complexity-notice">
    Complexity : {{ complexity.cyclomatic }} <br>
    Length : {{ complexity.halstead.length }} <br>
    Difficulty : {{ complexity.halstead.difficulty.toFixed(2) }} <br>
    Est # bugs : {{ complexity.halstead.bugs.toFixed(2) }}<br>
  </div>
</script>

<script type="text/javascript" src="../../assets/scripts/bundles/core-bundle.js"></script>
<script type="text/javascript" src="../../assets/scripts/bundles/codemirror.js"></script>
<script type="text/javascript" src="../../assets/scripts/codemirror.markpopovertext.js"></script>
<script type="text/javascript" src="report.js"></script>
<script type="text/javascript" src="report.history.js"></script>
<script type="text/javascript" src="../../assets/scripts/plato-file.js"></script>
</body>
</html>
