<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Plato - node_modules/rtlcss/bin/rtlcss.js</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">

  <!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <link href="../../assets/css/vendor/morris.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/vendor/bootstrap.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/vendor/font-awesome.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/vendor/codemirror.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/plato.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/plato-file.css" rel="stylesheet" type="text/css">

</head>

<body>

<div class="navbar navbar-fixed-top">
  <div class="container">
    <a class="navbar-brand" href="https://github.com/the-simian/es6-plato">ES6 Plato on Github</a>
    <ul class="nav navbar-nav">
      <li>
        <a href="../../index.html">Report Home</a>
      </li>
      <li class="active">
        <a href="display.html">Summary Display</a>
      </li>
    </ul>
  </div>
</div>

<div class="jumbotron">
  <div class="container">
    <h1>node_modules/rtlcss/bin/rtlcss.js</h1>
  </div>
</div>

<div class="container aggregate-stats">
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Maintainability <a href="http://blogs.msdn.com/b/codeanalysis/archive/2007/11/20/maintainability-index-range-and-meaning.aspx"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="A value between 0 and 100 that represents the relative ease of maintaining the code. A high value means better maintainability." data-original-title="Maintainability Index"  data-container="body"></i></a></h2>
      <p class="stat">65.19</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Lines of code <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h2>
      <p class="stat">303</p>
    </div>
  </div>
  <div class="row historical">
    <div class="col-md-6">
      <p id="chart_historical_maint" class="chart"></p>
    </div>
    <div class="col-md-6">
      <p id="chart_historical_sloc" class="chart"></p>
    </div>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Difficulty  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="The difficulty measure is related to the difficulty of the program to write or understand." data-original-title="Difficulty" data-container="body"></i></a></h2>
      <p class="stat">49.05</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Estimated Errors  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Halstead's delivered bugs is an estimate for the number of errors in the implementation." data-original-title="Delivered Bugs" data-container="body"></i></a></h2>
      <p class="stat">2.30</p>
    </div>
  </div>
</div>

<div class="container charts">
  <div class="row">
    <h2 class="header">Function weight</h2>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h3 class="chart-header">By Complexity <a href="http://en.wikipedia.org/wiki/Cyclomatic_complexity"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="This metric counts the number of distinct paths through a block of code. Lower values are better." data-original-title="Cyclomatic Complexity" data-container="body"></i></a></h3>
      <div id="fn-by-complexity" class="stat"></div>
    </div>
    <div class="col-md-6">
      <h3 class="chart-header">By SLOC  <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h3>
      <div id="fn-by-sloc" class="stat"></div>
    </div>
  </div>
</div>

<div class="container">
  <div class="row">
    <textarea id="file-source" class="col-md-12">//#!/usr/bin/env node

&#039;use strict&#039;

const path = require(&#039;path&#039;)
const fs = require(&#039;fs&#039;)
const picocolors = require(&#039;picocolors&#039;)
const postcss = require(&#039;postcss&#039;)
const rtlcss = require(&#039;../lib/rtlcss.js&#039;)
const configLoader = require(&#039;../lib/config-loader.js&#039;)
const { version, bugs } = require(&#039;../package.json&#039;)

const HELP_TEXT = `Usage: rtlcss [option option=parameter ...] [source] [destination]

Option           Description
--------------   ----------------------------------------------
-h,--help        Print help (this message) and exit.
-v,--version     Print version number and exit.
-c,--config      Path to configuration settings file.
- ,--stdin       Read from stdin stream.
-d,--directory   Process all *.css files from input directory (recursive).
-e,--ext         Used with -d option to set the output files extension.
                 Default: &quot;.rtl.css&quot;.
-s,--silent      Silent mode, no warnings or errors are printed.

*If no destination is specified, output will be written to the same input folder as {source}.rtl.{ext}
`

const ErrorCodes = Object.freeze({
  Ok: 0,
  ArgumentError: 1,
  ProcessingError: 2
})

let input, output, directory, ext, config
let currentErrorcode = ErrorCodes.Ok
const args = process.argv.slice(2)

process.on(&#039;exit&#039;, () =&gt; { process.reallyExit(currentErrorcode) })

function printWarning (...args) {
  args.forEach(a =&gt; console.warn(picocolors.yellow(a)))
}

function printInfo (...args) {
  args.forEach(a =&gt; console.info(picocolors.green(a)))
}

function printError (...args) {
  args.forEach(a =&gt; console.error(picocolors.red(a)))
}

function printHelp () {
  console.log(HELP_TEXT)

  printInfo(`RTLCSS version: ${version}`)
  printInfo(`Report issues to: ${bugs.url}`)
}

function processCSSFile (error, data, outputName) {
  if (error) {
    printError(`rtlcss: ${error.message}`)
    return
  }

  let result
  const opt = { map: false }

  if (input !== &#039;-&#039;) {
    opt.from = input
    opt.to = output
  }

  if (!config) {
    printWarning(&#039;rtlcss: Warning! No config present, using defaults.&#039;)
    result = postcss([rtlcss]).process(data, opt)
  } else {
    if (&#039;map&#039; in config === true &amp;&amp; input !== &#039;-&#039;) {
      opt.map = config.map
    }

    result = postcss([rtlcss.configure(config)]).process(data, opt)
  }

  if (output) {
    const savePath = directory !== true ? output : outputName
    printInfo(&#039;Saving:&#039;, savePath)

    fs.writeFile(savePath, result.css, (err) =&gt; {
      if (err) printError(err)
    })

    if (result.map) {
      fs.writeFile(`${savePath}.map`, result.map, (err) =&gt; {
        if (err) printError(err)
      })
    }
  } else {
    process.stdout.write(`${result.css}\n`)
  }
}

function walk (dir, done) {
  fs.readdir(dir, (error, list) =&gt; {
    if (error) {
      return done(error)
    }

    let i = 0;
    (function next () {
      let file = list[i++]
      if (!file) {
        return done(null)
      }

      file = path.join(dir, file)
      fs.stat(file, (err, stat) =&gt; {
        if (err) {
          printError(err)
        } else if (stat &amp;&amp; stat.isDirectory()) {
          walk(file, (err) =&gt; {
            if (err) {
              printError(err)
            } else {
              next()
            }
          })
        } else {
          // process only *.css files
          if (path.extname(file) === &#039;.css&#039;) {
            // TODO: this could probably be simplified
            // compute output directory
            const relativePath = path.relative(input, file).split(path.sep)
            relativePath.pop()
            relativePath.push(path.basename(file).replace(&#039;.css&#039;, ext || &#039;.rtl.css&#039;))

            // set rtl filename
            const rtlFile = path.join(output, relativePath.join(path.sep))

            // create output directory if it does not exist
            const dirName = path.dirname(rtlFile)
            if (!fs.existsSync(dirName)) {
              fs.mkdirSync(dirName, { recursive: true })
            }

            // read and process the file.
            fs.readFile(file, &#039;utf8&#039;, (e, data) =&gt; {
              try {
                processCSSFile(e, data, rtlFile)
              } catch (e) {
                currentErrorcode = ErrorCodes.ProcessingError
                printError(`rtlcss: error processing file ${file}`)
                printError(e)
              }
            })
          }

          next()
        }
      })
    })()
  })
}

function main () {
  let arg
  while ((arg = args.shift())) {
    switch (arg) {
      case &#039;-h&#039;:
      case &#039;--help&#039;:
        printHelp()
        return
      case &#039;-v&#039;:
      case &#039;--version&#039;:
        printInfo(`rtlcss version: ${version}`)
        return
      case &#039;-c&#039;:
      case &#039;--config&#039;:
        arg = args.shift()
        try {
          config = configLoader.load(path.resolve(arg))
        } catch (e) {
          printError(`rtlcss: invalid config file. ${e}`)
          currentErrorcode = ErrorCodes.ArgumentError
          return
        }
        break
      case &#039;-d&#039;:
      case &#039;--directory&#039;:
        directory = true
        break
      case &#039;-e&#039;:
      case &#039;--ext&#039;:
        ext = args.shift()
        break
      case &#039;-s&#039;:
      case &#039;--silent&#039;:
        console.log = console.info = console.warn = () =&gt; {}
        break
      case &#039;-&#039;:
      case &#039;--stdin&#039;:
        input = &#039;-&#039;
        break
      default:
        if (arg[0] === &#039;-&#039;) {
          printError(`rtlcss: unknown option. ${arg}`)
          currentErrorcode = ErrorCodes.ArgumentError
          return
        }

        if (!input) {
          input = path.resolve(arg)
        } else if (!output) {
          output = path.resolve(arg)
        }
        break
    }
  }

  if (!directory &amp;&amp; !input) {
    printError(&#039;rtlcss: no input file\n&#039;)
    printHelp()
    currentErrorcode = ErrorCodes.ArgumentError
    return
  }

  if (!config &amp;&amp; input !== &#039;-&#039;) {
    try {
      const cwd = directory !== true ? path.dirname(input) : input
      config = configLoader.load(null, cwd)
    } catch (error) {
      printError(`rtlcss: invalid config file. ${error}`)
      currentErrorcode = ErrorCodes.ArgumentError
    }
  }

  if (!output &amp;&amp; input !== &#039;-&#039;) {
    if (directory !== true) {
      const extension = path.extname(input)
      output = extension ? input.replace(extension, `.rtl${extension}`) : `${input}.rtl`
    } else {
      output = input
    }
  }

  if (input !== &#039;-&#039;) {
    if (directory !== true) {
      fs.stat(input, (error, stat) =&gt; {
        if (error) {
          printError(error)
        } else if (stat &amp;&amp; stat.isDirectory()) {
          printError(&#039;rtlcss: Input expected to be a file, use the -d option to process a directory.&#039;)
        } else {
          fs.readFile(input, &#039;utf8&#039;, (err, data) =&gt; {
            try {
              processCSSFile(err, data)
            } catch (err) {
              currentErrorcode = ErrorCodes.ProcessingError
              printError(`rtlcss: error processing file ${input}`)
              printError(err)
            }
          })
        }
      })
    } else {
      walk(input, (error) =&gt; {
        if (error) {
          printError(`rtlcss: ${error}`)
        }
      })
    }
  } else {
    process.stdin.resume()
    process.stdin.setEncoding(&#039;utf8&#039;)

    let buffer = &#039;&#039;
    process.stdin.on(&#039;data&#039;, (data) =&gt; {
      buffer += data
    })
    process.on(&#039;SIGINT&#039;, () =&gt; {
      try {
        processCSSFile(false, buffer)
      } catch (e) {
        currentErrorcode = ErrorCodes.ProcessingError
        printError(&#039;rtlcss: error processing payload&#039;)
        printError(e)
      }
      process.exit()
    })
    process.stdin.on(&#039;end&#039;, () =&gt; {
      try {
        processCSSFile(false, buffer)
      } catch (e) {
        currentErrorcode = ErrorCodes.ProcessingError
        printError(&#039;rtlcss: error processing payload&#039;)
        printError(e)
      }
    })
  }
}

main()
</textarea>
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p>.</p>
  </div>
</footer>

<script type="text/html" id="complexity-popover-template">
  <div class="complexity-notice">
    Complexity : {{ complexity.cyclomatic }} <br>
    Length : {{ complexity.halstead.length }} <br>
    Difficulty : {{ complexity.halstead.difficulty.toFixed(2) }} <br>
    Est # bugs : {{ complexity.halstead.bugs.toFixed(2) }}<br>
  </div>
</script>

<script type="text/javascript" src="../../assets/scripts/bundles/core-bundle.js"></script>
<script type="text/javascript" src="../../assets/scripts/bundles/codemirror.js"></script>
<script type="text/javascript" src="../../assets/scripts/codemirror.markpopovertext.js"></script>
<script type="text/javascript" src="report.js"></script>
<script type="text/javascript" src="report.history.js"></script>
<script type="text/javascript" src="../../assets/scripts/plato-file.js"></script>
</body>
</html>
