<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Plato - node_modules/terser/lib/minify.js</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">

  <!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <link href="../../assets/css/vendor/morris.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/vendor/bootstrap.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/vendor/font-awesome.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/vendor/codemirror.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/plato.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/plato-file.css" rel="stylesheet" type="text/css">

</head>

<body>

<div class="navbar navbar-fixed-top">
  <div class="container">
    <a class="navbar-brand" href="https://github.com/the-simian/es6-plato">ES6 Plato on Github</a>
    <ul class="nav navbar-nav">
      <li>
        <a href="../../index.html">Report Home</a>
      </li>
      <li class="active">
        <a href="display.html">Summary Display</a>
      </li>
    </ul>
  </div>
</div>

<div class="jumbotron">
  <div class="container">
    <h1>node_modules/terser/lib/minify.js</h1>
  </div>
</div>

<div class="container aggregate-stats">
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Maintainability <a href="http://blogs.msdn.com/b/codeanalysis/archive/2007/11/20/maintainability-index-range-and-meaning.aspx"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="A value between 0 and 100 that represents the relative ease of maintaining the code. A high value means better maintainability." data-original-title="Maintainability Index"  data-container="body"></i></a></h2>
      <p class="stat">52.35</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Lines of code <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h2>
      <p class="stat">413</p>
    </div>
  </div>
  <div class="row historical">
    <div class="col-md-6">
      <p id="chart_historical_maint" class="chart"></p>
    </div>
    <div class="col-md-6">
      <p id="chart_historical_sloc" class="chart"></p>
    </div>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Difficulty  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="The difficulty measure is related to the difficulty of the program to write or understand." data-original-title="Difficulty" data-container="body"></i></a></h2>
      <p class="stat">100.65</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Estimated Errors  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Halstead's delivered bugs is an estimate for the number of errors in the implementation." data-original-title="Delivered Bugs" data-container="body"></i></a></h2>
      <p class="stat">5.07</p>
    </div>
  </div>
</div>

<div class="container charts">
  <div class="row">
    <h2 class="header">Function weight</h2>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h3 class="chart-header">By Complexity <a href="http://en.wikipedia.org/wiki/Cyclomatic_complexity"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="This metric counts the number of distinct paths through a block of code. Lower values are better." data-original-title="Cyclomatic Complexity" data-container="body"></i></a></h3>
      <div id="fn-by-complexity" class="stat"></div>
    </div>
    <div class="col-md-6">
      <h3 class="chart-header">By SLOC  <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h3>
      <div id="fn-by-sloc" class="stat"></div>
    </div>
  </div>
</div>

<div class="container">
  <div class="row">
    <textarea id="file-source" class="col-md-12">&quot;use strict&quot;;
/* eslint-env browser, es6, node */

import {
    defaults,
    map_from_object,
    map_to_object,
    HOP,
} from &quot;./utils/index.js&quot;;
import { AST_Toplevel, AST_Node, walk, AST_Scope } from &quot;./ast.js&quot;;
import { parse } from &quot;./parse.js&quot;;
import { OutputStream } from &quot;./output.js&quot;;
import { Compressor } from &quot;./compress/index.js&quot;;
import { base54 } from &quot;./scope.js&quot;;
import { SourceMap } from &quot;./sourcemap.js&quot;;
import {
    mangle_properties,
    mangle_private_properties,
    reserve_quoted_keys,
    find_annotated_props,
} from &quot;./propmangle.js&quot;;

// to/from base64 functions
// Prefer built-in Buffer, if available, then use hack
// https://developer.mozilla.org/en-US/docs/Glossary/Base64#The_Unicode_Problem
var to_ascii = typeof Buffer !== &quot;undefined&quot;
    ? (b64) =&gt; Buffer.from(b64, &quot;base64&quot;).toString()
    : (b64) =&gt; decodeURIComponent(escape(atob(b64)));
var to_base64 = typeof Buffer !== &quot;undefined&quot;
    ? (str) =&gt; Buffer.from(str).toString(&quot;base64&quot;)
    : (str) =&gt; btoa(unescape(encodeURIComponent(str)));

function read_source_map(code) {
    var match = /(?:^|[^.])\/\/# sourceMappingURL=data:application\/json(;[\w=-]*)?;base64,([+/0-9A-Za-z]*=*)\s*$/.exec(code);
    if (!match) {
        console.warn(&quot;inline source map not found&quot;);
        return null;
    }
    return to_ascii(match[2]);
}

function set_shorthand(name, options, keys) {
    if (options[name]) {
        keys.forEach(function(key) {
            if (options[key]) {
                if (typeof options[key] != &quot;object&quot;) options[key] = {};
                if (!(name in options[key])) options[key][name] = options[name];
            }
        });
    }
}

function init_cache(cache) {
    if (!cache) return;
    if (!(&quot;props&quot; in cache)) {
        cache.props = new Map();
    } else if (!(cache.props instanceof Map)) {
        cache.props = map_from_object(cache.props);
    }
}

function cache_to_json(cache) {
    return {
        props: map_to_object(cache.props)
    };
}

function log_input(files, options, fs, debug_folder) {
    if (!(fs &amp;&amp; fs.writeFileSync &amp;&amp; fs.mkdirSync)) {
        return;
    }

    try {
        fs.mkdirSync(debug_folder);
    } catch (e) {
        if (e.code !== &quot;EEXIST&quot;) throw e;
    }

    const log_path = `${debug_folder}/terser-debug-${(Math.random() * 9999999) | 0}.log`;

    options = options || {};

    const options_str = JSON.stringify(options, (_key, thing) =&gt; {
        if (typeof thing === &quot;function&quot;) return &quot;[Function &quot; + thing.toString() + &quot;]&quot;;
        if (thing instanceof RegExp) return &quot;[RegExp &quot; + thing.toString() + &quot;]&quot;;
        return thing;
    }, 4);

    const files_str = (file) =&gt; {
        if (typeof file === &quot;object&quot; &amp;&amp; options.parse &amp;&amp; options.parse.spidermonkey) {
            return JSON.stringify(file, null, 2);
        } else if (typeof file === &quot;object&quot;) {
            return Object.keys(file)
                .map((key) =&gt; key + &quot;: &quot; + files_str(file[key]))
                .join(&quot;\n\n&quot;);
        } else if (typeof file === &quot;string&quot;) {
            return &quot;```\n&quot; + file + &quot;\n```&quot;;
        } else {
            return file; // What do?
        }
    };

    fs.writeFileSync(log_path, &quot;Options: \n&quot; + options_str + &quot;\n\nInput files:\n\n&quot; + files_str(files) + &quot;\n&quot;);
}

function* minify_sync_or_async(files, options, _fs_module) {
    if (
        _fs_module
        &amp;&amp; typeof process === &quot;object&quot;
        &amp;&amp; process.env
        &amp;&amp; typeof process.env.TERSER_DEBUG_DIR === &quot;string&quot;
    ) {
        log_input(files, options, _fs_module, process.env.TERSER_DEBUG_DIR);
    }

    options = defaults(options, {
        compress: {},
        ecma: undefined,
        enclose: false,
        ie8: false,
        keep_classnames: undefined,
        keep_fnames: false,
        mangle: {},
        module: false,
        nameCache: null,
        output: null,
        format: null,
        parse: {},
        rename: undefined,
        safari10: false,
        sourceMap: false,
        spidermonkey: false,
        timings: false,
        toplevel: false,
        warnings: false,
        wrap: false,
    }, true);

    var timings = options.timings &amp;&amp; {
        start: Date.now()
    };
    if (options.keep_classnames === undefined) {
        options.keep_classnames = options.keep_fnames;
    }
    if (options.rename === undefined) {
        options.rename = options.compress &amp;&amp; options.mangle;
    }
    if (options.output &amp;&amp; options.format) {
        throw new Error(&quot;Please only specify either output or format option, preferrably format.&quot;);
    }
    options.format = options.format || options.output || {};
    set_shorthand(&quot;ecma&quot;, options, [ &quot;parse&quot;, &quot;compress&quot;, &quot;format&quot; ]);
    set_shorthand(&quot;ie8&quot;, options, [ &quot;compress&quot;, &quot;mangle&quot;, &quot;format&quot; ]);
    set_shorthand(&quot;keep_classnames&quot;, options, [ &quot;compress&quot;, &quot;mangle&quot; ]);
    set_shorthand(&quot;keep_fnames&quot;, options, [ &quot;compress&quot;, &quot;mangle&quot; ]);
    set_shorthand(&quot;module&quot;, options, [ &quot;parse&quot;, &quot;compress&quot;, &quot;mangle&quot; ]);
    set_shorthand(&quot;safari10&quot;, options, [ &quot;mangle&quot;, &quot;format&quot; ]);
    set_shorthand(&quot;toplevel&quot;, options, [ &quot;compress&quot;, &quot;mangle&quot; ]);
    set_shorthand(&quot;warnings&quot;, options, [ &quot;compress&quot; ]); // legacy
    var quoted_props;
    if (options.mangle) {
        options.mangle = defaults(options.mangle, {
            cache: options.nameCache &amp;&amp; (options.nameCache.vars || {}),
            eval: false,
            ie8: false,
            keep_classnames: false,
            keep_fnames: false,
            module: false,
            nth_identifier: base54,
            properties: false,
            reserved: [],
            safari10: false,
            toplevel: false,
        }, true);
        if (options.mangle.properties) {
            if (typeof options.mangle.properties != &quot;object&quot;) {
                options.mangle.properties = {};
            }
            if (options.mangle.properties.keep_quoted) {
                quoted_props = options.mangle.properties.reserved;
                if (!Array.isArray(quoted_props)) quoted_props = [];
                options.mangle.properties.reserved = quoted_props;
            }
            if (options.nameCache &amp;&amp; !(&quot;cache&quot; in options.mangle.properties)) {
                options.mangle.properties.cache = options.nameCache.props || {};
            }
        }
        init_cache(options.mangle.cache);
        init_cache(options.mangle.properties.cache);
    }
    if (options.sourceMap) {
        options.sourceMap = defaults(options.sourceMap, {
            asObject: false,
            content: null,
            filename: null,
            includeSources: false,
            root: null,
            url: null,
        }, true);
    }

    // -- Parse phase --
    if (timings) timings.parse = Date.now();
    var toplevel;
    if (files instanceof AST_Toplevel) {
        toplevel = files;
    } else {
        if (typeof files == &quot;string&quot; || (options.parse.spidermonkey &amp;&amp; !Array.isArray(files))) {
            files = [ files ];
        }
        options.parse = options.parse || {};
        options.parse.toplevel = null;

        if (options.parse.spidermonkey) {
            options.parse.toplevel = AST_Node.from_mozilla_ast(Object.keys(files).reduce(function(toplevel, name) {
                if (!toplevel) return files[name];
                toplevel.body = toplevel.body.concat(files[name].body);
                return toplevel;
            }, null));
        } else {
            delete options.parse.spidermonkey;

            for (var name in files) if (HOP(files, name)) {
                options.parse.filename = name;
                options.parse.toplevel = parse(files[name], options.parse);
                if (options.sourceMap &amp;&amp; options.sourceMap.content == &quot;inline&quot;) {
                    if (Object.keys(files).length &gt; 1)
                        throw new Error(&quot;inline source map only works with singular input&quot;);
                    options.sourceMap.content = read_source_map(files[name]);
                }
            }
        }
        if (options.parse.toplevel === null) {
            throw new Error(&quot;no source file given&quot;);
        }

        toplevel = options.parse.toplevel;
    }
    if (quoted_props &amp;&amp; options.mangle.properties.keep_quoted !== &quot;strict&quot;) {
        reserve_quoted_keys(toplevel, quoted_props);
    }
    var annotated_props;
    if (options.mangle &amp;&amp; options.mangle.properties) {
        annotated_props = find_annotated_props(toplevel);
    }
    if (options.wrap) {
        toplevel = toplevel.wrap_commonjs(options.wrap);
    }
    if (options.enclose) {
        toplevel = toplevel.wrap_enclose(options.enclose);
    }
    if (timings) timings.rename = Date.now();
    // disable rename on harmony due to expand_names bug in for-of loops
    // https://github.com/mishoo/UglifyJS2/issues/2794
    if (0 &amp;&amp; options.rename) {
        toplevel.figure_out_scope(options.mangle);
        toplevel.expand_names(options.mangle);
    }

    // -- Compress phase --
    if (timings) timings.compress = Date.now();
    if (options.compress) {
        toplevel = new Compressor(options.compress, {
            mangle_options: options.mangle
        }).compress(toplevel);
    }

    // -- Mangle phase --
    if (timings) timings.scope = Date.now();
    if (options.mangle) toplevel.figure_out_scope(options.mangle);
    if (timings) timings.mangle = Date.now();
    if (options.mangle) {
        toplevel.compute_char_frequency(options.mangle);
        toplevel.mangle_names(options.mangle);
        toplevel = mangle_private_properties(toplevel, options.mangle);
    }
    if (timings) timings.properties = Date.now();
    if (options.mangle &amp;&amp; options.mangle.properties) {
        toplevel = mangle_properties(toplevel, options.mangle.properties, annotated_props);
    }

    // Format phase
    if (timings) timings.format = Date.now();
    var result = {};
    if (options.format.ast) {
        result.ast = toplevel;
    }
    if (options.format.spidermonkey) {
        result.ast = toplevel.to_mozilla_ast();
    }
    let format_options;
    if (!HOP(options.format, &quot;code&quot;) || options.format.code) {
        // Make a shallow copy so that we can modify without mutating the user&#039;s input.
        format_options = {...options.format};
        if (!format_options.ast) {
            // Destroy stuff to save RAM. (unless the deprecated `ast` option is on)
            format_options._destroy_ast = true;

            walk(toplevel, node =&gt; {
                if (node instanceof AST_Scope) {
                    node.variables = undefined;
                    node.enclosed = undefined;
                    node.parent_scope = undefined;
                }
                if (node.block_scope) {
                    node.block_scope.variables = undefined;
                    node.block_scope.enclosed = undefined;
                    node.block_scope.parent_scope = undefined;
                }
            });
        }

        if (options.sourceMap) {
            if (options.sourceMap.includeSources &amp;&amp; files instanceof AST_Toplevel) {
                throw new Error(&quot;original source content unavailable&quot;);
            }
            format_options.source_map = yield* SourceMap({
                file: options.sourceMap.filename,
                orig: options.sourceMap.content,
                root: options.sourceMap.root,
                files: options.sourceMap.includeSources ? files : null,
            });
        }
        delete format_options.ast;
        delete format_options.code;
        delete format_options.spidermonkey;
        var stream = OutputStream(format_options);
        toplevel.print(stream);
        result.code = stream.get();
        if (options.sourceMap) {
            Object.defineProperty(result, &quot;map&quot;, {
                configurable: true,
                enumerable: true,
                get() {
                    const map = format_options.source_map.getEncoded();
                    return (result.map = options.sourceMap.asObject ? map : JSON.stringify(map));
                },
                set(value) {
                    Object.defineProperty(result, &quot;map&quot;, {
                        value,
                        writable: true,
                    });
                }
            });
            result.decoded_map = format_options.source_map.getDecoded();
            if (options.sourceMap.url == &quot;inline&quot;) {
                var sourceMap = typeof result.map === &quot;object&quot; ? JSON.stringify(result.map) : result.map;
                result.code += &quot;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,&quot; + to_base64(sourceMap);
            } else if (options.sourceMap.url) {
                result.code += &quot;\n//# sourceMappingURL=&quot; + options.sourceMap.url;
            }
        }
    }
    if (options.nameCache &amp;&amp; options.mangle) {
        if (options.mangle.cache) options.nameCache.vars = cache_to_json(options.mangle.cache);
        if (options.mangle.properties &amp;&amp; options.mangle.properties.cache) {
            options.nameCache.props = cache_to_json(options.mangle.properties.cache);
        }
    }
    if (format_options &amp;&amp; format_options.source_map) {
        format_options.source_map.destroy();
    }
    if (timings) {
        timings.end = Date.now();
        result.timings = {
            parse: 1e-3 * (timings.rename - timings.parse),
            rename: 1e-3 * (timings.compress - timings.rename),
            compress: 1e-3 * (timings.scope - timings.compress),
            scope: 1e-3 * (timings.mangle - timings.scope),
            mangle: 1e-3 * (timings.properties - timings.mangle),
            properties: 1e-3 * (timings.format - timings.properties),
            format: 1e-3 * (timings.end - timings.format),
            total: 1e-3 * (timings.end - timings.start)
        };
    }
    return result;
}

async function minify(files, options, _fs_module) {
    const gen = minify_sync_or_async(files, options, _fs_module);

    let yielded;
    let val;
    do {
        val = gen.next(await yielded);
        yielded = val.value;
    } while (!val.done);

    return val.value;
}

function minify_sync(files, options, _fs_module) {
    const gen = minify_sync_or_async(files, options, _fs_module);

    let yielded;
    let val;
    do {
        if (yielded &amp;&amp; typeof yielded.then === &quot;function&quot;) {
            throw new Error(&quot;minify_sync cannot be used with the legacy source-map module&quot;);
        }
        val = gen.next(yielded);
        yielded = val.value;
    } while (!val.done);

    return val.value;
}

export {
  minify,
  minify_sync,
  to_ascii,
};
</textarea>
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p>.</p>
  </div>
</footer>

<script type="text/html" id="complexity-popover-template">
  <div class="complexity-notice">
    Complexity : {{ complexity.cyclomatic }} <br>
    Length : {{ complexity.halstead.length }} <br>
    Difficulty : {{ complexity.halstead.difficulty.toFixed(2) }} <br>
    Est # bugs : {{ complexity.halstead.bugs.toFixed(2) }}<br>
  </div>
</script>

<script type="text/javascript" src="../../assets/scripts/bundles/core-bundle.js"></script>
<script type="text/javascript" src="../../assets/scripts/bundles/codemirror.js"></script>
<script type="text/javascript" src="../../assets/scripts/codemirror.markpopovertext.js"></script>
<script type="text/javascript" src="report.js"></script>
<script type="text/javascript" src="report.history.js"></script>
<script type="text/javascript" src="../../assets/scripts/plato-file.js"></script>
</body>
</html>
