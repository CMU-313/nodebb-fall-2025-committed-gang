<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Plato - node_modules/webpack/lib/runtime/LoadScriptRuntimeModule.js</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">

  <!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <link href="../../assets/css/vendor/morris.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/vendor/bootstrap.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/vendor/font-awesome.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/vendor/codemirror.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/plato.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/plato-file.css" rel="stylesheet" type="text/css">

</head>

<body>

<div class="navbar navbar-fixed-top">
  <div class="container">
    <a class="navbar-brand" href="https://github.com/the-simian/es6-plato">ES6 Plato on Github</a>
    <ul class="nav navbar-nav">
      <li>
        <a href="../../index.html">Report Home</a>
      </li>
      <li class="active">
        <a href="display.html">Summary Display</a>
      </li>
    </ul>
  </div>
</div>

<div class="jumbotron">
  <div class="container">
    <h1>node_modules/webpack/lib/runtime/LoadScriptRuntimeModule.js</h1>
  </div>
</div>

<div class="container aggregate-stats">
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Maintainability <a href="http://blogs.msdn.com/b/codeanalysis/archive/2007/11/20/maintainability-index-range-and-meaning.aspx"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="A value between 0 and 100 that represents the relative ease of maintaining the code. A high value means better maintainability." data-original-title="Maintainability Index"  data-container="body"></i></a></h2>
      <p class="stat">61.16</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Lines of code <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h2>
      <p class="stat">175</p>
    </div>
  </div>
  <div class="row historical">
    <div class="col-md-6">
      <p id="chart_historical_maint" class="chart"></p>
    </div>
    <div class="col-md-6">
      <p id="chart_historical_sloc" class="chart"></p>
    </div>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Difficulty  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="The difficulty measure is related to the difficulty of the program to write or understand." data-original-title="Difficulty" data-container="body"></i></a></h2>
      <p class="stat">20.95</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Estimated Errors  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Halstead's delivered bugs is an estimate for the number of errors in the implementation." data-original-title="Delivered Bugs" data-container="body"></i></a></h2>
      <p class="stat">0.96</p>
    </div>
  </div>
</div>

<div class="container charts">
  <div class="row">
    <h2 class="header">Function weight</h2>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h3 class="chart-header">By Complexity <a href="http://en.wikipedia.org/wiki/Cyclomatic_complexity"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="This metric counts the number of distinct paths through a block of code. Lower values are better." data-original-title="Cyclomatic Complexity" data-container="body"></i></a></h3>
      <div id="fn-by-complexity" class="stat"></div>
    </div>
    <div class="col-md-6">
      <h3 class="chart-header">By SLOC  <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h3>
      <div id="fn-by-sloc" class="stat"></div>
    </div>
  </div>
</div>

<div class="container">
  <div class="row">
    <textarea id="file-source" class="col-md-12">/*
	MIT License http://www.opensource.org/licenses/mit-license.php
*/

&quot;use strict&quot;;

const { SyncWaterfallHook } = require(&quot;tapable&quot;);
const Compilation = require(&quot;../Compilation&quot;);
const RuntimeGlobals = require(&quot;../RuntimeGlobals&quot;);
const Template = require(&quot;../Template&quot;);
const HelperRuntimeModule = require(&quot;./HelperRuntimeModule&quot;);

/** @typedef {import(&quot;../Chunk&quot;)} Chunk */
/** @typedef {import(&quot;../Compiler&quot;)} Compiler */

/**
 * @typedef {object} LoadScriptCompilationHooks
 * @property {SyncWaterfallHook&lt;[string, Chunk]&gt;} createScript
 */

/** @type {WeakMap&lt;Compilation, LoadScriptCompilationHooks&gt;} */
const compilationHooksMap = new WeakMap();

class LoadScriptRuntimeModule extends HelperRuntimeModule {
	/**
	 * @param {Compilation} compilation the compilation
	 * @returns {LoadScriptCompilationHooks} hooks
	 */
	static getCompilationHooks(compilation) {
		if (!(compilation instanceof Compilation)) {
			throw new TypeError(
				&quot;The &#039;compilation&#039; argument must be an instance of Compilation&quot;
			);
		}
		let hooks = compilationHooksMap.get(compilation);
		if (hooks === undefined) {
			hooks = {
				createScript: new SyncWaterfallHook([&quot;source&quot;, &quot;chunk&quot;])
			};
			compilationHooksMap.set(compilation, hooks);
		}
		return hooks;
	}

	/**
	 * @param {boolean=} withCreateScriptUrl use create script url for trusted types
	 * @param {boolean=} withFetchPriority use `fetchPriority` attribute
	 */
	constructor(withCreateScriptUrl, withFetchPriority) {
		super(&quot;load script&quot;);
		this._withCreateScriptUrl = withCreateScriptUrl;
		this._withFetchPriority = withFetchPriority;
	}

	/**
	 * @returns {string | null} runtime code
	 */
	generate() {
		const compilation = /** @type {Compilation} */ (this.compilation);
		const { runtimeTemplate, outputOptions } = compilation;
		const {
			scriptType,
			chunkLoadTimeout: loadTimeout,
			crossOriginLoading,
			uniqueName,
			charset
		} = outputOptions;
		const fn = RuntimeGlobals.loadScript;

		const { createScript } =
			LoadScriptRuntimeModule.getCompilationHooks(compilation);

		const code = Template.asString([
			&quot;script = document.createElement(&#039;script&#039;);&quot;,
			scriptType ? `script.type = ${JSON.stringify(scriptType)};` : &quot;&quot;,
			charset ? &quot;script.charset = &#039;utf-8&#039;;&quot; : &quot;&quot;,
			`script.timeout = ${/** @type {number} */ (loadTimeout) / 1000};`,
			`if (${RuntimeGlobals.scriptNonce}) {`,
			Template.indent(
				`script.setAttribute(&quot;nonce&quot;, ${RuntimeGlobals.scriptNonce});`
			),
			&quot;}&quot;,
			uniqueName
				? &#039;script.setAttribute(&quot;data-webpack&quot;, dataWebpackPrefix + key);&#039;
				: &quot;&quot;,
			this._withFetchPriority
				? Template.asString([
						&quot;if(fetchPriority) {&quot;,
						Template.indent(
							&#039;script.setAttribute(&quot;fetchpriority&quot;, fetchPriority);&#039;
						),
						&quot;}&quot;
					])
				: &quot;&quot;,
			`script.src = ${
				this._withCreateScriptUrl
					? `${RuntimeGlobals.createScriptUrl}(url)`
					: &quot;url&quot;
			};`,
			crossOriginLoading
				? crossOriginLoading === &quot;use-credentials&quot;
					? &#039;script.crossOrigin = &quot;use-credentials&quot;;&#039;
					: Template.asString([
							&quot;if (script.src.indexOf(window.location.origin + &#039;/&#039;) !== 0) {&quot;,
							Template.indent(
								`script.crossOrigin = ${JSON.stringify(crossOriginLoading)};`
							),
							&quot;}&quot;
						])
				: &quot;&quot;
		]);

		return Template.asString([
			&quot;var inProgress = {};&quot;,
			uniqueName
				? `var dataWebpackPrefix = ${JSON.stringify(`${uniqueName}:`)};`
				: &quot;// data-webpack is not used as build has no uniqueName&quot;,
			&quot;// loadScript function to load a script via script tag&quot;,
			`${fn} = ${runtimeTemplate.basicFunction(
				`url, done, key, chunkId${
					this._withFetchPriority ? &quot;, fetchPriority&quot; : &quot;&quot;
				}`,
				[
					&quot;if(inProgress[url]) { inProgress[url].push(done); return; }&quot;,
					&quot;var script, needAttach;&quot;,
					&quot;if(key !== undefined) {&quot;,
					Template.indent([
						&#039;var scripts = document.getElementsByTagName(&quot;script&quot;);&#039;,
						&quot;for(var i = 0; i &lt; scripts.length; i++) {&quot;,
						Template.indent([
							&quot;var s = scripts[i];&quot;,
							`if(s.getAttribute(&quot;src&quot;) == url${
								uniqueName
									? &#039; || s.getAttribute(&quot;data-webpack&quot;) == dataWebpackPrefix + key&#039;
									: &quot;&quot;
							}) { script = s; break; }`
						]),
						&quot;}&quot;
					]),
					&quot;}&quot;,
					&quot;if(!script) {&quot;,
					Template.indent([
						&quot;needAttach = true;&quot;,
						createScript.call(code, /** @type {Chunk} */ (this.chunk))
					]),
					&quot;}&quot;,
					&quot;inProgress[url] = [done];&quot;,
					`var onScriptComplete = ${runtimeTemplate.basicFunction(
						&quot;prev, event&quot;,
						Template.asString([
							&quot;// avoid mem leaks in IE.&quot;,
							&quot;script.onerror = script.onload = null;&quot;,
							&quot;clearTimeout(timeout);&quot;,
							&quot;var doneFns = inProgress[url];&quot;,
							&quot;delete inProgress[url];&quot;,
							&quot;script.parentNode &amp;&amp; script.parentNode.removeChild(script);&quot;,
							`doneFns &amp;&amp; doneFns.forEach(${runtimeTemplate.returningFunction(
								&quot;fn(event)&quot;,
								&quot;fn&quot;
							)});`,
							&quot;if(prev) return prev(event);&quot;
						])
					)}`,
					`var timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: &#039;timeout&#039;, target: script }), ${loadTimeout});`,
					&quot;script.onerror = onScriptComplete.bind(null, script.onerror);&quot;,
					&quot;script.onload = onScriptComplete.bind(null, script.onload);&quot;,
					&quot;needAttach &amp;&amp; document.head.appendChild(script);&quot;
				]
			)};`
		]);
	}
}

module.exports = LoadScriptRuntimeModule;
</textarea>
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p>.</p>
  </div>
</footer>

<script type="text/html" id="complexity-popover-template">
  <div class="complexity-notice">
    Complexity : {{ complexity.cyclomatic }} <br>
    Length : {{ complexity.halstead.length }} <br>
    Difficulty : {{ complexity.halstead.difficulty.toFixed(2) }} <br>
    Est # bugs : {{ complexity.halstead.bugs.toFixed(2) }}<br>
  </div>
</script>

<script type="text/javascript" src="../../assets/scripts/bundles/core-bundle.js"></script>
<script type="text/javascript" src="../../assets/scripts/bundles/codemirror.js"></script>
<script type="text/javascript" src="../../assets/scripts/codemirror.markpopovertext.js"></script>
<script type="text/javascript" src="report.js"></script>
<script type="text/javascript" src="report.history.js"></script>
<script type="text/javascript" src="../../assets/scripts/plato-file.js"></script>
</body>
</html>
