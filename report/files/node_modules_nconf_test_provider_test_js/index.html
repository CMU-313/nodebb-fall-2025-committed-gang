<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Plato - node_modules/nconf/test/provider-test.js</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">

  <!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <link href="../../assets/css/vendor/morris.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/vendor/bootstrap.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/vendor/font-awesome.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/vendor/codemirror.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/plato.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/plato-file.css" rel="stylesheet" type="text/css">

</head>

<body>

<div class="navbar navbar-fixed-top">
  <div class="container">
    <a class="navbar-brand" href="https://github.com/the-simian/es6-plato">ES6 Plato on Github</a>
    <ul class="nav navbar-nav">
      <li>
        <a href="../../index.html">Report Home</a>
      </li>
      <li class="active">
        <a href="display.html">Summary Display</a>
      </li>
    </ul>
  </div>
</div>

<div class="jumbotron">
  <div class="container">
    <h1>node_modules/nconf/test/provider-test.js</h1>
  </div>
</div>

<div class="container aggregate-stats">
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Maintainability <a href="http://blogs.msdn.com/b/codeanalysis/archive/2007/11/20/maintainability-index-range-and-meaning.aspx"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="A value between 0 and 100 that represents the relative ease of maintaining the code. A high value means better maintainability." data-original-title="Maintainability Index"  data-container="body"></i></a></h2>
      <p class="stat">77.65</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Lines of code <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h2>
      <p class="stat">274</p>
    </div>
  </div>
  <div class="row historical">
    <div class="col-md-6">
      <p id="chart_historical_maint" class="chart"></p>
    </div>
    <div class="col-md-6">
      <p id="chart_historical_sloc" class="chart"></p>
    </div>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Difficulty  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="The difficulty measure is related to the difficulty of the program to write or understand." data-original-title="Difficulty" data-container="body"></i></a></h2>
      <p class="stat">25.69</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Estimated Errors  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Halstead's delivered bugs is an estimate for the number of errors in the implementation." data-original-title="Delivered Bugs" data-container="body"></i></a></h2>
      <p class="stat">3.11</p>
    </div>
  </div>
</div>

<div class="container charts">
  <div class="row">
    <h2 class="header">Function weight</h2>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h3 class="chart-header">By Complexity <a href="http://en.wikipedia.org/wiki/Cyclomatic_complexity"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="This metric counts the number of distinct paths through a block of code. Lower values are better." data-original-title="Cyclomatic Complexity" data-container="body"></i></a></h3>
      <div id="fn-by-complexity" class="stat"></div>
    </div>
    <div class="col-md-6">
      <h3 class="chart-header">By SLOC  <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h3>
      <div id="fn-by-sloc" class="stat"></div>
    </div>
  </div>
</div>

<div class="container">
  <div class="row">
    <textarea id="file-source" class="col-md-12">/*
 * provider-test.js: Tests for the nconf Provider object.
 *
 * (C) 2011, Charlie Robbins and the Contributors.
 *
 */

var assert = require(&#039;assert&#039;),
    fs = require(&#039;fs&#039;),
    path = require(&#039;path&#039;),
    vows = require(&#039;vows&#039;),
    helpers = require(&#039;./helpers&#039;),
    nconf = require(&#039;../lib/nconf&#039;);

var fixturesDir = path.join(__dirname, &#039;fixtures&#039;),
    mergeFixtures = path.join(fixturesDir, &#039;merge&#039;),
    files = [path.join(mergeFixtures, &#039;file1.json&#039;), path.join(mergeFixtures, &#039;file2.json&#039;)],
    override = JSON.parse(fs.readFileSync(files[0]), &#039;utf8&#039;);

function assertProvider(test) {
  return {
    topic: new nconf.Provider(),
    &quot;should use the correct File store&quot;: test
  };
}

vows.describe(&#039;nconf/provider&#039;).addBatch({
  &quot;When using nconf&quot;: {
    &quot;an instance of &#039;nconf.Provider&#039;&quot;: {
      &quot;calling the use() method with the same store type and different options&quot;: {
        topic: new nconf.Provider().use(&#039;file&#039;, { file: files[0] }),
        &quot;should use a new instance of the store type&quot;: function (provider) {
          var old = provider.stores[&#039;file&#039;];

          assert.equal(provider.stores.file.file, files[0]);
          provider.use(&#039;file&#039;, { file: files[1] });

          assert.notStrictEqual(old, provider.stores.file);
          assert.equal(provider.stores.file.file, files[1]);
        }
      },
      &quot;when &#039;argv&#039; is true&quot;: helpers.assertSystemConf({
        script: path.join(fixturesDir, &#039;scripts&#039;, &#039;provider-argv.js&#039;),
        argv: [&#039;--something&#039;, &#039;foobar&#039;]
      }),
      &quot;when &#039;env&#039; is true&quot;: helpers.assertSystemConf({
        script: path.join(fixturesDir, &#039;scripts&#039;, &#039;provider-env.js&#039;),
        env: { SOMETHING: &#039;foobar&#039; }
      }),
      &quot;when &#039;env&#039; is true and &#039;parseValues&#039; option is true&quot;: {
        topic: function() {
          var env = {
            SOMETHING: &#039;foobar&#039;,
            SOMEBOOL: &#039;true&#039;,
            SOMENULL: &#039;null&#039;,
            SOMEUNDEF: &#039;undefined&#039;,
            SOMEINT: &#039;3600&#039;,
            SOMEFLOAT: &#039;0.5&#039;,
            SOMEBAD: &#039;5.1a&#039;
          };
          var oenv = {};
          Object.keys(env).forEach(function (key) {
              if (process.env[key]) oenv[key] = process.env[key];
              process.env[key] = env[key];
          });
          var provider = new nconf.Provider().use(&#039;env&#039;, {parseValues: true});
          Object.keys(env).forEach(function (key) {
              delete process.env[key];
              if (oenv[key]) process.env[key] = oenv[key];
          });
          return provider;
        },
        &quot;should respond with parsed values&quot;: function (provider) {

          assert.equal(provider.get(&#039;SOMETHING&#039;), &#039;foobar&#039;);
          assert.strictEqual(provider.get(&#039;SOMEBOOL&#039;), true);
          assert.notEqual(provider.get(&#039;SOMEBOOL&#039;), &#039;true&#039;);
          assert.strictEqual(provider.get(&#039;SOMENULL&#039;), null);
          assert.strictEqual(provider.get(&#039;SOMEUNDEF&#039;), undefined);
          assert.strictEqual(provider.get(&#039;SOMEINT&#039;), 3600);
          assert.strictEqual(provider.get(&#039;SOMEFLOAT&#039;), .5);
          assert.strictEqual(provider.get(&#039;SOMEBAD&#039;), &#039;5.1a&#039;);
        }
      }
    },
    &quot;the default nconf provider&quot;: {
      &quot;when &#039;argv&#039; is set to true&quot;: helpers.assertSystemConf({
        script: path.join(fixturesDir, &#039;scripts&#039;, &#039;nconf-argv.js&#039;),
        argv: [&#039;--something&#039;, &#039;foobar&#039;],
        env: { SOMETHING: true }
      }),
      &quot;when &#039;env&#039; is set to true&quot;: helpers.assertSystemConf({
        script: path.join(fixturesDir, &#039;scripts&#039;, &#039;nconf-env.js&#039;),
        env: { SOMETHING: &#039;foobar&#039; }
      }),
      &quot;when &#039;argv&#039; is set to true and process.argv is modified&quot;: helpers.assertSystemConf({
        script: path.join(fixturesDir, &#039;scripts&#039;, &#039;nconf-change-argv.js&#039;),
        argv: [&#039;--something&#039;, &#039;badValue&#039;, &#039;evenWorse&#039;, &#039;OHNOEZ&#039;, &#039;foobar&#039;]
      }),
      &quot;when hierarchical &#039;argv&#039; get&quot;: helpers.assertSystemConf({
        script: path.join(fixturesDir, &#039;scripts&#039;, &#039;nconf-hierarchical-file-argv.js&#039;),
        argv: [&#039;--something&#039;, &#039;foobar&#039;],
        env: { SOMETHING: true }
      }),
      &quot;when &#039;env&#039; is set to true with a nested separator&quot;: helpers.assertSystemConf({
        script: path.join(fixturesDir, &#039;scripts&#039;, &#039;nconf-nested-env.js&#039;),
        env: { SOME_THING: &#039;foobar&#039; }
      })
    }
  }
}).addBatch({
  &quot;When using nconf&quot;: {
    &quot;an instance of &#039;nconf.Provider&#039;&quot;: {
      &quot;the merge() method&quot;: {
        topic: new nconf.Provider().use(&#039;file&#039;, { file: files[1] }),
        &quot;should have the result merged in&quot;: function (provider) {
          provider.load();
          provider.merge(override);
          helpers.assertMerged(null, provider.stores.file.store);
          assert.equal(provider.stores.file.store.candy.something, &#039;file1&#039;);
        },
        &quot;should merge Objects over null&quot;: function (provider) {
          provider.load();
          provider.merge(override);
          assert.equal(provider.stores.file.store.unicorn.exists, true);
        }
      }
    }
  }
}).addBatch({
  &quot;When using nconf&quot;: {
    &quot;an instance of &#039;nconf.Provider&#039;&quot;: {
      &quot;the load() method&quot;: {
        &quot;when sources are passed in&quot;: {
          topic: new nconf.Provider({
            sources: {
              user: {
                type: &#039;file&#039;,
                file: files[0]
              },
              global: {
                type: &#039;file&#039;,
                file: files[1]
              }
            }
          }),
          &quot;should respect the hierarchy &quot;: function (provider) {
            var merged = provider.load();

            helpers.assertMerged(null, merged);
            assert.equal(merged.candy.something, &#039;file1&#039;);
          }
        },
        &quot;when multiple stores are used&quot;: {
          topic: new nconf.Provider().overrides({foo: {bar: &#039;baz&#039;}})
            .add(&#039;file1&#039;, {type: &#039;file&#039;, file: files[0]})
            .add(&#039;file2&#039;, {type: &#039;file&#039;, file: files[1]}),
          &quot;should respect the hierarchy&quot;: function(provider) {
            var merged = provider.load();

            helpers.assertMerged(null, merged);
            assert.equal(merged.foo.bar, &#039;baz&#039;);
            assert.equal(merged.candy.something, &#039;file1&#039;);
          }
        }
      }
    }
  }
}).addBatch({
  &quot;When using nconf&quot;: {
    &quot;an instance of &#039;nconf.Provider&#039;&quot;: {
      &quot;the .file() method&quot;: {
        &quot;with a single filepath&quot;: assertProvider(function (provider) {
          provider.file(helpers.fixture(&#039;store.json&#039;));
          assert.isObject(provider.stores.file);
        }),
        &quot;with a name and a filepath&quot;: assertProvider(function (provider) {
          provider.file(&#039;custom&#039;, helpers.fixture(&#039;store.json&#039;));
          assert.isObject(provider.stores.custom);
        }),
        &quot;with a single object&quot;: assertProvider(function (provider) {
          provider.file({
            dir: helpers.fixture(&#039;&#039;),
            file: &#039;store.json&#039;,
            search: true
          });

          assert.isObject(provider.stores.file);
          assert.equal(provider.stores.file.file, helpers.fixture(&#039;store.json&#039;));
        }),
        &quot;with a name and an object&quot;: assertProvider(function (provider) {
          provider.file(&#039;custom&#039;, {
            dir: helpers.fixture(&#039;&#039;),
            file: &#039;store.json&#039;,
            search: true
          });

          assert.isObject(provider.stores.custom);
          assert.equal(provider.stores.custom.file, helpers.fixture(&#039;store.json&#039;));
        })
      }
    }
  }
}).addBatch({
  &quot;When using nconf&quot;: {
    &quot;an instance of &#039;nconf.Provider&#039;&quot;: {
      &quot;the any() method&quot;: {
        topic: new nconf.Provider({
          type: &#039;literal&#039;,
          store: {
              key: &quot;getThisValue&quot;
          }
        }),
        &quot;without a callback&quot;: {
          &quot;given an array of keys with one matching&quot;: {
            &quot;should respond with the correct value&quot;: function (provider) {
              assert.equal(provider.any([&quot;notthis&quot;, &quot;orthis&quot;, &quot;key&quot;]), &#039;getThisValue&#039;);
            }
          },
          &quot;given an array of keys with no match&quot;: {
            &quot;should respond with null&quot;: function (provider) {
              assert.isNull(provider.any([&quot;notthis&quot;, &quot;orthis&quot;]));
            }
          },
          &quot;given a variable argument list of keys with one matching&quot;: {
            &quot;should respond with the correct value&quot;: function (provider) {
              assert.equal(provider.any(&quot;notthis&quot;, &quot;orthis&quot;, &quot;key&quot;), &#039;getThisValue&#039;);
            }
          },
          &quot;given no arguments&quot;: {
            &quot;should respond with null&quot;: function (provider) {
              assert.isNull(provider.any());
            }
          }
        },
        &quot;with a callback&quot;: {
          &quot;given an array of keys with one matching&quot;: {
            topic: function(provider) {
              provider.any([&quot;notthis&quot;, &quot;orthis&quot;, &quot;key&quot;], this.callback);
            },
            &quot;should respond with the correct value&quot;: function (err, value) {
              assert.equal(value, &#039;getThisValue&#039;);
            }
          },
          &quot;given an array of keys with no match&quot;: {
            topic: function(provider) {
              provider.any([&quot;notthis&quot;, &quot;orthis&quot;], this.callback);
            },
            &quot;should respond with an undefined value&quot;: function (err, value) {
              assert.isUndefined(value);
            }
          },
          &quot;given a variable argument list of keys with one matching&quot;: {
            topic: function(provider) {
              provider.any(&quot;notthis&quot;, &quot;orthis&quot;, &quot;key&quot;, this.callback);
            },
            &quot;should respond with the correct value&quot;: function (err, value) {
              assert.equal(value, &#039;getThisValue&#039;);
            }
          },
          &quot;given no keys&quot;: {
            topic: function(provider) {
              provider.any(this.callback);
            },
            &quot;should respond with an undefined value&quot;: function (err, value) {
              assert.isUndefined(value);
            }
          }
        }
      }
    }
  }
}).export(module);
</textarea>
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p>.</p>
  </div>
</footer>

<script type="text/html" id="complexity-popover-template">
  <div class="complexity-notice">
    Complexity : {{ complexity.cyclomatic }} <br>
    Length : {{ complexity.halstead.length }} <br>
    Difficulty : {{ complexity.halstead.difficulty.toFixed(2) }} <br>
    Est # bugs : {{ complexity.halstead.bugs.toFixed(2) }}<br>
  </div>
</script>

<script type="text/javascript" src="../../assets/scripts/bundles/core-bundle.js"></script>
<script type="text/javascript" src="../../assets/scripts/bundles/codemirror.js"></script>
<script type="text/javascript" src="../../assets/scripts/codemirror.markpopovertext.js"></script>
<script type="text/javascript" src="report.js"></script>
<script type="text/javascript" src="report.history.js"></script>
<script type="text/javascript" src="../../assets/scripts/plato-file.js"></script>
</body>
</html>
